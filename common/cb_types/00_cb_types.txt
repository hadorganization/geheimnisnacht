

## normal scopes(including posttitle scopes) ### ROOT = receiver
# FROM = giver# <no scope change> = attacker or receiver
## title scopes ### ROOT = receiver
# FROM = giver# <no scope change> = thirdparty landed title
## the following effects/triggers exists (example execution order: on_success->on_success_title->on_success_posttitle):
# is_valid, is_valid_title, on_add, on_add_title, on_add_posttitle, on_success, on_success_title, on_success_posttitle, on_fail, on_fail_title, on_fail_posttitle, on_reverse_demand, on_reverse_demand_title, on_reverse_demand_posttitle#
# Added on_attacker_leader_death, on_defender_leader_death and on_thirdparty_death, which all trigger when corresponding character dies# These three all have war scopes, which currently has the following scope changes:
# attacker, defender, thirdparty(only valid if thirdparty character is involved), thirdparty_title(only valid if thirdparty title is involved)#
# ai_will_do: modifies value AI places on the CB compared to other CBs (default: 1) Note: is in title scope# can_use_gui: If otherwise valid, the CB is listed in the Diplo View, but you can't declare war unless 'can_use_gui' is also valid (also shows a trigger tooltip.)
#

claim = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_CLAIM
	sprite = 1
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	press_claim = yes
	infamy_modifier = 0.85
	can_use_gui = {
		ROOT = {
			piety = 50
		}
	}
	on_add = {
		ROOT = {
			piety = -50
		}
	}
	can_use = {
		ROOT = {
			wh_cb_pays_tribute_to_from_trigger = no
			nor = {
				trait = witch_hunter
				trait = vampire_necrarch_visible
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		ROOT = {
			nor = {
				and = {
					is_female = yes
					religion_group = ormazd_gods_group
				}
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		wh_cb_is_valid_title_trigger = yes
		OR = {
			ROOT = {
				has_strong_claim = PREV
				not = {
					has_opinion_modifier = {
						who = FROM
						modifier = preparing_to_invade_elf
					}
				}
			}
			ROOT = {
				has_character_flag = claimant_adventurer
			}
			AND = {
				ROOT = {
					has_weak_claim = PREV
				}
				OR = {
					is_pretender = yes # Checks vs ROOT character
					holder_scope = {
						has_regent = yes
					}
					AND = {
						ROOT = {
							is_female = no
						}
						holder_scope ={
							is_female = yes
						}
					}
					is_contested = yes # Is already being contested in some form of Claim or Succession War
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
		ROOT = {
			has_claim = PREV
		}
	}
	on_success_title = {
		hidden_tooltip = {
			ROOT = {
				clr_character_flag = claimant_adventurer
				if = {
					limit = {
						has_nickname = no
						lower_tier_than = PREV
					}
					random = {
						chance = 50
						give_nickname = nick_the_usurper
					}
				}
			}
		}
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = claim
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			prestige = -100
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
			hidden_tooltip = {
				disband_event_forces = yes
				clr_character_flag = claimant_adventurer
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -150
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		if = {
			limit = {
				ROOT = {
					has_character_flag = claimant_adventurer
				}
			}
			ROOT = {
				imprison = FROM
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 150
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 150
			}
		}
	}
	on_reverse_demand_title = {
		ROOT = {
			remove_claim = PREV
			hidden_tooltip = {
				disband_event_forces = yes
				clr_character_flag = claimant_adventurer
			}
		}
	}
	on_attacker_leader_death = {
		if = {
			limit = {
				ROOT = {
					has_character_flag = claimant_adventurer
				}
			}
			ROOT = {
				hidden_tooltip = {
					disband_event_forces = yes
					clr_character_flag = claimant_adventurer
				}
			}
			end_war = invalid
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

other_claim = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_OTHER_CLAIM
	sprite = 2
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	press_claim = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.5
	can_use = {
		ROOT = {
			NOT = {
				trait = witch_hunter
			}
			NOT = {
				trait = vampire_necrarch_visible
			}
			mercenary = no
			wh_cb_pays_tribute_to_from_trigger = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		#Greenskins are barred from using most usual CBs
		ROOT = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		OR = {

			ROOT = {
				is_female = no
			}
			# AND = {
			NOT = {
				ROOT = {
					religion_group = ormazd_gods_group
				}
			} #Ormazd use special county conquest CB instead, as vanilla Muslims (CP)
			# NOT = { succ_law_title = { has_law = agnatic_succession } }
			# }
		}
		wh_cb_is_valid_title_trigger = yes
		NOT = {
			any_war = {
				# when used in title scope, checks all wars for that title
				attacker = {
					character = ROOT
				}
			}
		}
		OR = {
			ROOT = {
				NOT = {
					trait = witch_hunter
				}
				has_strong_claim = PREV
			}
			AND = {
				ROOT = {
					has_weak_claim = PREV
				}
				OR = {
					is_pretender = yes # Checks vs ROOT character
					holder_scope = {
						has_regent = yes
					}
					AND = {
						ROOT = {
							is_female = no
						}
						holder_scope ={
							is_female = yes
						}
					}
					is_contested = yes # Is already being contested in some form of Claim or Succession War
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
		ROOT = {
			has_claim = PREV
		}
	}
	on_success = {
		hidden_tooltip = {
			ROOT = {
				opinion = {
					modifier = pressed_my_claim
					who = PREV
					multiplier = 2
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			prestige = -100
		}
	}
	on_success_title = {
		hidden_tooltip = {
			ROOT = {
				if = {
					limit = {
						has_nickname = no
						lower_tier_than = PREV
					}
					random = {
						chance = 50
						give_nickname = nick_the_usurper
					}
				}
			}
		}
		if = {
			limit = {
				controls_religion = no
			}
			if = {
				limit = {
					holder_scope = {
						same_realm = FROMFROM # The current holder and the one pressing my claim are in the same larger realm
					}
				}
				ROOT = {
					set_character_flag = other_claim_tmp_flag
				}
			}
			if = {
				limit = {
					ROOT = {
						is_ruler = yes
						is_liege_or_above = FROMFROM # The claimant is a vassal ruler of the presser
					}
				}
				ROOT = {
					set_character_flag = claimant_is_vassal_ruler_flag
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT
				type = claim
			}
			hidden_tooltip = {
				# If we were erroneously vassalized, break free
				if = {
					limit = {
						NOT = {
							ROOT = {
								has_character_flag = claimant_is_vassal_ruler_flag
							}
						}
						holder_scope = {
							is_liege_or_above = FROMFROM
						}
						NOT = {
							de_jure_liege_or_above = FROMFROM
						}
						ROOT = {
							NOT = {
								dynasty = FROMFROM
							}
						}
					}
					ROOT = {
						set_defacto_liege = ROOT
					}
				}
				# try and vassalize, but only conditionally
				if = {
					limit = {
						NOT = {
							holder_scope = {
								is_liege_or_above = FROMFROM
							}
						}
						OR = {
							holder_scope = {
								de_jure_liege_or_above = FROMFROM
							}
							ROOT = {
								has_character_flag = claimant_is_vassal_ruler_flag
							}
							ROOT = {
								dynasty = FROMFROM
							}
						}
					}
					ROOT = {
						set_defacto_liege = FROMFROM
					}
				}
				# check if the previous effect managed to make us part of the same realm
				# if not, we'll break the other realm
				if = {
					limit = {
						NOT = {
							ROOT = {
								has_character_flag = other_claim_tmp_flag
							}
						}
						FROM = {
							FROM = {
								top_liege = {
									ROOT = {
										top_liege = {
											NOT = {
												character = PREVPREV
											}
										}
									}
								}
							}
						}
					}
					ROOT = {
						set_defacto_liege = ROOT
					}
				}
				# If we have become independent from our mutual liege, restore that vassal tie
				if = {
					limit = {
						ROOT = {
							has_character_flag = other_claim_tmp_flag
							de_facto_liege = ROOT
						}
					}
					FROM = {
						FROM = {
							top_liege = {
								ROOT = {
									set_defacto_liege = PREV
								}
							}
						}
					}
				}
				ROOT = {
					clr_character_flag = other_claim_tmp_flag
					clr_character_flag = claimant_is_vassal_ruler_flag
				}
			}
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			FROM = {
				prestige = -100
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_reverse_demand = {
		prestige = -150
		transfer_scaled_wealth = {
			to = FROM
			value = 4.0
		}
		ROOT = {
			prestige = -150
			imprison = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 150
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 150
			}
		}
	}
	on_reverse_demand_title = {
		any_claim = {
			remove_claim = PREV
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

claim_on_liege = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_CLAIM_LIEGE
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes
	press_claim = yes
	can_call_vassals = no
	#	attacker_can_call_allies = no
	major_revolt = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.85
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		wh_cb_is_valid_title_trigger = yes
		ROOT = {
			NOT = {
				trait = witch_hunter
			}
			NOT = {
				trait = vampire_necrarch_visible
			}
		}
		OR = {
			ROOT = {
				has_strong_claim = PREV
			}
			ROOT = {
				has_character_flag = faction_claimant_ultimatum_taken
			} # Faction war. Ignore claim strength.
			AND = {
				ROOT = {
					has_weak_claim = PREV
				}
				OR = {
					is_pretender = yes # Checks vs ROOT character
					holder_scope = {
						has_regent = yes
					}
					AND = {
						ROOT = {
							is_female = no
						}
						holder_scope ={
							is_female = yes
						}
					}
					is_contested = yes # Is already being contested in some form of Claim or Succession War
				}
			}
		}
		is_vice_royalty = no
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			holder_scope = {
				character = ROOT
			}
		}
		wh_cb_is_valid_title_trigger = yes
		OR = {
			has_law = succ_feudal_elective
			ROOT = {
				has_claim = PREV
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					prisoner = yes
					host = {
						character = FROM
					}
				}
			}
			ROOT = {
				prisoner = no
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				is_primary_holder_title = yes
			}
			FROM = {
				imprison = ROOT
			}
		}
		usurp_title_plus_barony_if_unlanded_and_vassals_no_adj = {
			target = ROOT type = claim
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
		if = {
			limit = {
				higher_tier_than = FROM
			}
			FROM = {
				set_defacto_liege = ROOT
			}
		}
		hidden_tooltip = {
			ROOT = {
				if = {
					limit = {
						has_nickname = no
						PREV = {
							higher_tier_than = count
						}
					}
					random = {
						chance = 50
						give_nickname = nick_the_usurper
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				disband_event_forces = faction_revolters
				prisoner = FROM
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

claim_on_liege_plot = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_CLAIM_LIEGE
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes
	press_claim = yes
	major_revolt = yes
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.85
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
		}
		wh_cb_is_valid_title_trigger = yes
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = claim
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
		ROOT = {
			plot_succeeds = yes
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			imprison = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

claim_on_vassal_plot = {
	name = CB_NAME_CLAIM_VASSAL
	war_name = WAR_NAME_CLAIM_VASSAL
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes
	reflect_titleholder_change = no
	press_claim = yes
	attacker_can_call_allies = no
	can_attack_vassals = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.85
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
		}
		#Greenskins are barred from using most usual CBs
		ROOT = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				de_facto_liege = ROOT
			}
		}
	}
	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
		ROOT = {
			has_plot = plot_gain_vassal_title
		}
	}
	on_success = {
		ROOT = {
			prestige = 50
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = claim
		}
		ROOT = {
			plot_succeeds = yes
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
			cancel_plot = plot_gain_vassal_title
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_invalidation = {
		ROOT = {
			cancel_plot = plot_gain_vassal_title
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			cancel_plot = plot_gain_vassal_title
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	on_defender_leader_death = {
		ROOT = {
			cancel_plot = plot_gain_vassal_title
		}
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

other_claim_on_liege = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_OTHER_CLAIM
	sprite = 4
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	press_claim = yes
	can_call_vassals = no
	#	attacker_can_call_allies = no
	major_revolt = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.5
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = witch_hunter
			}
		}
		OR = {
			ROOT = {
				is_female = no
			}
			NOT = {
				has_law = agnatic_succession
			}
			AND = {
				lower_tier_than = KING
				is_primary_holder_title = no
			}
			FROMFROM = {
				has_character_flag = faction_claimant_ultimatum_taken
			} # Faction war. Ignore claim strength.
		}
		FROM = {
			has_landed_title = PREV
		}
		OR = {
			ROOT = {
				has_strong_claim = PREV
			}
			FROMFROM = {
				has_character_flag = faction_claimant_ultimatum_taken
			} # Faction war. Ignore claim strength.
			AND = {
				ROOT = {
					has_weak_claim = PREV
				}
				OR = {
					is_pretender = yes # Checks vs ROOT character
					holder_scope = {
						has_regent = yes
					}
					AND = {
						ROOT = {
							is_female = no
						}
						holder_scope ={
							is_female = yes
						}
					}
					is_contested = yes # Is already being contested in some form of Claim or Succession War
				}
			}
		}
		is_vice_royalty = no
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		OR = {
			liege = {
				character = PREV # either independent
			}
			liege = {
				FROM = {
					is_liege_or_above = PREV # or have shared liege
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			holder_scope = {
				character = ROOT
			}
		}
		wh_cb_is_valid_title_trigger = yes
		OR = {
			has_law = succ_feudal_elective
			ROOT = {
				has_claim = PREV
			}
		}
		NOT = {
			any_war = {
				# when used in title scope, checks all wars for that title
				attacker = {
					character = ROOT
				}
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				OR = {
					character = ROOT
					character = PREV
				}
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
				NOT = {
					character = PREV
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
		ROOT = {
			opinion = {
				modifier = pressed_my_claim
				who = PREV
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					prisoner = yes
					host = {
						character = FROM
					}
				}
			}
			ROOT = {
				prisoner = no
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				is_primary_holder_title = yes
			}
			hidden_tooltip = {
				FROM = {
					set_character_flag = temp_other_claim_on_liege_prison
				}
			}
		}
		hidden_tooltip = {
			ROOT = {
				if = {
					limit = {
						has_nickname = no
						lower_tier_than = PREV
					}
					random = {
						chance = 50
						give_nickname = nick_the_usurper
					}
				}
			}
		}
		# If the claimant has the wrong government type, take care of that first.
		if = {
			limit = {
				higher_tier_than = ROOT
				holder_scope = {
					is_feudal = yes
				}
				ROOT = {
					is_ruler = yes
					OR = {
						is_theocracy = yes
						is_republic = yes
					}
				}
			}
			ROOT = {
				abdicate = yes
			}
		}
		usurp_title_plus_barony_if_unlanded_and_vassals_no_adj = {
			target = ROOT type = claim
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
	}
	on_success_posttitle = {
		hidden_tooltip = {
			if = {
				limit = {
					top_liege = {
						ROOT = {
							NOT = {
								top_liege = {
									character = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					set_defacto_liege = PREV
				}
			}
			if = {
				limit = {
					top_liege = {
						ROOT = {
							NOT = {
								top_liege = {
									character = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					set_defacto_liege = ROOT
				}
			}
			if = {
				limit = {
					FROM = {
						has_character_flag = temp_other_claim_on_liege_prison
						lower_tier_than = PREV
					}
				}
				FROM = {
					imprison = ROOT
				}
			}
			FROM = {
				clr_character_flag = temp_other_claim_on_liege_prison
			}
		}
	}
	on_fail = {
		prestige = -100
		imprison = FROM
		#if = { #Issue CKTWO-233
		#	limit = {
		#		OR = {
		#			is_liege_of = ROOT
		#			ROOT = { is_liege_or_above = FROM }
		#		}
		#	}
		#	ROOT = {
		#		imprison = FROM
		#	}
		#}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		prestige = -200
		imprison = FROM
		#if = { #Issue CKTWO-233
		#	limit = {
		#		OR = {
		#			is_liege_of = ROOT
		#			ROOT = { is_liege_or_above = FROM }
		#		}
		#	}
		#	ROOT = {
		#		imprison = FROM
		#	}
		#}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				disband_event_forces = faction_revolters
				prisoner = FROM
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

claim_all = {
	name = CB_NAME_CLAIM_ALL
	war_name = WAR_NAME_CLAIM_ALL
	sprite = 5
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	is_claim_all = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = witch_hunter
			}
			NOT = {
				religion_group = greenskin_gods_group
			}
			NOT = {
				culture_group = orc_group
			}
			NOT = {
				culture_group = goblin_group
			}
			NOT = {
				culture_group = beastman_group
			}
			NOT = {
				ROOT = {
					has_opinion_modifier = {
						who = FROM modifier = preparing_to_invade_elf
					}
				}
			}
			total_claims = {
				who = FROM
				strong = yes # Count only strong claims
				value = 2
			}
			FROM = {
				NOT = {
					religion_group = greenskin_gods_group
				}
				NOT = {
					culture_group = orc_group
				}
				NOT = {
					culture_group = goblin_group
				}
				NOT = {
					culture_group = beastman_group
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			total_claims = {
				who = FROM
				strong = yes # Count only strong claims
				value = 1 # must have at least one claim left
			}
		}
	}
	on_add = {
		ROOT = {
			any_claim = {
				limit = {
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
					ROOT = {
						has_strong_claim = PREV
					}
				}
				press_claim = ROOT
			}
		}
	}
	on_success = {
		ROOT = {
			any_claim = {
				limit = {
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
					ROOT = {
						has_strong_claim = PREV
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT type = claim
				}
				if = {
					limit = {
						higher_tier_than = BARON
						NOT = {
							culture = ROOT
						}
					}
					hidden_tooltip = {
						conquest_culture = ROOT
					}
				}
			}
		}
		# hidden_tooltip = {
		# ROOT = {
		# if = {
		# limit = {
		# has_dlc = "Legacy of Rome"
		# OR = {
		# has_landed_title = e_byzantium
		# has_landed_title = e_roman_empire
		# }
		# religion_group = old_world_group
		# }
		# character_event = { id = LoR.30 days = 12 }
		# }
		# }
		# }
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 75
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 75
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			# any_claim = {
			# 	limit = {
			# 		holder_scope = {
			# 			OR = {
			# 				character = FROM
			# 				is_liege_or_above = FROM
			# 			}
			# 		}
			# 		ROOT = {
			# 			has_strong_claim = PREV
			# 		}
			# 	}
			# 	ROOT = {
			# 		remove_claim = PREV
			# 	}
			# }
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

change_seniority_succession_law = {
	name = CB_NAME_SENIORITY_SUCCESSION_LAW
	war_name = WAR_NAME_SENIORITY_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
		}
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			has_law = succ_seniority
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
		succession_w_cooldown = seniority
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_seniority_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_seniority_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

change_primogeniture_succession_law = {
	name = CB_NAME_PRIMOGENITURE_SUCCESSION_LAW
	war_name = WAR_NAME_PRIOGENITURE_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
		}
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			has_law = succ_primogeniture
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
		succession_w_cooldown = primogeniture
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_primogeniture_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_primogeniture_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

change_feudal_elective_succession_law = {
	name = CB_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
	war_name = WAR_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			has_law = succ_feudal_elective
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
		#		OR = {
		#			AND = {
		#				tier = emperor
		#				OR = {
		#					ROOT = { tier = king }
		#					ROOT = { tier = duke }
		#				}
		#			}
		#			AND = {
		#				tier = king
		#				ROOT = { tier = duke }
		#			}
		#			AND = {
		#				tier = duke
		#				ROOT = { tier = count }
		#			}
		#		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOT = {
							has_law = crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
		succession_w_cooldown = feudal_elective
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_feudal_elective_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_feudal_elective_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		wh_cb_is_valid_title_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		ROOT = {
			prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = FROM
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_victorious
						}
						10 = {
							give_nickname = nick_the_bold
						}
						10 = {
							give_nickname = nick_the_conqueror
						}
					}
				}
				if = {
					limit = {
						has_nickname = nick_the_bastard
					}
					give_nickname = nick_the_conqueror
				}
				# if = {
				# limit = {
				# has_dlc = "Legacy of Rome"
				# OR = {
				# has_landed_title = e_byzantium
				# has_landed_title = e_roman_empire
				# }
				# religion_group = old_world_group
				# }
				# character_event = { id = LoR.30 days = 12 }
				# }
			}
		}
		FROM = {
			prestige = -200
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = invasion_succ_tip
			hidden_tooltip = {
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT type = invasion
				}
				FROM = {
					set_defacto_liege = ROOT
				}
				if = {
					limit = {
						FROM = {
							is_liege_or_above = ROOT
						}
					}
					FROM = {
						imprison = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				higher_tier_than = BARON
				NOT = {
					culture = ROOT
				}
			}
			hidden_tooltip = {
				conquest_culture = ROOT
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 8.0
			}
		}
		FROM = {
			prestige = 200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		# FROM = {
		# if = {
		# limit = {
		# has_dlc = "Legacy of Rome"
		# OR = {
		# has_landed_title = e_byzantium
		# has_landed_title = e_roman_empire
		# }
		# religion_group = old_world_group
		# }
		# hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
		# }
		# }
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	on_reverse_demand_title = {
		# ROOT = {
		# 	remove_claim = PREV
		# }
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = whitepeace
	}
	attacker_ai_victory_worth = {
		factor = 150
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

tribal_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			prestige = 500
		}
	}
	on_add = {
		ROOT = {
			prestige = -500
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		ROOT = {
			is_nomadic = no
			OR = {
				AND = {
					has_dlc = "Horse Lords"
					higher_tier_than = COUNT
					OR = {
						has_character_flag = horde_invader
						AND = {
							independent = yes
							OR = {
								culture_group = hung_group
								culture_group = kurgan_group
							}
						}
					}
				}
				AND = {
					NOT = {
						has_dlc = "Horse Lords"
					}
					independent = yes
					higher_tier_than = COUNT
					OR = {
						culture_group = hung_group
						culture_group = kurgan_group
					}
				}
				AND = {
					mercenary = yes
					NOT = {
						num_of_titles = 2
					}
				}
			}
		}
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		FROM = {
			prestige = -200
		}
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = {
					who = FROM type = invasion
				}
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_victorious
						}
						10 = {
							give_nickname = nick_the_conqueror
						}
						10 = {
							give_nickname = nick_the_brave
						}
						10 = {
							give_nickname = nick_the_dragon
						}
						10 = {
							give_nickname = nick_the_terrible
						}
					}
				}
			}
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						is_crusade = yes # Even if the title holder is not participating in the war, gain holdings occupied by all Crusade participants
						type = invasion
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
			# if = {
			# limit = {
			# has_dlc = "Legacy of Rome"
			# OR = {
			# has_landed_title = e_byzantium
			# has_landed_title = e_roman_empire
			# }
			# religion_group = old_world_group
			# }
			# hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
			# }
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.9 # Prefer using CB's without on_add costs
		}
		#Nobody attacks chaos wastes but chaos cultists
		modifier = {
			factor = 0
			FROM = {
				de_jure_liege = e_chaos_wastes
			}
			FROM = {
				top_liege = {
					de_jure_liege = e_chaos_wastes
				}
			}
			ROOT = {
				NOR = {
					religion_group = chaos_gods_group
					religion_group = old_gods_group
				}
			}
		}
		modifier = {
			factor = 0					#Have dwarves focus on the mountains rather than Stygian Wood
			FROM = {
				NOT = {
					de_jure_liege = e_karak_ankor
				}
			}
			FROM = {
				NOT = {
					top_liege = {
						de_jure_liege = e_karak_ankor
					}
				}
			}
			ROOT = {
				OR = {
					trait = creature_dwarf
					trait = creature_chaos_dwarf
				}
			}
		}
		#	# Try to guide the Hordes in the right direction
		#	modifier = {
		#		factor = 0.1
		#		ROOT = {
		#			OR = {
		#				dynasty = 613 # Seljuks
		#				dynasty = 800 # Timurids
		#				primary_title = { title = e_il-khanate }
		#			}
		#		}
		#		OR = {
		#			empire = {
		#				NOT = {
		#					OR = {
		#						title = e_persia
		#						title = e_byzantium
		#						title = e_arabia
		#					}
		#				}
		#			}
		#			FROM = {
		#				primary_title = { title = e_golden_horde }
		#				NOT = { year = 1300 }
		#			}
		#		}
		#	}
		#	modifier = {
		#		factor = 0.1
		#		ROOT = {
		#			primary_title = { title = e_golden_horde }
		#		}
		#		OR = {
		#			empire = {
		#				OR = {
		#					title = e_persia
		#					title = e_byzantium
		#					title = e_arabia
		#				}
		#			}
		#			FROM = {
		#				primary_title = { title = e_il-khanate }
		#				NOT = { year = 1300 }
		#			}
		#		}
		#	}
		#	modifier = {
		#		factor = 0.1
		#		ROOT = {
		#			culture = hungarian
		#			primary_title = {
		#				OR = {
		#					title = k_hungary
		#					title = e_carpathia
		#				}
		#			}
		#		}
		#		empire = {
		#			OR = {
		#				title = e_tartaria
		#				title = e_russia
		#			}
		#		}
		#	}
	}

}

# Holy War CB
religious = {
	name = CB_NAME_RELIGIOUS
	war_name = WAR_NAME_RELIGIOUS
	sprite = 9
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			piety = 75
		}
	}
	on_add = {
		ROOT = {
			piety = -75
		}
	}
	can_use = {
		ROOT = {
			is_nomadic = no
			nor = {
				culture_group = skaven_group
				culture_group = orc_group
				culture_group = goblin_group
				religion_group = greenskin_gods_group
				religion_group = dwarf_gods_group
				trait = vampire_necrarch_visible
				trait = creature_nehekharan
				trait = creature_beastman
				# They expand through colonial cb
				religion_group = cadai_group
				religion = hashut
				same_realm = FROM
			}
			NAND = {
				religion_group = necromantic_group
				trait = vampire_jade_visible
			}
			pacifist = no
			#handled by separate county-level cb
			nand = {
				religion = grail
				FROM = {
					religion = asrai_cadai
				}
			}
			OR = {
				NOT = {
					religion_group = FROM
				}
				is_heresy_of = FROM
				is_parent_religion = FROM
			}
			top_liege = {
				religion_group = ROOT
				NOT = {
					religion = FROM
				}
				OR = {
					religion = ROOT
					AND = {
						is_heretic = no
						ROOT = {
							is_heretic = no
						}
					}
				}
			}
			mercenary = no
		}
		FROM = {
			nor = {
				trait = vampire_necrarch_visible
				culture_group = orc_group
				culture_group = goblin_group
				religion_group = greenskin_gods_group
			}
		}
	}
	can_use_title = {
		NAND = {
			ROOT = {
				#has_global_flag = mists_of_albion
				NOT = {
					capital_scope = {
						region = world_albion
					}
				}
			}
			capital_scope = {
				region = world_albion
			}
		}
		NOT = {
			de_jure_liege_or_above = e_the_under_empire
			de_jure_liege_or_above = e_nehekhara
		} #the duchy must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).


		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			pacifist = no
			NOT = {
				same_realm = FROM
			}
			OR = {
				NOT = {
					religion_group = FROM
				}
				is_heresy_of = FROM
				is_parent_religion = FROM
				AND = {
					OR = {
						religion = ormazd
						religion = kitabid
					}
					NOT = {
						religion = FROM
					}
				}
			}
			top_liege = {
				NOT = {
					religion = FROM
				}
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -10
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -10
				}
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
			piety = -100
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -10
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -10
				}
			}
		}
		ROOT = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		#To avoid Lizardman AI obliterating the human colonies
		modifier = {
			factor = 0.01
			ROOT = {
				trait = creature_skink
			}
		}
		modifier = {
			factor = 10
			ROOT = {
				trait = defective
			}
		}
		#Nobody attacks chaos wastes but chaos cultists
		modifier = {
			factor = 0
			FROM = {
				location = {
					region = world_chaos_wastes
				}
			}
			ROOT = {
				NOR = {
					religion_group = chaos_gods_group
					religion_group = old_gods_group
				}
			}
		}
		modifier = {
			factor = 0					#Have dwarves focus on the mountains rather than Stygian Wood
			FROM = {
				location = {
					region = world_karaz_ankor
				}
			}
			ROOT = {
				OR = {
					trait = creature_dwarf
					trait = creature_chaos_dwarf
				}
			}
		}
	}

}

excommunicated_ruler = {
	name = CB_NAME_EXCOMMUNICATED_RULER
	war_name = WAR_NAME_EXCOMMUNICATED_RULER
	sprite = 11
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		FROM = {
			excommunicated_for = ROOT
			in_revolt = no
			NOT = {
				any_current_enemy = {
					NOT = {
						religion_group = ROOT
					}
				}
			}
		}
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			mercenary = no
		}
	}
	is_valid = {
		FROM = {
			excommunicated_for = ROOT
		}
	}
	on_success = {
		ROOT = {
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = BARON
						}
					}
				}
				ROOT = {
					piety = 10
					prestige = 50
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = COUNT
						}
					}
				}
				ROOT = {
					piety = 20
					prestige = 100
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = DUKE
						}
					}
				}
				ROOT = {
					piety = 30
					prestige = 150
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = KING
						}
					}
				}
				ROOT = {
					piety = 50
					prestige = 200
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = EMPEROR
						}
					}
				}
				ROOT = {
					piety = 70
					prestige = 400
				}
			}
		}
		FROM = {
			excommunicate = no
			prestige = -200
			rightful_religious_head_scope = {
				opinion = {
					who = PREV
					modifier = opinion_repented_sins
				}
			}
			abdicate = yes
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -100
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

bid_for_independence = {
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_INDEPENDENCE
	sprite = 12
	truce_days = 3650
	is_permanent = yes
	is_independence = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			de_facto_liege = FROM
			higher_tier_than = BARON
			OR = {
				ai = yes
				is_feudal = yes
				is_tribal = yes
				higher_tier_than = COUNT
			}
			mercenary = no
			OR = {
				is_nomadic = no
				NOT = {
					clan_opinion = {
						who = FROM
						value = 0
					}
				}
			}
		}
		FROM = {
			NOT = {
				any_war = {
					attacker = {
						character = PREVPREV
					}
					OR = {
						using_cb = bid_for_independence
						using_cb = depose_liege
					}
				}
			}
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
			# No independence factions in merchant republics
			NOT = {
				AND = {
					is_merchant_republic = yes
					liege = {
						is_merchant_republic = yes
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
			# No independence factions in merchant republics
			NOT = {
				AND = {
					is_merchant_republic = yes
					liege_before_war = {
						is_merchant_republic = yes
					}
				}
			}
		}
	}
	on_success = {
		if = {
			limit = {
				FROM = {
					independent = no
				}
			}
			FROM = {
				if = {
					limit = {
						in_revolt = yes
					}
					liege_before_war = {
						ROOT = {
							set_defacto_liege = PREV
						}
					}
				}
				if = {
					limit = {
						in_revolt = no
					}
					liege = {
						ROOT = {
							set_defacto_liege = PREV
						}
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		hidden_tooltip = {
			ROOT = {
				prestige = 100
				any_demesne_title = {
					add_pressed_claim = FROM
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -50
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = -50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = -50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			prisoner = FROM
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = -100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = -100
			}
		}
		FROM = {
			prestige = 50
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 150
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

depose_liege = {
	name = CB_NAME_DEPOSE_LIEGE
	war_name = WAR_NAME_DEPOSE_LIEGE
	sprite = 12
	truce_days = 3650
	is_permanent = yes
	can_call_vassals = no
	major_revolt = no
	can_use = {
		always = no # v2.21 - Disabled - not working well
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			de_facto_liege = FROM
		}
		FROM = {
			is_feudal = yes
			primary_title = {
				is_vice_royalty = no
			}
			NOT = {
				any_war = {
					OR = {
						AND = {
							# Cannot depose liege when our liege is currently involved in such a war
							attacker = {
								character = PREVPREV
							}
							OR = {
								using_cb = bid_for_independence
								using_cb = depose_liege
							}
						}
						AND = {
							# Cannot depose liege if someone else is already deposing liege
							defender = {
								character = PREVPREV
							}
							using_cb = depose_liege
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
	}
	on_success = {
		FROM = {
			prestige = -500
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
			abdicate_to_most_liked_by = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 150
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

overthrow_ruler = {
	name = CB_NAME_OVERTHROWRULER
	war_name = WAR_NAME_OVERTHROWRULER
	sprite = 12
	truce_days = 3650
	is_revolt_cb = yes
	can_call_vassals = yes
	attacker_can_call_allies = no
	major_revolt = yes
	is_tyranny_cb = yes
	can_use = {
		FROM = {
			primary_title = {
				is_vice_royalty = no
			}
		}
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			de_facto_liege = FROM
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
		}
	}
	on_success = {
		ROOT = {
			primary_title = {
				add_pressed_claim = FROM
			}
		}
		FROM = {
			prestige = -500
			remove_opinion = {
				who = ROOT
				modifier = declared_war
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
			abdicate = yes
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			remove_opinion = {
				who = ROOT
				modifier = declared_war
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	on_defender_leader_death = {
		hidden_tooltip = {
			any_attacker = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

overthrow_ruler_no_calls = {
	name = CB_NAME_OVERTHROWRULER_NC
	war_name = WAR_NAME_OVERTHROWRULER_NC
	sprite = 12
	truce_days = 3650
	is_revolt_cb = yes
	can_call_vassals = no
	can_ask_to_join_war = no
	can_use = {
		FROM = {
			primary_title = {
				is_vice_royalty = no
			}
		}
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			de_facto_liege = FROM
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			higher_tier_than = ROOT
		}
	}
	on_success = {
		ROOT = {
			prestige = 200
			primary_title = {
				add_pressed_claim = FROM
			}
		}
		FROM = {
			prestige = -500
			remove_opinion = {
				who = ROOT
				modifier = declared_war
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
			abdicate = yes
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = -100
			remove_opinion = {
				who = ROOT
				modifier = declared_war
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		FROM = {
			prestige = 50
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

change_gavelkind_succession_law = {
	name = CB_NAME_GAVELKIND_SUCCESSION_LAW
	war_name = WAR_NAME_GAVELKIND_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
		}
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			has_law = succ_gavelkind
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					if = {
						limit = {
							OR = {
								tier = king
								tier = emperor
							}
							#					is_titular = no
							NOR = {
								has_law = crown_authority_0
								has_law = imperial_crown_authority_0
							}
						}
						if = {
							limit = {
								has_law = crown_authority_1
							}
							add_law = crown_authority_0
						}
						if = {
							limit = {
								has_law = crown_authority_2
							}
							add_law = crown_authority_1
						}
						if = {
							limit = {
								has_law = crown_authority_3
							}
							add_law = crown_authority_2
						}
						if = {
							limit = {
								has_law = crown_authority_4
							}
							add_law = crown_authority_3
						}
						if = {
							limit = {
								has_law = imperial_crown_authority_1
							}
							add_law = imperial_crown_authority_0
						}
						if = {
							limit = {
								has_law = imperial_crown_authority_2
							}
							add_law = imperial_crown_authority_1
						}
						if = {
							limit = {
								has_law = imperial_crown_authority_3
							}
							add_law = imperial_crown_authority_2
						}
						if = {
							limit = {
								has_law = imperial_crown_authority_4
							}
							add_law = imperial_crown_authority_3
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
		succession_w_cooldown = gavelkind
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_gavelkind_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_gavelkind_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

lower_crown_authority_law = {
	name = CB_NAME_LOWER_CROWN_AUTHORITY_LAW
	war_name = WAR_NAME_LOWER_CROWN_AUTHORITY_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
		}
		NOT = {
			has_dlc = "Zeus"
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		holder_scope = {
			independent = yes
		}
		OR = {
			tier = king
			tier = emperor
		}
		OR = {
			has_law = crown_authority_1
			has_law = crown_authority_2
			has_law = crown_authority_3
			has_law = crown_authority_4
		}
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			opinion = {
				modifier = opinion_lowered_crown_authority
				who = FROM
				months = 12
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				has_law = crown_authority_1
			}
			add_law_w_cooldown = crown_authority_0
		}
		if = {
			limit = {
				has_law = crown_authority_2
			}
			add_law_w_cooldown = crown_authority_1
		}
		if = {
			limit = {
				has_law = crown_authority_3
			}
			add_law_w_cooldown = crown_authority_2
		}
		if = {
			limit = {
				has_law = crown_authority_4
			}
			add_law_w_cooldown = crown_authority_3
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_lower_CA_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_lower_CA_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

lower_tribal_organization_law = {
	name = CB_NAME_LOWER_TRIBAL_ORGANIZATION_LAW
	war_name = WAR_NAME_LOWER_TRIBAL_ORGANIZATION_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		holder_scope = {
			independent = yes
		}
		OR = {
			tier = duke
			tier = king
			tier = emperor
		}
		OR = {
			has_law = tribal_organization_1
			has_law = tribal_organization_2
			has_law = tribal_organization_3
			has_law = tribal_organization_4
		}
	}
	is_valid = {
		FROM = {
			is_tribal = yes
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			opinion = {
				modifier = opinion_lowered_tribal_organization
				who = FROM
				months = 12
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				has_law = tribal_organization_1
			}
			add_law_w_cooldown = tribal_organization_0
		}
		if = {
			limit = {
				has_law = tribal_organization_2
			}
			add_law_w_cooldown = tribal_organization_1
		}
		if = {
			limit = {
				has_law = tribal_organization_3
			}
			add_law_w_cooldown = tribal_organization_2
		}
		if = {
			limit = {
				has_law = tribal_organization_4
			}
			add_law_w_cooldown = tribal_organization_3
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_lower_TO_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_lower_TO_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

coastal_republic = {
	name = CB_NAME_COASTAL_REPUBLIC
	war_name = WAR_NAME_COASTAL_REPUBLIC
	sprite = 1
	truce_days = 3650
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	allow_distant = yes # AI parameter
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = FROM
			}
			NOT = {
				is_vassal_or_below = FROM
			}
			NOT = {
				same_liege = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = BARON
		is_capital = no # Minor Holding
		holding_type = city
		location = {
			port = yes
			# Must have a trade post there already
			OR = {
				PREV = {
					holder_scope = {
						NOT = {
							same_realm = ROOT
						}
						OR = {
							is_patrician = yes
							is_merchant_republic = yes
						}
					}
				}
				trade_post_owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
			# Not allowed to use this CB to take cities in the capital province of a rival merchant republic
			FROM = {
				OR = {
					is_merchant_republic = no
					capital_scope = {
						NOT = {
							province_id = PREVPREV
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				NOT = {
					location = {
						trade_post_owner = {
							is_liege_or_above = ROOT
						}
					}
				}
			}
			usurp_title = {
				target = ROOT type = invasion
			}
		}
		if = {
			limit = {
				location = {
					trade_post_owner = {
						is_liege_or_above = ROOT
					}
				}
			}
			location = {
				trade_post_owner = {
					usurp_title = {
						target = PREVPREV type = invasion
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 50
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 50
	}

}

coastal_county_republic = {
	name = CB_NAME_COASTAL_COUNTY_REPUBLIC
	war_name = WAR_NAME_COASTAL_COUNTY_REPUBLIC
	sprite = 1
	truce_days = 3650
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	allow_distant = yes # AI parameter
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = FROM
			}
			NOT = {
				is_vassal_or_below = FROM
			}
			NOT = {
				same_liege = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = COUNT
		location = {
			port = yes
			county = {
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
			any_neighbor_province = {
				OR = {
					AND = {
						has_owner = yes
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
					AND = {
						is_land = no
						any_neighbor_province = {
							OR = {
								AND = {
									has_owner = yes
									owner = {
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
								}
								AND = {
									is_land = no
									any_neighbor_province = {
										owner = {
											OR = {
												character = ROOT
												is_liege_or_above = ROOT
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
		}
	}
	is_valid_title = {
		tier = COUNT
		location = {
			port = yes
			county = {
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						character = ROOT
					}
				}
			}
			usurp_title = ROOT
		}
		if = {
			limit = {
				NOT = {
					any_direct_de_jure_vassal_title = {
						holder_scope = {
							character = ROOT
						}
					}
				}
			}
			any_de_jure_vassal_title = {
				limit = {
					holder_scope = {
						is_liege_or_above = ROOT
					}
				}
				holder_scope = {
					usurp_title = PREVPREV
					set_defacto_liege = ROOT
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

weaken_vassal_plot = {
	name = CB_NAME_WEAKEN_VASSAL
	war_name = WAR_NAME_WEAKEN_VASSAL
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes
	press_claim = yes
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		wh_cb_is_valid_title_trigger = yes
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		any_attacker = {
			participation_scaled_prestige = 100
		}
		FROM = {
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						#					is_titular = no
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
	}
	on_success_title = {
		FROM = {
			random_vassal = {
				limit = {
					tier = count
					any_demesne_title = {
						tier = count
						dejure_liege_title = {
							ROOT = {
								plot_target_title = {
									title = PREVPREV
								}
							}
						}
					}
				}
				grant_title = PREVPREV
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
			cancel_plot = plot_weaken_fellow_vassal
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_invalidation = {
		ROOT = {
			cancel_plot = plot_weaken_fellow_vassal
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			imprison = FROM
			cancel_plot = plot_weaken_fellow_vassal
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

decadence_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_DEC_INVASION
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	can_use = {
		ROOT = {
			has_character_flag = decadence_invader
		}
	}
	on_success = {
		FROM = {
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					if = {
						limit = {
							OR = {
								tier = king
								tier = emperor
							}
							NOT = {
								has_law = crown_authority_0
							}
						}
						add_law = crown_authority_0
					}
				}
			}
		}
		ROOT = {
			prestige = 200
			piety = 100
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM type = revolt
			}
			give_nickname = nick_the_conqueror
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 200
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
				participation_scaled_piety = 100
			}
		}
		FROM = {
			prestige = -200
			primary_title = {
				holder_scope = {
					any_demesne_title = {
						limit = {
							tier = PREVPREV
						}
						usurp_title_plus_barony_if_unlanded = {
							target = ROOT type = revolt
						}
						if = {
							limit = {
								higher_tier_than = BARON
								NOT = {
									culture = ROOT
								}
							}
							hidden_tooltip = {
								conquest_culture = ROOT
							}
						}
					}
				}
			}
			set_defacto_liege = ROOT
			imprison = ROOT
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_decadent
						}
						10 = {
							give_nickname = nick_the_unready
						}
						10 = {
							give_nickname = nick_the_ill_ruler
						}
					}
				}
			}
		}
		hidden_tooltip = {
			ROOT = {
				disband_event_forces = decadence_revolters
				# Powerful vassals can choose independence
				any_vassal = {
					limit = {
						NOT = {
							character = FROM
						}
						higher_tier_than = COUNT
						prisoner = no
					}
					character_event = {
						id = 91240
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			ROOT = {
				disband_event_forces = decadence_revolters
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			set_defacto_liege = FROM
		}
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 8.0
			}
		}
		FROM = {
			prestige = 200
		}
		ROOT = {
			imprison = FROM
			disband_event_forces = decadence_revolters
		}
		if = {
			limit = {
				FROM = {
					ai = no
					NOT = {
						has_character_flag = achievement_decadent_warrior
					}
				}
			}
			FROM = {
				set_character_flag = achievement_decadent_warrior
			}
		}
	}
	on_reverse_demand_title = {
		# any_claim = {
		# 	remove_claim = ROOT
		# }
	}
	attacker_ai_victory_worth = {
		factor = 100
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 150
	}

}

muslim_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			piety = 1000
		}
	}
	on_add = {
		ROOT = {
			piety = -1000
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			religion_group = ormazd_gods_group
			# These use 'tribal_invasion' instead:
			NOR = {
				is_nomadic = yes
				AND = {
					primary_title = {
						is_tribal_type_title = yes
					}
					has_horde_culture = yes
				}
				AND = {
					mercenary = yes
					NOT = {
						num_of_titles = 2
					}
				}
			}
		}
		FROM = {
			NOT = {
				religion = ROOT
			}
		}
		ROOT = {
			NOT = {
				is_liege_or_above = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}


		# Muslims require the target to have at least 6 counties within the target kingdom
		FROM = {
			num_of_realm_counties = {
				value = 6
				title = PREV
			}
		}
		# The attacker needs at least one county in the target kingdom, or a border
		any_direct_de_jure_vassal_title = {
			any_direct_de_jure_vassal_title = {
				OR = {
					holder_scope = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
					location = {
						any_neighbor_province = {
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			religion_group = ormazd_gods_group
		}
		FROM = {
			NOT = {
				religion = ROOT
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 200
			if = {
				limit = {
					uses_decadence = yes
					FROM = {
						NOT = {
							uses_decadence = yes
						}
					}
				}
				participation_scaled_decadence = -20
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
				if = {
					limit = {
						uses_decadence = yes
						FROM = {
							NOT = {
								uses_decadence = yes
							}
						}
					}
					participation_scaled_decadence = -20
				}
			}
		}
		FROM = {
			prestige = -200
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = other_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						is_crusade = no # Even if the title holder is not participating in the war, gain holdings occupied by all Crusade participants
						type = invasion
					}
					if = {
						limit = {
							has_nickname = no
						}
						random_list = {
							10 = {
								give_nickname = nick_the_holy
							}
							10 = {
								give_nickname = nick_the_glorious
							}
							10 = {
								give_nickname = nick_the_lionheart
							}
							10 = {
								give_nickname = nick_the_great
							}
							10 = {
								give_nickname = nick_the_hammer
							}
							10 = {
								give_nickname = nick_the_magnificent
							}
						}
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			decadence = 10
		}
		FROM = {
			prestige = 200
			if = {
				limit = {
					has_nickname = no
				}
				random_list = {
					10 = {
						give_nickname = nick_the_holy
					}
					10 = {
						give_nickname = nick_the_glorious
					}
					10 = {
						give_nickname = nick_the_lionheart
					}
					10 = {
						give_nickname = nick_the_great
					}
					10 = {
						give_nickname = nick_the_hammer
					}
					10 = {
						give_nickname = nick_the_magnificent
					}
					10 = {
						give_nickname = nick_the_avenger
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 100
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 150
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.9 # Prefer using CB's without on_add costs
		}
	}

}

cb_faction_independence = {
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_FACTION_INDEPENDENCE
	sprite = 12
	truce_days = 3650
	major_revolt = yes
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			vassal_of = FROM
			mercenary = no
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
			independent = yes
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
	}
	on_success = {
		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			any_attacker = {
				limit = {
					OR = {
						vassal_of = FROM
						liege_before_war = {
							character = FROM
						}
					}
				}
				set_defacto_liege = THIS
				hidden_tooltip = {
					prestige = 100
					any_demesne_title = {
						limit = {
							controls_religion = no
							higher_tier_than = BARON
							FROM = {
								OR = {
									# If the old liege can use the subjugation CB, give no claims
									NOT = {
										religion = norscan_gods
									}
									NOT = {
										religion = northern_gods
									}
									NOT = {
										religion = kukaili
									}
									NOT = {
										culture_group = PREVPREV
									}
								}
							}
						}
						add_weak_pressed_claim = FROM
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Zeus"
					}
				}
				any_demesne_title = {
					# All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
						NOR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
					if = {
						limit = {
							has_law = crown_authority_1
						}
						add_law = crown_authority_0
					}
					if = {
						limit = {
							has_law = crown_authority_2
						}
						add_law = crown_authority_1
					}
					if = {
						limit = {
							has_law = crown_authority_3
						}
						add_law = crown_authority_2
					}
					if = {
						limit = {
							has_law = crown_authority_4
						}
						add_law = crown_authority_3
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_1
						}
						add_law = imperial_crown_authority_0
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_2
						}
						add_law = imperial_crown_authority_1
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_3
						}
						add_law = imperial_crown_authority_2
					}
					if = {
						limit = {
							has_law = imperial_crown_authority_4
						}
						add_law = imperial_crown_authority_3
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -50
			#			prisoner = FROM
			add_character_modifier = {
				name = faction_independence_ultimatum_timer
				hidden = yes
				duration = 3650
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = -50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = -50
				disband_event_forces = faction_revolters
			}
			add_character_modifier = {
				name = faction_independence_ultimatum_timer
				hidden = yes
				duration = 3650
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			prisoner = FROM
			add_character_modifier = {
				name = faction_independence_ultimatum_timer
				hidden = yes
				duration = 3650
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = -100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
				liege = {
					character = FROM
				}
			}
			prisoner = FROM
			participation_scaled_prestige = -100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_independence_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			prestige = 50
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 150
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# Embargo Merchant Republic CB
embargo_cb = {
	name = CB_NAME_EMBARGO
	war_name = WAR_NAME_EMBARGO
	sprite = 11
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			independent = yes
			NOT = {
				has_embargo = FROM
			}
			mercenary = no
		}
		FROM = {
			OR = {
				AND = {
					is_merchant_republic = yes
					any_trade_post = {
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
				AND = {
					higher_tier_than = DUKE
					any_realm_lord = {
						is_merchant_republic = yes
						any_trade_post = {
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			independent = yes
			NOT = {
				has_embargo = FROM
			}
		}
		FROM = {
			OR = {
				is_merchant_republic = yes
				AND = {
					higher_tier_than = DUKE
					any_realm_lord = {
						is_merchant_republic = yes
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			embargo = FROM
			if = {
				limit = {
					NOT = {
						religion = FROM
					}
				}
				piety = 200
			}
		}
	}
	on_fail = {
		if = {
			limit = {
				NOT = {
					any_attacker = {
						NOT = {
							character = ROOT
						}
						is_merchant_republic = yes
					}
				}
			}
			ROOT = {
				prestige = -100
			}
		}
		if = {
			limit = {
				any_attacker = {
					NOT = {
						character = ROOT
					}
					is_merchant_republic = yes
				}
			}
			any_attacker = {
				limit = {
					NOT = {
						character = ROOT
					}
					is_merchant_republic = yes
				}
				prestige = -100
			}
		}
		FROM = {
			prestige = 50
		}
	}
	on_reverse_demand = {
		if = {
			limit = {
				NOT = {
					any_attacker = {
						NOT = {
							character = ROOT
						}
						is_merchant_republic = yes
					}
				}
			}
			ROOT = {
				prestige = -200
				transfer_scaled_wealth = {
					to = FROM
					value = 4.0
				}
			}
		}
		if = {
			limit = {
				any_attacker = {
					NOT = {
						character = ROOT
					}
					is_merchant_republic = yes
				}
			}
			any_attacker = {
				limit = {
					NOT = {
						character = ROOT
					}
					is_merchant_republic = yes
				}
				prestige = -200
				transfer_scaled_wealth = {
					to = FROM
					value = 4.0
				}
			}
		}
		FROM = {
			prestige = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 50
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 50
	}
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			ROOT = {
				opinion = {
					who = FROM
					value = 25
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				opinion = {
					who = FROM
					value = 0
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
	}

}

seize_trade_post = {
	name = CB_NAME_SEIZE_TRADE_POST
	war_name = WAR_NAME_SEIZE_TRADE_POST
	sprite = 1
	truce_days = 1825
	is_permanent = yes
	#	check_all_titles = yes
	check_all_trade_posts = yes
	can_ask_to_join_war = no
	ticking_war_score_multiplier = 5.0
	allow_distant = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = FROM
			}
			OR = {
				NOT = {
					same_realm = FROM
				}
				# We cannot overtly attack much weaker Patricians in the same republic
				NOT = {
					num_of_trade_post_diff = {
						character = FROM
						value = 3
					}
				}
			}
			mercenary = no
		}
		FROM = {
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = ROOT
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = COUNT
		location = {
			port = yes
		}
		has_trade_post = yes
		trade_post_owner = {
			OR = {
				character = FROM
				is_liege_or_above = FROM
			}
		}
		holder_scope = {
			NOT = {
				character = FROM
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = FROM
			}
		}
		FROM = {
			OR = {
				is_merchant_republic = yes
				is_patrician = yes
			}
			NOT = {
				is_liege_or_above = ROOT
			}
		}
	}
	is_valid_title = {
		has_trade_post = yes
		trade_post_owner = {
			OR = {
				character = FROM
				is_liege_or_above = FROM
			}
		}
		holder_scope = {
			NOT = {
				character = FROM
			}
		}
	}
	on_success_title = {
		seize_trade_post = ROOT
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 25
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 25
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 25
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 25
	}
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.25
			ROOT = {
				NOT = {
					same_realm = FROM
				}
			}
		}
	}

}

# The Prepared Invasion CB of Norscan Heathens
viking_invasion = {
	name = CB_NAME_VIKING_INVASION
	war_name = WAR_NAME_VIKING_INVASION
	sprite = 8
	truce_days = 365
	hostile_against_others = no # Vikings share in the spoils...
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			has_opinion_modifier = {
				who = FROM modifier = preparing_to_invade
			}
			NOT = {
				is_liege_or_above = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		is_valid_viking_invasion_target = FROM # Checks that FROM holds the right amount of territory in the kingdom
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 500
			piety = 250
			religion_authority = {
				modifier = won_viking_invasion
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_victorious
						}
						10 = {
							give_nickname = nick_the_fearless
						}
						10 = {
							give_nickname = nick_the_brave
						}
						10 = {
							give_nickname = nick_haardraade
						}
						10 = {
							give_nickname = nick_the_viking
						}
						10 = {
							give_nickname = nick_the_dragon
						}
						10 = {
							give_nickname = nick_the_ironside
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 300
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 300
			}
		}
		FROM = {
			prestige = -500
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				FROM = {
					random_realm_province = {
						limit = {
							de_jure_liege_or_above = PREVPREV
							OR = {
								NOT = {
									culture = ROOT
								}
								NOT = {
									religion = ROOT
								}
							}
						}
						culture = ROOT
						religion = ROOT
					}
				}
				ROOT = {
					occupy_minors_of_occupied_settlements = FROM
					gain_all_occupied_titles = {
						who = FROM
						type = invasion
					}
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						type = invasion
					}
					# Settle the special invasion forces
					disband_event_forces = prepared_invasion
					any_demesne_title = {
						limit = {
							tier = BARON
						}
						remove_holding_modifier = recently_conquered
						refill_holding_levy = yes
					}
				}
				if = {
					limit = {
						FROM = {
							is_liege_or_above = ROOT
						}
					}
					FROM = {
						imprison = ROOT
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		ROOT = {
			prestige = -300
			piety = -100
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -500
			piety = -250
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
		FROM = {
			prestige = 300
		}
		# FROM = {
		# if = {
		# limit = {
		# has_dlc = "Legacy of Rome"
		# OR = {
		# has_landed_title = e_byzantium
		# has_landed_title = e_roman_empire
		# }
		# religion_group = old_world_group
		# }
		# hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
		# }
		# }
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# Pagans can subjugate other pagans
pagan_subjugation = {
	name = CB_NAME_PAGAN_SUBJUGATION
	war_name = WAR_NAME_PAGAN_SUBJUGATION
	sprite = 8
	truce_days = 365
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			OR = {
				religion = norscan_gods
				religion = northern_gods
				religion = kukaili
			}
			is_reformed_religion = no
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			mercenary = no
			OR = {
				AND = {
					has_dlc = "Horse Lords"
					is_nomadic = no
				}
				AND = {
					NOT = {
						has_dlc = "Horse Lords"
					}
					has_horde_culture = no # Should use tribal invasion instead
				}
			}
			#NOT = { lower_tier_than = FROM }
			OR = {
				NOT = {
					has_character_modifier = launched_subjugation
				}
				AND = {
					has_ambition = obj_become_king
					capital_scope = {
						kingdom = {
							FROM = {
								any_realm_title = {
									kingdom = {
										title = PREVPREVPREV
									}
								}
							}
						}
					}
				}
			}
		}
		FROM = {
			in_revolt = no
			OR = {
				religion = norscan_gods
				religion = northern_gods
				religion = kukaili
			}
			is_nomadic = no
			OR = {
				is_reformed_religion = no
				is_reformed_religion = ROOT
			}
			NOT = {
				any_war = {
					defender = {
						character = PREVPREV
					}
					OR = {
						using_cb = pagan_subjugation
						using_cb = nomad_subjugation
					}
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			de_jure_liege_or_above = e_the_under_empire
		}
	}
	on_add = {
		ROOT = {
			add_character_modifier = {
				name = launched_subjugation
				days = -1
				hidden = yes
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			if = {
				limit = {
					is_reformed_religion = ROOT
					controls_religion = no
				}
				religion = ROOT # Reformed pagans are forced to convert back
			}
			custom_tooltip = {
				text = tribal_subjugation_tip
			}
			hidden_tooltip = {
				opinion = {
					modifier = opinion_subjugated
					who = ROOT
				}
				any_vassal = {
					opinion = {
						modifier = opinion_subjugated
						who = ROOT
					}
				}
				any_demesne_title = {
					limit = {
						higher_tier_than = ROOT
					}
					ROOT = {
						grant_title = {
							target = PREV type = invasion
						}
					}
					add_pressed_claim = PREV
				}
				any_demesne_title = {
					limit = {
						tier = ROOT
					}
					ROOT = {
						grant_title = {
							target = PREV type = invasion
						}
					}
					add_pressed_claim = PREV
				}
				set_defacto_liege = ROOT
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		# FROM = {
		# if = {
		# limit = {
		# has_dlc = "Legacy of Rome"
		# OR = {
		# has_landed_title = e_byzantium
		# has_landed_title = e_roman_empire
		# }
		# religion_group = old_world_group
		# }
		# hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
		# }
		# }
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
	}

}

# The CB used by "Peasant revolter" characters
peasant_revolt = {
	name = CB_NAME_PEASANT_CONQUEST
	war_name = WAR_NAME_PEASANT_CONQUEST
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
				is_liege_or_above = FROM
			}
			primary_title = {
				temporary = yes
			} # Revolter or adventurer trigger
			war = no
			mercenary = no
		}
	}
	can_use_title = {
		tier = count
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = revolt
		}
		ROOT = {
			set_defacto_liege = ROOT
		}
		FROM = {
			prestige = -100
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 10
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = crushed_revolt
					days = 3650
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# The CB used by "Heretic revolter" characters
heretic_revolt = {
	name = CB_NAME_HERETIC_UPRISING
	war_name = WAR_NAME_HERETIC_UPRISING
	sprite = 7
	truce_days = 365
	hostile_against_others = yes
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	can_use = {
		ROOT = {
			has_character_flag = heretic_revolter
		}
	}
	# is_valid = {
	# FROM = {
	# NOT = { religion = ROOT }
	# }
	# }
	on_success = {
		ROOT = {
			prestige = 200
			piety = 100
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM type = revolt
			}
			clr_character_flag = heretic_revolter
		}
		FROM = {
			prestige = -500
			piety = -500
			religion_authority = {
				modifier = lost_heretic_revolt
			}
		}
	}
	on_fail = {
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
		FROM = {
			prestige = 50
			piety = 100
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
			religion_authority = {
				modifier = won_heretic_revolt
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
		FROM = {
			prestige = 100
			piety = 200
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = crushed_revolt
					days = 3650
				}
			}
			religion_authority = {
				modifier = won_heretic_revolt
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 100
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 150
	}

}

# The CB used by "Religious revolter" characters
religious_revolt = {
	name = CB_NAME_HERETIC_UPRISING
	war_name = WAR_NAME_HERETIC_UPRISING
	sprite = 7
	truce_days = 365
	hostile_against_others = yes
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	can_use = {
		ROOT = {
			has_character_flag = religious_revolter
		}
	}
	is_valid = {
		FROM = {
			NOT = {
				religion = ROOT
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 200
			piety = 100
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM type = revolt
			}
			clr_character_flag = religious_revolter
		}
		FROM = {
			prestige = -500
			piety = -500
			religion_authority = {
				modifier = lost_religious_revolt
			}
		}
	}
	on_fail = {
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
		FROM = {
			prestige = 50
			piety = 100
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
			religion_authority = {
				modifier = won_religious_revolt
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
		FROM = {
			prestige = 100
			piety = 200
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = crushed_revolt
					days = 3650
				}
			}
			religion_authority = {
				modifier = won_religious_revolt
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 100
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 150
	}

}

# The CB used by "Nationalist Revolter" characters
liberation_revolt = {
	name = CB_NAME_LIBERATION_REVOLT
	war_name = WAR_NAME_LIBERATION_REVOLT
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	# check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	check_de_jure_tier = KING # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	press_claim = yes
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			has_character_flag = nationalist_rebel
		}
	}
	can_use_title = {
		tier = king
		has_holder = no
	}
	is_valid = {
		FROM = {
			NOT = {
				culture = ROOT
			}
		}
	}
	is_valid_title = {
		has_holder = no
	}
	on_success = {
		ROOT = {
			prestige = 1000
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM type = revolt
			}
			clr_character_flag = nationalist_rebel
			give_nickname = nick_the_liberator
		}
		FROM = {
			prestige = -500
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						is_revolt = yes
						type = revolt
					}
					if = {
						limit = {
							num_of_count_titles = 5
							PREV = {
								OR = {
									has_holder = no
									holder_scope = {
										character = FROM
									}
								}
							}
						}
						usurp_title = {
							target = PREV type = revolt
						}
					}
				}
			}
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 100
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 200
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = crushed_major_revolt
					days = 3650
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 100
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

duchy_adventure = {
	name = CB_NAME_DUCHY_ADVENTURE
	war_name = WAR_DUCHY_ADVENTURE
	sprite = 9
	truce_days = 3650
	is_permanent = yes
	hostile_against_others = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			has_character_flag = duchy_adventurer
		}
	}
	is_valid = {
		always = yes
	}
	on_success = {
		ROOT = {
			prestige = 250
			hidden_tooltip = {
				clr_character_flag = duchy_adventurer
				give_nickname = nick_the_conqueror
			}
		}
		FROM = {
			prestige = -250
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = other_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						type = host
					}
				}
			}
		}
		# ROOT = {
		# hidden_tooltip = {
		# # Special case: Seljuk succeeds in his first conquest
		# if = {
		# limit = {
		# has_character_flag = seljuk_himself
		# }
		# narrative_event = {
		# id = 60206
		# days = 1
		# }
		# }
		# # Special case: Timur succeeds in his first conquest
		# if = {
		# limit = {
		# has_character_flag = timur_himself
		# }
		# narrative_event = {
		# id = 60306
		# days = 1
		# }
		# }
		# # Special case: Sabuktigin succeeds in his first conquest
		# if = {
		# limit = {
		# has_character_flag = sabuktigin_himself
		# }
		# narrative_event = {
		# id = 60406
		# days = 1
		# }
		# }
		# }
		# }
	}
	on_fail = {
		FROM = {
			prestige = 100
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			clear_wealth = yes
			imprison = FROM
			hidden_tooltip = {
				disband_event_forces = yes
				clr_character_flag = duchy_adventurer
			}
		}
		ROOT = {
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		ROOT = {
			clear_wealth = yes
			imprison = FROM
			prestige = -200
			hidden_tooltip = {
				disband_event_forces = yes
				clr_character_flag = duchy_adventurer
			}
		}
	}
	on_attacker_leader_death = {
		ROOT = {
			hidden_tooltip = {
				disband_event_forces = yes
				clr_character_flag = duchy_adventurer
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

caliphal_subjugation = {
	name = CB_NAME_PAGAN_SUBJUGATION
	war_name = WAR_NAME_PAGAN_SUBJUGATION
	sprite = 8
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			piety = 200
		}
	}
	on_add = {
		ROOT = {
			piety = -200
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			religion_group = ormazd_gods_group
			OR = {
				has_landed_title = k_caliph_al_umma
				AND = {
					trait = ormazd_sayyid
					k_caliph_al_umma = {
						has_holder = no
					}
				}
			}
			is_nomadic = no
			OR = {
				has_horde_culture = no # Should use tribal invasion instead
				has_dlc = "Horse Lords"
			}
			NOT = {
				has_character_modifier = launched_subjugation
			}
			mercenary = no
		}
		FROM = {
			religion = ROOT
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add_title = {
		ROOT = {
			add_character_modifier = {
				name = launched_subjugation
				days = 3650
				hidden = yes
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 100
			decadence = -5
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			prestige = -200
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.9 # Prefer using CB's without on_add costs
		}
	}

}

muslim_county_conquest = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 16
	truce_days = 1825
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			piety = 50
		}
	}
	on_add = {
		ROOT = {
			piety = -50
		}
	}
	can_use = {
		ROOT = {
			nor = {
				trait = vampire_necrarch_visible
				is_liege_or_above = FROM
			}
			mercenary = no
			is_nomadic = no # Use the 'pagan_county_conquest' CB instead
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		tier = count
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		ROOT = {
			OR = {
				religion = ormazd
				religion = kitabid
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		if = {
			limit = {
				holder_scope = {
					tier = count
					NOT = {
						num_of_count_titles = 2
					}
					lower_tier_than = ROOT
				}
			}
			holder_scope = {
				set_defacto_liege = ROOT
			}
		}
		if = {
			limit = {
				holder_scope = {
					OR = {
						higher_tier_than = count
						num_of_count_titles = 2
						NOT = {
							lower_tier_than = ROOT
						}
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT type = invasion
			}
			any_de_jure_vassal_title = {
				# take all baronies under the one we're fighting for
				limit = {
					has_holder = yes
					NOT = {
						de_facto_liege = PREV
					}
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT type = invasion
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.9 # Prefer using CB's without on_add costs
		}
	}

}

# 42
pagan_county_conquest = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 16
	truce_days = 1825
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	allow_distant = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			mercenary = no
		}
		OR = {
			ROOT = {
				is_nomadic = yes
				NOT = {
					same_realm = FROM
				}
				FROM = {
					OR = {
						is_nomadic = yes
						is_tribal = yes
					}
				}
			}
			AND = {
				ROOT = {
					OR = {
						culture_group = norscan_group
						religion = stromfels #Because PIRATES
						religion = atruhayid #Because CORSAIRS
						trait = creature_chaos_dwarf #So they get some options to expand outside
					}
					NOT = {
						same_realm = FROM
					}
				}
				FROM = {
					NOT = {
						religion = ROOT
					}
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = count
		OR = {
			FROM = {
				has_landed_title = PREV
				NOT = {
					trait = vampire_necrarch_visible
				}
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		OR = {
			AND = {
				OR = {
					ROOT = {
						culture_group = norscan_group
					}
					ROOT = {
						religion = stromfels
					}
				}
				location = {
					port = yes
				}
			}
			location = {
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
	}
	is_valid_title = {
		OR = {
			ROOT = {
				is_nomadic = yes
			}
			AND = {
				ROOT = {
					OR = {
						culture_group = norscan_group
						religion = stromfels #Because PIRATES
						trait = creature_chaos_dwarf #So they get some options to expand outside
					}
					NOT = {
						same_realm = FROM
					}
				}
				FROM = {
					NOT = {
						religion = ROOT
					}
				}
			}
		}
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies too
			limit = {
				has_holder = yes
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
						AND = {
							is_liege_or_above = ROOT
							NOT = {
								culture = ROOT
							}
							NOT = {
								religion = ROOT
							}
						}
					}
				}
			}
			usurp_title = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
		if = {
			limit = {
				NOT = {
					FROM = {
						religion = ROOT
					}
				}
			}
			ROOT = {
				religion_authority = {
					modifier = won_county_conquest
				}
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		if = {
			limit = {
				NOT = {
					FROM = {
						religion = ROOT
					}
				}
			}
			ROOT = {
				religion_authority = {
					modifier = lost_county_conquest
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		if = {
			limit = {
				NOT = {
					FROM = {
						religion = ROOT
					}
				}
			}
			ROOT = {
				religion_authority = {
					modifier = lost_county_conquest
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# 43
dejure_county_claim = {
	name = CB_NAME_DEJURECLAIM
	war_name = WAR_NAME_DEJURECLAIM
	sprite = 16
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.5
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = count
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		wh_cb_is_valid_title_trigger = yes
		OR = {
			kingdom = {
				holder = ROOT
			}
			empire = {
				holder = ROOT
			}
			dejure_liege_title = {
				holder = ROOT
			}
		}
		wh_cb_can_use_title_trigger = yes
		FROM = {
			OR = {
				holy_order = no
				NOT = {
					religion = ROOT
				}
				NOT = {
					has_dlc = "Sons of Abraham"
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		if = {
			limit = {
				holder_scope = {
					tier = count
					is_patrician = no
					NOT = {
						num_of_count_titles = 2
					}
				}
			}
			holder_scope = {
				set_defacto_liege = ROOT
			}
		}
		if = {
			limit = {
				holder_scope = {
					OR = {
						higher_tier_than = count
						num_of_count_titles = 2
						is_patrician = yes
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT type = claim
			}
			any_de_jure_vassal_title = {
				# take all baronies under the one we're fighting for
				limit = {
					has_holder = yes
					NOT = {
						de_facto_liege = PREV
					}
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT type = claim
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.6
		}
		modifier = {
			factor = 0	# More convenient to use Druchii subjugation
			ROOT = {
				religion_group = cytharai_group
			}
			FROM = {
				religion_group = cytharai_group
			}
		}
		modifier = {
			factor = 0
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
			ROOT = {
				religion = sigmarite
			}
		}
	}

}

# 44
dejure_barony_claim = {
	name = CB_NAME_DEJUREBARONYCLAIM
	war_name = WAR_NAME_DEJUREBARONYCLAIM
	sprite = 16
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_de_jure_tier = COUNT
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.5
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
		}
		FROM = {
			OR = {
				holy_order = no
				NOT = {
					religion = ROOT
				}
				NOT = {
					has_dlc = "Sons of Abraham"
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		ROOT = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		has_holder = yes
		holder_scope = {
			OR = {
				character = ROOT
				is_liege_or_above = ROOT
			}
		}
		any_direct_de_jure_vassal_title = {
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
				NOR = {
					character = ROOT
					is_liege_or_above = ROOT
				}
			}
		}
	}
	on_success_title = {
		holder_scope = {
			save_event_target_as = target_taker
		}
		any_direct_de_jure_vassal_title = {
			limit = {
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
					NOR = {
						character = event_target:target_taker
						is_liege_or_above = event_target:target_taker
						is_liege_or_above = ROOT
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = event_target:target_taker type = claim
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 25
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 25
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 75
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 75
	}
	ai_will_do = {
		factor = 1
		modifier = {
			# Hey AI, don't be an asshole to religious heads
			factor = 0
			FROM = {
				controls_religion = yes
			}
		}
		modifier = {
			factor = 0
			ROOT = {
				religion = sigmarite
			}
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
		}
	}

}

# 46
other_dejure_county_claim = {
	name = CB_NAME_DEJURECLAIM
	war_name = WAR_NAME_OTHER_DEJURECLAIM
	sprite = 16
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	other_de_jure_claim = yes # Optimization for de jure claims of vassals
	press_claim = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	infamy_modifier = 0.3
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		FROM = {
			NOT = {
				religion_group = greenskin_gods_group
			}
		}
		NOT = {
			character = ROOT
		}
		FROM = {
			OR = {
				holy_order = no
				NOT = {
					religion = ROOT
				}
				NOT = {
					has_dlc = "Sons of Abraham"
				}
				mercenary = no
			}
		}
		mercenary = no
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = count
		dejure_liege_title = {
			has_holder = yes
			ROOT = {
				has_landed_title = PREV
			}
		}
		holder_scope = {
			NOR = {
				character = ROOT
				character = FROMFROM
				is_liege_or_above = ROOT
				is_liege_or_above = FROMFROM # The potential attacker
			}
		}
		wh_cb_is_valid_title_trigger = yes
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		ROOT = {
			opinion = {
				modifier = pressed_my_claim
				who = PREV
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				holder_scope = {
					tier = count
					NOT = {
						num_of_count_titles = 2
					}
				}
			}
			holder_scope = {
				set_defacto_liege = ROOT
			}
		}
		if = {
			limit = {
				holder_scope = {
					OR = {
						higher_tier_than = count
						num_of_count_titles = 2
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT type = claim
			}
			any_de_jure_vassal_title = {
				# take all baronies under the one we're fighting for
				limit = {
					has_holder = yes
					NOT = {
						de_facto_liege = PREV
					}
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT type = claim
				}
			}
		}
	}
	on_fail = {
		prestige = -50
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		prestige = -100
		transfer_scaled_wealth = {
			to = FROM
			value = 4.0
		}
		ROOT = {
			prestige = -200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
		}
		modifier = {
			factor = 0	# More convenient to use Druchii subjugation
			ROOT = {
				religion_group = cytharai_group
			}
			FROM = {
				religion_group = cytharai_group
			}
		}
		modifier = {
			factor = 0
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
			ROOT = {
				religion = sigmarite
			}
		}
	}

}

# The special CB for the Rise of the Ormazd Caliphate
ormazd_caliphate_rising = {
	name = CB_NAME_SHIA_CALIPHATE_RISING
	war_name = WAR_NAME_ORMAZD_CALIPHATE_RISING
	sprite = 8
	truce_days = 365
	hostile_against_others = no
	is_permanent = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			has_character_flag = shia_caliphate_pretender
		}
	}
	is_valid_title = {
		ROOT = {
			has_character_flag = shia_caliphate_pretender
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
		k_caliph_al_umma = {
			has_holder = no
		}
	}
	on_success = {
		clr_global_flag = shia_caliphate_revolt_ongoing
		ROOT = {
			piety = 500
			# religion_authority = {
			# modifier = rise_of_the_shia_caliphate
			# }
			clr_character_flag = shia_caliphate_pretender
		}
		FROM = {
			piety = -500
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				k_caliph_al_umma = {
					usurp_title = {
						target = ROOT type = holy_war
					}
				}
				any_independent_ruler = {
					limit = {
						religion = ROOT
					}
					long_character_event = {
						id = ormazdian.4
					}
				}
				# FROM = {
				# random_realm_province = {
				# limit = {
				# de_jure_liege_or_above = PREVPREV
				# NOT = { religion = ROOT }
				# religion_group = ormazd_gods_group
				# }
				# religion = ROOT
				# }
				# random_realm_province = {
				# limit = {
				# de_jure_liege_or_above = PREVPREV
				# NOT = { religion = ROOT }
				# religion_group = ormazd_gods_group
				# }
				# religion = ROOT
				# }
				# random_realm_province = {
				# limit = {
				# de_jure_liege_or_above = PREVPREV
				# NOT = { religion = ROOT }
				# religion_group = ormazd_gods_group
				# }
				# religion = ROOT
				# }
				# random_realm_province = {
				# limit = {
				# de_jure_liege_or_above = PREVPREV
				# NOT = { religion = ROOT }
				# religion_group = ormazd_gods_group
				# }
				# religion = ROOT
				# }
				# random_realm_province = {
				# limit = {
				# de_jure_liege_or_above = PREVPREV
				# NOT = { religion = ROOT }
				# religion_group = ormazd_gods_group
				# }
				# religion = ROOT
				# }
				# }
				ROOT = {
					occupy_minors_of_occupied_settlements = FROM
					gain_all_occupied_titles = {
						who = FROM type = revolt
					}
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						is_religious = yes
						type = revolt
					}
					any_demesne_title = {
						limit = {
							tier = BARON
						}
						remove_holding_modifier = recently_conquered
						refill_holding_levy = yes
					}
					usurp_title = {
						target = PREV type = revolt
					}
				}
				if = {
					limit = {
						FROM = {
							is_liege_or_above = ROOT
						}
					}
					FROM = {
						imprison = ROOT
					}
				}
			}
		}
	}
	on_fail = {
		clr_global_flag = shia_caliphate_revolt_ongoing
		FROM = {
			piety = 250
		}
		ROOT = {
			piety = -250
			clr_character_flag = shia_caliphate_pretender
		}
	}
	on_reverse_demand = {
		clr_global_flag = shia_caliphate_revolt_ongoing
		ROOT = {
			piety = -500
			clr_character_flag = shia_caliphate_pretender
			imprison = FROM
		}
		FROM = {
			piety = 250
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 250
			}
		}
	}
	on_attacker_leader_death = {
		clr_global_flag = shia_caliphate_revolt_ongoing
		ROOT = {
			clr_character_flag = shia_caliphate_pretender
		}
		end_war = invalid
	}
	on_invalidation = {
		#clr_global_flag = shia_caliphate_revolt_ongoing
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

cb_decadence_usurption = {
	name = CB_NAME_DECADENCE_USURPTION
	war_name = WAR_NAME_DECADENCE_USURPTION
	sprite = 11
	truce_days = 3650
	is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			OR = {
				religion = ormazd
				religion = kitabid
			}
		}
		FROM = {
			OR = {
				religion = ormazd
				religion = kitabid
			}
			trait = decadent
			dynasty = ROOT
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					ROOT = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		ROOT = {
			mercenary = no
		}
	}
	is_valid = {
		FROM = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					ROOT = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 500
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 500
				participation_scaled_prestige = 250
			}
		}
		FROM = {
			prisoner = ROOT
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = invasion
		}
	}
	on_fail = {
		ROOT = {
			piety = -250
			prestige = -125
		}
		FROM = {
			piety = 100
			prestige = 50
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			piety = -500
			prestige = -250
		}
		FROM = {
			piety = 500
			prestige = 250
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# 54
rivalry_cb = {
	name = CB_NAME_RIVALRY
	war_name = WAR_NAME_RIVALRY
	sprite = 7
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		ROOT = {
			is_rival = FROM
		}
		FROM = {
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_humiliated_rival
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			is_rival = FROM
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
		ROOT = {
			if = {
				limit = {
					ai = no
					FROM = {
						any_sibling = {
							character = ROOT
						}
					}
				}
				set_character_flag = achievement_sibling_rival_war
			}
			remove_opinion = {
				who = FROM
				modifier = opinion_humiliated_rival
			}
		}
		FROM = {
			prestige = -250
			imprison = ROOT
			opinion = {
				modifier = opinion_humiliated_rival
				who = ROOT
				years = 150
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -125
		}
		FROM = {
			prestige = 50
		}
	}
	on_reverse_demand = {
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
		ROOT = {
			prestige = -250
			imprison = FROM
			opinion = {
				modifier = opinion_humiliated_rival
				who = FROM
				years = 150
			}
		}
		FROM = {
			remove_opinion = {
				who = ROOT
				modifier = opinion_humiliated_rival
			}
			if = {
				limit = {
					ai = no
					ROOT = {
						any_sibling = {
							character = PREVPREV
						}
					}
				}
				set_character_flag = achievement_sibling_rival_war
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
			ROOT = {
				religion = sigmarite
			}
		}
	}

}

# 55
tributary_cb = {
	name = CB_NAME_TRIBUTARY
	war_name = WAR_NAME_TRIBUTARY
	sprite = 1
	truce_days = 365
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = no
	display_on_map = no
	coalition_threat = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			NOT = {
				culture_group = lizardman_group
			}
			NOT = {
				religion = asrai_cadai
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			mercenary = no
			is_tributary = no
			OR = {
				NOT = {
					trait = witch_hunter
				}
				ai = no
			}
			NOT = {
				is_vassal_or_below = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			NOT = {
				rightful_religious_head_scope = {
					character = FROM
				}
			}
			NAND = {
				holy_order = yes
				religion = FROM
			}
		}
		FROM = {
			NAND = {
				holy_order = yes
				religion = ROOT
			}
			independent = yes
			NOT = {
				trait = creature_skaven
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			NOT = {
				culture_group = lizardman_group
			}
			wh_cb_pays_tribute_to_root_trigger = no
		}
		# The attacker needs a border, or be at most two sea zones away from one of the target's counties
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								OR = {
									AND = {
										has_owner = yes
										owner = {
											OR = {
												character = ROOT
												is_liege_or_above = ROOT
											}
										}
									}
									AND = {
										is_land = no
										any_neighbor_province = {
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		# The defender is not in any tributary war
		FROM = {
			NOT =
			{
				any_war = {
					using_cb = tributary_cb
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
	}
	is_valid = {
		NOT = {
			ROOT = {
				rightful_religious_head_scope = {
					character = FROM
				}
			}
		}
	}
	on_success = {
		FROM = {
			save_event_target_as = target_loser
			prestige = -100
			custom_tooltip = {
				text = "REMOVE_PREVIOUS_SUZERAIN"
				hidden_tooltip = {
					any_suzerain = {
						event_target:target_loser = {
							remove_tributary = PREV
						}
					}
				}
			}
		}
		ROOT = {
			prestige = 200
			make_tributary = {
				who = FROM percentage = 0.4
			}
		}
		if = {
			limit = {
				ROOT = {
					uses_decadence = yes
				}
			}
			ROOT = {
				decadence = -10
			}
		}
		if = {
			limit = {
				ROOT = {
					is_nomadic = yes
				}
			}
			ROOT = {
				clan_title = {
					save_event_target_as = liege_clan
				}
				any_vassal = {
					limit = {
						is_nomadic = yes
					}
					clan_title = {
						clan_opinion = {
							who = event_target:liege_clan
							modifier = won_tributary_war
							years = 5
						}
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					is_tribal = yes
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						is_tribal = yes
					}
					opinion = {
						who = PREV
						modifier = won_tributary_war
						years = 5
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = 100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
		modifier = {
			factor = 2
			FROM = {
				trait = proud
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = brave
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = greedy
			}
		}
		modifier = {
			factor = 3
			FROM = {
				tier = KING
			}
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.2
				}
			}
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.0
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 3
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 4
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 5
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 6
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				relative_power = {
					who = FROM power = 8
				}
			}
		}
		modifier = {
			factor = 0.25
			ROOT = {
				relative_power = {
					who = FROM power = 10
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 20
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 40
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 80
				}
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 120
				}
			}
		}
		modifier = {
			factor = 0.1
			FROM = {
				trait = vampire_necrarch_visible
			}
		}
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.1 # Low prio CB
		}
		#Nobody attacks chaos wastes but chaos cultists
		modifier = {
			factor = 0
			FROM = {
				de_jure_liege = e_chaos_wastes
			}
			FROM = {
				top_liege = {
					de_jure_liege = e_chaos_wastes
				}
			}
			ROOT = {
				NOR = {
					religion_group = chaos_gods_group
					religion_group = old_gods_group
				}
			}
		}
		modifier = {
			factor = 0
			ROOT = {
				trait = creature_dwarf
			}
			NOT = {
				FROM = {
					capital_scope = {
						region = world_karaz_ankor
					}
				}
			}
		}
		# Beastmen only make tributaries and are made tributaries by themselves. Greenskins can make tributaries of other people, but are only made into tributaries by themselves
		modifier = {
			factor = 0
			FROM = {
				trait = creature_orc
			}
			ROOT = {
				NOR = {
					trait = creature_goblin
					trait = creature_orc
				}
			}
		}
		modifier = {
			factor = 0
			FROM = {
				trait = creature_goblin
			}
			ROOT = {
				NOR = {
					trait = creature_goblin
					trait = creature_orc
				}
			}
		}
		modifier = {
			factor = 0
			FROM = {
				trait = creature_beastman
			}
			ROOT = {
				NOT = {
					trait = creature_beastman
				}
			}
		}
		modifier = {
			factor = 0
			ROOT = {
				trait = creature_beastman
			}
			FROM = {
				NOT = {
					trait = creature_beastman
				}
			}
		}
		modifier = {
			#Like it
			factor = 2
			ROOT = {
				trait = creature_chaos_dwarf
			}
		}
		modifier = {
			#Filthy savages, keep out of borders
			factor = 2
			ROOT = {
				trait = creature_elf
			}
			NOT = {
				FROM = {
					trait = creature_elf
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = proud
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = brave
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = greedy
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				tier = KING
			}
		}
		modifier = {
			factor = 0.1 # Nomads are the only ones who like using the CB
			ROOT = {
				is_nomadic = no
			}
		}
		modifier = {
			factor = 0.1 # Target has almost no money
			FROM = {
				OR = {
					is_nomadic = yes
					is_tribal = yes
				}
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				trait = greedy
			}
		}
	}

}

# 56
free_tributary_cb = {
	name = CB_NAME_FREE_TRIBUTARY
	war_name = WAR_NAME_FREE_TRIBUTARY
	sprite = 1
	truce_days = 365
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = no
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			OR = {
				AND = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
				any_vassal = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				AND = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
				any_vassal = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
			}
		}
	}
	on_success = {
		FROM = {
			prestige = -100
		}
		ROOT = {
			prestige = 100
			if = {
				limit = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
				suzerain = {
					remove_tributary = PREV
				}
			}
			any_vassal = {
				limit = {
					is_tributary = yes
					suzerain = {
						OR = {
							character = FROM
							any_liege = {
								character = FROM
							}
						}
					}
				}
				suzerain = {
					remove_tributary = PREV
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = 100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 100
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
		modifier = {
			factor = 1.5
			FROM = {
				trait = proud
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				trait = brave
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				trait = greedy
			}
		}
		modifier = {
			factor = 2
			FROM = {
				tier = KING
			}
		}
		modifier = {
			factor = 0.80
			ROOT = {
				relative_power = {
					who = FROM power = 1.2
				}
			}
		}
		modifier = {
			factor = 0.80
			ROOT = {
				relative_power = {
					who = FROM power = 1.5
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 2.0
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 2.5
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 3
				}
			}
		}
		modifier = {
			factor = 0.7
			ROOT = {
				relative_power = {
					who = FROM power = 4
				}
			}
		}
		modifier = {
			factor = 0.7
			ROOT = {
				relative_power = {
					who = FROM power = 5
				}
			}
		}
		modifier = {
			factor = 0.7
			ROOT = {
				relative_power = {
					who = FROM power = 6
				}
			}
		}
		modifier = {
			factor = 0.4
			ROOT = {
				relative_power = {
					who = FROM power = 8
				}
			}
		}
		modifier = {
			factor = 0.1
			ROOT = {
				relative_power = {
					who = FROM power = 10
				}
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 20
				}
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 40
				}
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 80
				}
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 120
				}
			}
		}
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 1.5
		}
		modifier = {
			factor = 4
			ROOT = {
				trait = greedy
			}
		}
		modifier = {
			factor = 2
			OR = {
				ROOT = {
					is_nomadic = yes
				}
				FROM = {
					is_nomadic = no
				}
			}
		}
	}

}

# 57
cb_install_khan = {
	name = CB_NAME_INSTALLKHAN
	war_name = WAR_NAME_INSTALLKHAN
	sprite = 12
	truce_days = 3650
	is_revolt_cb = no
	can_call_vassals = yes
	attacker_can_call_allies = no
	major_revolt = yes
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			is_nomadic = yes
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
			any_demesne_title = {
				tier = count # has some land
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
		}
	}
	on_success = {
		FROM = {
			any_demesne_title = {
				limit = {
					tier = EMPEROR
				}
				gain_title = {
					target = ROOT type = faction_demand
				}
			}
			if = {
				limit = {
					is_invincible_trigger = yes
				}
				antideath_effect = yes
				break = yes
			}
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	on_defender_leader_death = {
		hidden_tooltip = {
			any_attacker = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# 58
nomad_dispute = {
	name = CB_NAME_DISPUTE
	war_name = CB_NAME_DISPUTE
	sprite = 16
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = no
	allow_distant = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			is_nomadic = yes
			same_realm = FROM
			has_feud_with = FROM
		}
		FROM = {
			is_nomadic = yes
		}
		ROOT = {
			mercenary = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		tier = count
		location = {
			NOT = {
				num_of_settlements = 1
			}
		}
		FROM = {
			has_landed_title = PREV
		}
	}
	is_valid_title = {
		location = {
			NOT = {
				num_of_settlements = 1
			}
		}
		FROM = {
			has_landed_title = PREV
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = invasion
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 2
	}

}

cb_minor_clan_revolt = {
	name = CB_NAME_MINOR_CLAN_REVOLT
	war_name = WAR_NAME_MINOR_CLAN_REVOLT
	sprite = 16
	truce_days = 365
	hostile_against_others = no
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			primary_title = {
				temporary = yes
			} # Revolter or adventurer trigger
			war = no
			NOT = {
				is_liege_or_above = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		tier = count
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT type = revolt
		}
		ROOT = {
			primary_title = {
				set_title_nomad = {
					title = THIS status = no
				}
			}
			set_government_type = feudal_government
		}
		ROOT = {
			set_government_type = nomadic_government
			set_defacto_liege = FROM
			hidden_tooltip = {
				remove_opinion = {
					who = FROM
					modifier = opinion_evil_tyrant
				}
			}
		}
		FROM = {
			prestige = -100
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 10
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = crushed_revolt
					days = 3650
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# 61: Nomads can subjugate non-Nomads
nomad_subjugation = {
	name = CB_NAME_PAGAN_SUBJUGATION
	war_name = WAR_NAME_PAGAN_SUBJUGATION
	sprite = 8
	truce_days = 365
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		#higher_tier_than between ROOT and FROM would be better but its tooltip doesn't say anything about comparing character tiers
		OR = {
			ROOT = {
				higher_tier_than = king
			}
			NOT = {
				FROM = {
					tier = emperor
				}
			}
		}
		FROM = {
			is_nomadic = no
			OR = {
				AND = {
					is_tribal = yes
					ROOT = {
						population = 2500
					}
				}
				ROOT = {
					population = 10000
				}
			}
		}
		ROOT = {
			prestige = 500
		}
	}
	on_add = {
		ROOT = {
			prestige = -500
			add_character_modifier = {
				name = launched_subjugation
				days = -1
				hidden = yes
			}
		}
	}
	can_use = {
		ROOT = {
			is_nomadic = yes
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			mercenary = no
			NOT = {
				has_character_modifier = launched_subjugation
			}
		}
		FROM = {
			in_revolt = no
			is_nomadic = no # Nomads cannot be subjugated
			NOT = {
				any_war = {
					defender = {
						character = PREVPREV
					}
					OR = {
						using_cb = nomad_subjugation
						using_cb = pagan_subjugation
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			if = {
				limit = {
					is_reformed_religion = ROOT
					controls_religion = no
				}
				religion = ROOT # Reformed pagans are forced to convert back
			}
			custom_tooltip = {
				text = tribal_subjugation_tip
			}
			hidden_tooltip = {
				opinion = {
					modifier = opinion_subjugated
					who = ROOT
				}
				any_vassal = {
					opinion = {
						modifier = opinion_subjugated
						who = ROOT
					}
				}
				set_defacto_liege = ROOT
				any_demesne_title = {
					limit = {
						higher_tier_than = ROOT
						NOT = {
							controls_religion = yes
						}
					}
					ROOT = {
						grant_title = {
							target = PREV type = invasion
						}
					}
					add_pressed_claim = PREV
					PREV = {
						set_character_flag = had_higher_titles
					}
				}
				if = {
					limit = {
						has_character_flag = had_higher_titles
					}
					set_defacto_liege = ROOT
					clr_character_flag = had_higher_titles
					break = yes
				}
				any_demesne_title = {
					limit = {
						tier = ROOT
						NOT = {
							controls_religion = yes
						}
					}
					ROOT = {
						grant_title = {
							target = PREV type = invasion
						}
					}
					add_pressed_claim = PREV
				}
				if = {
					limit = {
						any_demesne_title = {
							NOT = {
								controls_religion = yes
							}
						}
					}
					set_defacto_liege = ROOT
				}
				if = {
					limit = {
						any_demesne_title = {
							controls_religion = yes
						}
					}
					any_vassal = {
						set_defacto_liege = ROOT
					}
					any_demesne_title = {
						limit = {
							NOT = {
								controls_religion = yes
							}
						}
						ROOT = {
							grant_title = {
								target = PREV type = invasion
							}
						}
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 10
	}

}

# 62:
nomad_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			OR = {
				AND = {
					prestige = 100
					population = 30000
					population_factor = 0.75 # 75% of max
				}
				trait = everchosen
			}
		}
	}
	on_add = {
		ROOT = {
			prestige = -100
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			is_nomadic = yes
		}
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		FROM = {
			prestige = -200
		}
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = {
					who = FROM type = invasion
				}
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_victorious
						}
						10 = {
							give_nickname = nick_the_conqueror
						}
						10 = {
							give_nickname = nick_the_brave
						}
						10 = {
							give_nickname = nick_the_dragon
						}
						10 = {
							give_nickname = nick_the_terrible
						}
					}
				}
			}
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						is_crusade = yes # Even if the title holder is not participating in the war, gain holdings occupied by all Crusade participants
						type = invasion
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 8
		# modifier = {
		# factor = 0.9 # Prefer using CB's without on_add costs
		# }
		modifier = {
			factor = 0
			ROOT = {
				trait = everchosen
			}
		}
	}

}

# 63: Nomads can grab entire duchies, if they have the Prestige
nomad_expansion = {
	name = CB_NAME_NOMAD_EXPANSION
	war_name = WAR_NAME_NOMAD_EXPANSION
	sprite = 8
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			prestige = 300
			population_factor = 0.5
		}
		FROM = {
			OR = {
				is_nomadic = yes # Nomads no population requirement
				AND = {
					is_tribal = yes
					ROOT = {
						population = 5000
					} # Tribals need 5k
				}
				ROOT = {
					population = 15000
				} # Everyone else needs 15k
			}
		}
	}
	on_add = {
		ROOT = {
			prestige = -300
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			is_nomadic = yes
			NOT = {
				same_realm = FROM
			}
			mercenary = no
		}
	}
	can_use_title = {
		NAND = {
			ROOT = {
				#has_global_flag = mists_of_albion
				NOT = {
					capital_scope = {
						region = world_albion
					}
				}
			}
			location = {
				region = world_albion
			}
		}
		# The attacker needs at least one county in the target duchy, or a border
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						has_owner = yes
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			wh_cb_pays_tribute_to_from_trigger = no
			is_nomadic = yes
			NOT = {
				same_realm = FROM
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -10
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -10
				}
			}
		}
		FROM = {
			prestige = -200
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						title = PREV
						enemy = FROM
						#						same_religion = yes # Only vassalize rulers of my religion
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			prestige = -200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 300
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -10
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 300
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -10
				}
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 2
	}

}

#64
increase_council_power_war = {
	# Started from faction
	name = CB_NAME_INCREASE_COUNCIL_POWER
	war_name = WAR_NAME_INCREASE_COUNCIL_POWER
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		higher_tier_than = BARON
		OR = {
			has_law = law_voting_power_0
			has_law = banish_voting_power_0
			has_law = execution_voting_power_0
			has_law = revoke_title_voting_power_0
			has_law = grant_title_voting_power_0
			has_law = imprison_voting_power_0
			has_law = war_voting_power_0
		}
		is_primary_holder_title = yes
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			opinion = {
				modifier = opinion_increased_council_power
				who = FROM
				months = 12
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_success_title = {
		if = {
			limit = {
				has_law = law_voting_power_0
			}
			add_law_w_cooldown = law_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = war_voting_power_0
			}
			add_law_w_cooldown = war_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = revoke_title_voting_power_0
			}
			add_law_w_cooldown = revoke_title_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = imprison_voting_power_0
			}
			add_law_w_cooldown = imprison_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = grant_title_voting_power_0
			}
			add_law_w_cooldown = grant_title_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = banish_voting_power_0
			}
			add_law_w_cooldown = banish_voting_power_1
			break = yes
		}
		if = {
			limit = {
				has_law = execution_voting_power_0
			}
			add_law_w_cooldown = execution_voting_power_1
			break = yes
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_council_power_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_council_power_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}

# 55
nomad_humiliate_cb = {
	name = CB_NAME_HUMILIATE
	war_name = WAR_NAME_HUMILIATE
	sprite = 1
	truce_days = 3650
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = no
	display_on_map = no
	coalition_threat = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			is_nomadic = yes
			mercenary = no
			OR = {
				AND = {
					same_realm = FROM
					has_feud_with = FROM
				}
				FROM = {
					is_nomadic = yes
					independent = yes
				}
			}
		}
		# The attacker needs a border, or be at most two sea zones away from one of the target's counties
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								OR = {
									AND = {
										has_owner = yes
										owner = {
											OR = {
												character = ROOT
												is_liege_or_above = ROOT
											}
										}
									}
									AND = {
										is_land = no
										any_neighbor_province = {
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 300
			steal_population_scaled = {
				target = FROM
				percentage = 0.1
			}
		}
		FROM = {
			prestige = -300
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = 100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
		modifier = {
			factor = 2
			FROM = {
				trait = proud
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = brave
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = greedy
			}
		}
		modifier = {
			factor = 3
			FROM = {
				tier = KING
			}
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.2
				}
			}
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.0
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 3
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 4
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 5
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 6
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				relative_power = {
					who = FROM power = 8
				}
			}
		}
		modifier = {
			factor = 0.25
			ROOT = {
				relative_power = {
					who = FROM power = 10
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 20
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 40
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 80
				}
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 120
				}
			}
		}
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.1 # Low prio CB
		}
		modifier = {
			factor = 0.1 # Target has almost no money
			FROM = {
				OR = {
					is_nomadic = yes
					is_tribal = yes
				}
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				trait = greedy
			}
		}
	}

}

#64
powerful_vassal_takeover_war = {
	# Started from faction
	name = CB_NAME_POWERFUL_VASSAL_TAKEOVER
	war_name = WAR_NAME_POWERFUL_VASSAL_TAKEOVER
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		higher_tier_than = BARON
		is_primary_holder_title = yes
	}
	is_valid = {
		FROM = {
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	on_success = {
		any_attacker = {
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_success_title = {
		#This is the target title of the faction
		if = {
			limit = {
				has_law = law_voting_power_0
			}
			add_law_w_cooldown = law_voting_power_1
		}
		if = {
			limit = {
				has_law = war_voting_power_0
			}
			add_law_w_cooldown = war_voting_power_1
		}
		if = {
			limit = {
				has_law = succession_voting_power_0
			}
			add_law_w_cooldown = succession_voting_power_1
		}
		if = {
			limit = {
				NOT = {
					has_law = succ_feudal_elective
				}
			}
			add_law_w_cooldown = succ_feudal_elective
		}
		holder_scope = {
			most_popular_vassal = {
				limit = {
					higher_tier_than = BARON
					is_feudal = yes
					prisoner = no
					NOR = {
						trait = in_hiding
						trait = incapable
						trait = eunuch
					}
					age = 16
					#can_hold_title = PREVPREV
					OR = {
						is_female = no
						AND = {
							is_female = yes
							ROOT = {
								has_law = true_cognatic_succession
							}
						}
					}
				}
				grant_title = PREVPREV
				save_event_target_as = new_title_holder
				hidden_tooltip = {
					any_attacker = {
						limit = {
							NOT = {
								character = PREV
							}
						}
						set_character_flag = helped_win_war
					}
				}
				character_event = {
					id = 8226 days = 1
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_powerful_vassal_takeover_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_powerful_vassal_takeover_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}

}
