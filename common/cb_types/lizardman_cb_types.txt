## normal scopes(including posttitle scopes) ##
# ROOT = receiver
# FROM = giver
# <no scope change> = attacker or receiver
## title scopes ##
# ROOT = receiver
# FROM = giver
# <no scope change> = thirdparty landed title	
#
# the following effects/triggers exists (example execution order: on_success->on_success_title->on_success_posttitle):
# is_valid, is_valid_title, on_add, on_add_title, on_add_posttitle, on_success, on_success_title, on_success_posttitle, on_fail, on_fail_title, on_fail_posttitle, on_reverse_demand, on_reverse_demand_title, on_reverse_demand_posttitle
#
# Added on_attacker_leader_death, on_defender_leader_death and on_thirdparty_death, which all trigger when corresponding character dies
# These three all have war scopes, which currently has the following scope changes: 
# attacker, defender, thirdparty(only valid if thirdparty character is involved), thirdparty_title(only valid if thirdparty title is involved)
#
# ai_will_do: modifies value AI places on the CB compared to other CBs (default: 1)
# can_use_gui: If otherwise valid, the CB is listed in the Diplo View, but you can't declare war unless 'can_use_gui' is also valid (also shows a trigger tooltip.)
#

# The CB used by "Peasant revolter" characters
lustrian_rampage = {
	name = CB_NAME_LUSTRIA_BEAST_RAMPAGE
	war_name = WAR_NAME_LUSTRIA_BEAST_RAMPAGE
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	
	is_independence = no
	
	can_use = {
		ROOT = {
			primary_title = { temporary = yes } # Revolter or adventurer trigger
			war = no
			NOT = { is_liege_or_above = FROM }
		}
	}

	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		tier = count
	}

	is_valid_title = {
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
			}
		}
	}

	on_success_title = {
		FROM = {
			prestige = -100
		}
		ROOT = {		
			death = { death_reason = death_execution }
			any_courtier = {
				if = { limit = { has_character_flag = rampaging_beast }
					death = { death_reason = death_execution }
				}
			}
		}		
	}

	on_fail_title = {
		FROM = {
			prestige = 10
		}
		ROOT = {		
			death = { death_reason = death_execution }
			any_courtier = {
				if = { limit = { has_character_flag = rampaging_beast }
					death = { death_reason = death_execution }
				}
			}
		}
	}

	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				add_character_modifier = { 
					name = crushed_revolt
					days = 3650
				}
			}
		}
		ROOT = {		
			death = { death_reason = death_execution }
			any_courtier = {
				if = { limit = { has_character_flag = rampaging_beast }
					death = { death_reason = death_execution }
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = 90 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = 90 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

realignment_process_cb = {
	name = CB_NAME_REALIGN_CHIEF
	war_name = WAR_NAME_REALIGN_CHIEF
	sprite = 6
	truce_days = 3000
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	can_use = {
		ROOT = {
			vassal_of = FROM
			or = {
				trait = creature_skink 
				AND = { 
					trait = creature_slann
					not = { 
						trait = lizardman_sleepingslann
					}
				}
			}
		}
	}
	
	is_valid = {
		FROM = {
			trait = creature_skink
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}

	is_valid_title = {
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		OR = {
			tier = emperor
			is_primary_holder_title = yes
		}
	}
	
		on_add = {
			ROOT = { if = { limit = { FROM = { NOT = { trait = defective } } }
					decadence = 10 } }
		}
	on_success = {
		FROM = {
			hidden_tooltip = { disband_event_forces = faction_loyalists }
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = { has_law = tribal_organization_0 }
				}
				if = {
					limit = { has_law = tribal_organization_1 }
					add_law = tribal_organization_0
				}
				if = {
					limit = { has_law = tribal_organization_2 }
					add_law = tribal_organization_1
				}
				if = {
					limit = { has_law = tribal_organization_3 }
					add_law = tribal_organization_2
				}
				if = {
					limit = { has_law = tribal_organization_4 }
					add_law = tribal_organization_3
				}
			}
			any_demesne_title = {
				limit = { higher_tier_than = COUNT }
				gain_title = { target = ROOT type = faction_demand }
				}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
				disband_event_forces = faction_revolters
			}
		}
	}

	on_success_title = {
	}

	on_fail = {
		ROOT = {
			prestige = -100
			piety = -100
			decadence = 10
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = { decadence = -5
			hidden_tooltip = { disband_event_forces = faction_loyalists } }
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			piety = -250
			decadence = 15
		}
			ROOT = { if = { limit = { trait = defective } }
				imprison = FROM }
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		
		FROM = { decadence = -10
			hidden_tooltip = { disband_event_forces = faction_loyalists } }
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
}

# Skinks can subjugate misaligned Skinks
skink_subjugation = {
	name = CB_NAME_SKINK_SUBJUGATION
	war_name = WAR_NAME_SKINK_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = no
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	can_use = {
		ROOT = {
			or = {
				trait = creature_skink
				and = { 
					trait = creature_slann
					not = { 
						trait = lizardman_sleepingslann
					}
				}

			}
			NOT = { same_realm = FROM }
			NOT = { is_liege_or_above = FROM }
			NOT = { trait = defective }
		}
		FROM = {
			trait = creature_skink
			OR = { trait = defective 
				decadence = 75 }
			NOT = { any_war = {
						defender = { character = FROM }
						using_cb = skink_subjugation }
				}
			}
	}
	
	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		NOT = { de_jure_liege_or_above = e_nehekhara } #the title must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	on_add = { if = { limit = { FROM = { NOR = { trait = defective
							decadence = 75 } } }
			ROOT = { decadence = 15 }
			}
		}

	on_success = {
		ROOT = {
			piety = 100
			decadence = -3
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_piety = 100 }
			decadence = -5
		}
		FROM = {
			piety = -100
			prestige = -100
		}
	}
	
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = { ROOT = { tier = EMPEROR } }
			}
			ROOT = { usurp_title = { target = PREV type = invasion } }
		}
		
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = { higher_tier_than = FROM }
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = { usurp_title = { target = PREV type = invasion } }
				}
			}
		}
		
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM	
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = { # If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}

	on_fail = {
		FROM = {
			piety = 50
			decadence = -2
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
			decadence = -4
		}
		ROOT = {
			piety = -100
			decadence = 2
		}
	}

	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 5
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			decadence = -4
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
			decadence = -6
		}
	}

	attacker_ai_victory_worth = {
		factor = 200
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 1.5
			FROM = { decadence = 80 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 85 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 90 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 95 }
			}
		modifier = {
			factor = 2
			FROM = { decadence = 100 }
			}
		modifier = {
			factor = 2
			FROM = { trait = defective }
			}
		}
}

flower_war_raid = {
	name = CB_NAME_FLOWER_WAR_RAID
	war_name = WAR_NAME_FLOWER_WAR_RAID
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.75
	
	allow_distant = yes # AI parameter
	
	
	can_use = {
		ROOT = {
			religion_group = old_ones_group
			NOT = { has_character_modifier = favour_chotec }
			NOT = { has_character_modifier = favour_quetzl }
			NOT = { has_character_modifier = favour_xholankha }
			NOT = { has_character_modifier = favour_sotek }
		}
		FROM = {
			OR = { AND = { ROOT = { trait = creature_amazon }	#Amazons do not attack other Amazons, but they do attack men around them.
					FROM = { OR = { trait = creature_halfling
							trait = creature_human } }
					 }
				NOT = { religion = ROOT } } #No Lizardmen on Lizardmen, but yes Lizardmen on Amazons and viceversa
		}
	}
	
	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		NOT = { de_jure_liege_or_above = e_nehekhara } #the title must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).

		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}

	is_valid = {
		ROOT = {
			NOT = { same_realm = FROM }
		}
	}
	on_add = {
		#hidden_tooltip = { ROOT = { set_variable = { which = "sacrifical_victims" value = 0 } } }
		if = { 
			limit = {
				FROM = { 
					higher_tier_than = BARON 	
				}
			}
			ROOT = {
				set_variable = { which = "sacrifices_needed" value = "9"}
				set_variable = { which = "sacrifices_needed_sotek" value = "15"}
			}
		}
		if = { 
			limit = {
				FROM = { 
					higher_tier_than = COUNT 	
				}
			}
			ROOT = {
				set_variable = { which = "sacrifices_needed" value = "18"}
				set_variable = { which = "sacrifices_needed_sotek" value = "24"}
			}
		}
		if = { 
			limit = {
				FROM = { 
					higher_tier_than = DUKE 	
				}
			}
			ROOT = {
				set_variable = { which = "sacrifices_needed" value = "27"}
				set_variable = { which = "sacrifices_needed_sotek" value = "33"}
			}
		}
		if = { 
			limit = {
				FROM = { 
					higher_tier_than = KING 	
				}
			}
			ROOT = {
				set_variable = { which = "sacrifices_needed" value = "36"}
				set_variable = { which = "sacrifices_needed_sotek" value = "42"}
			}
		}						
	}
	
	on_add_title = {
	}

	on_success = {
		ROOT = {
			piety = 150
			participation_scaled_piety = 150
		hidden_tooltip = { character_event = { id = slizardmen.17 } }
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100
						participation_scaled_piety = 100
						decadence = -3 }
		}
		FROM = {
			piety = -300
		}
	}
	on_fail = {
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
						decadence = -3
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { 
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
						decadence = -3 }
		}
		ROOT = {
			piety = -100
			decadence = 5
		}
	}

	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 7
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			decadence = -3
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100
			participation_scaled_piety = 100
			decadence = -3 }
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 80
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 80
	}
	
	ai_will_do = { 
		factor = 1
		
		modifier = {
			factor = 0.0001
			NOT = { ROOT = { primary_title = { num_of_realm_counties = { value = 6
										title = PREV } 
						}
				 }
			}
		}
		modifier = {
			factor = 0.1
			FROM = { trait = creature_skink }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = creature_slann }
		}
		modifier = {
			factor = 3
			ROOT = { trait = zealous }
		}
		modifier = {
			factor = 3
			ROOT = { trait = creature_skink 
				trait = diligent }
		}
		modifier = {
			factor = 3
			ROOT = { trait = creature_human
				trait = impaler }
		}
	}
}


tablet_search = {
	name = CB_NAME_TABLET_SEARCH
	war_name = WAR_NAME_TABLET_SEARCH
	sprite = 9
	truce_days = 36500
	is_permanent = yes
	is_holy_war = yes
	battle_warscore_mult = 0.375
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no
	#hostile_against_others = yes
	#can_ask_to_join_war = yes
	
	can_use_gui = {
		ROOT = {
			religion_authority = 0.05
			religion = old_ones
			OR = { trait = creature_slann
				has_character_flag = sanctioned_by_slann }
			
			custom_tooltip = {
				text = ctt_no_crusade_cooldown
				hidden_tooltip = { NOT = { has_character_modifier = crusade_cooldown } }
				}
			piety = 500
		}
	}

	can_use = {
		ROOT = {
			#can_call_crusade = yes
			ai = yes
			OR = { trait = creature_slann
				has_character_flag = sanctioned_by_slann }
		}
		
		FROM = {
				NOT = { religion_group = ROOT }
		}
	}

	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		FROM = { any_realm_title = { de_jure_liege_or_above = PREVPREV }
			 independent = yes # Don't declare Crusades on revolters - chances are high the war will invalidate
			 }
	}
	
	is_valid = {
		#ROOT = {
		#	can_call_crusade = yes
		#}
		FROM = {
			OR = {
				NOT = { religion_group = ROOT }
				is_heresy_of = ROOT
				is_parent_religion = ROOT
				}
			}
	}

	is_valid_title = {
		FROM = { any_realm_title = { de_jure_liege_or_above = PREVPREV } }
	}

	on_add = {
		ROOT = {
			custom_tooltip = {
				text = holy_war_cooldown_ctt
				hidden_tooltip = {
					add_character_modifier = {
						name = crusade_cooldown
						hidden = yes
						duration = 10950
						}
					}
				}
			}
	}
	
	on_success_title = {
	
			most_participating_attacker = {
				decadence = -25
				piety = 400
				
			random_list = {
					33 = { military_techpoints = 500 }
					33 = { economy_techpoints = 500 }
					33 = { culture_techpoints = 500 }
					}
				hidden_tooltip = {
					if = {
						limit = { has_nickname = no }
						random_list = {
							10 = { give_nickname = nick_the_deliverer }
							10 = { give_nickname = nick_the_slithering }
							15 = { give_nickname = nick_the_glorious }
							10 = { give_nickname = nick_the_greatcoatl }
							15 = { give_nickname = nick_the_keeper }
							15 = { give_nickname = nick_the_herald }
							15 = { give_nickname = nick_the_prophet }
							15 = { give_nickname = nick_the_holy }
						}
					}
				}
			}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 500
			participation_scaled_piety = 1000
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
		hidden_tooltip = { 
			disband_event_forces = liz_fleet
				participation_scaled_prestige = 500
				participation_scaled_piety = 1000
				decadence = -15
				clr_character_flag = sanctioned_by_slann
			random_list = {
					33 = { military_techpoints = 100 }
					33 = { economy_techpoints = 100 }
					33 = { culture_techpoints = 100 }
					}
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_crusade
				years = 20
				}
			}
		
		FROM = {
			piety = -100
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = lost_crusade
				years = 20
				}			
			}
	}

	on_fail = {
		ROOT = {
			piety = -100
			decadence = 20
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
		}
		
		any_defender = {
			limit = { character = FROM }
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			disband_event_forces = liz_fleet
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { 
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
			disband_event_forces = liz_fleet
			}
		}
		
		FROM = {
			hidden_tooltip = {
			disband_event_forces = liz_fleet
				if = { limit = { has_nickname = no }
					random_list = {
						10 = { give_nickname = nick_the_holy }
						10 = { give_nickname = nick_the_glorious }
						10 = { give_nickname = nick_the_lionheart }
						10 = { give_nickname = nick_the_great }
						10 = { give_nickname = nick_the_hammer }
						}
					}
				}
			}
	}

	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 30
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = lost_crusade
				years = 20
			}
		}
		FROM = {
			piety = 100
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = won_crusade
				years = 20
			}
		}
		FROM = {
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = { give_nickname = nick_the_holy }
						10 = { give_nickname = nick_the_glorious }
						10 = { give_nickname = nick_the_lionheart }
						10 = { give_nickname = nick_the_great }
						10 = { give_nickname = nick_the_hammer }
						}
					}
				}
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { 
				disband_event_forces = liz_fleet
				participation_scaled_piety = 300
				participation_scaled_prestige = 150
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}


# Sotek conquest
sotek_conquest_cb = {
	name = CB_NAME_SOTEK_PURIFICATION
	war_name = WAR_NAME_SOTEK_PURIFICATION
	sprite = 9
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	can_use = {
		ROOT = { 
			has_character_modifier = favour_sotek 
			OR = {
				trait = creature_skink
				trait = creature_slann
			} 
		}
		FROM = { 
			NOR = { 
				trait = creature_slann
				 trait = creature_saurus
				 trait = creature_skink }
			 }
	}
	
	on_add = {
		ROOT = { decadence = 20 }
	}
	
	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		NOT = { de_jure_liege_or_above = e_nehekhara } #the duchy must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).

		OR = { capital_scope = { region = world_new_world_lustria }
			capital_scope = { region = world_new_world_arnheim } }
	
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								# Audax Validator "!" Ignore_1002
								OR = {
									year = 1100
									# ROOT = { religion_group = muslim }
									# FROM = { religion_group = muslim }
								}
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}

	is_valid = {
		ROOT = {
			NOT = { same_realm = FROM }
		}
	}
	
	on_success = {
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
#			if = {
#				limit = {
#					religion_group = muslim
#				}
#				participation_scaled_decadence = -10
#			}
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { 
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
#				if = {
#					limit = {
#						religion_group = muslim
#					}
#					participation_scaled_decadence = -10
#				}
			}
		}
		
		FROM = { piety = -100 }
		FROM = { prestige = -50 }
	}

	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
	#				gain_settlements_under_title = {
	#					title = PREV
	#					enemy = FROM
	#				}
				}
			}
		}
	}

	on_fail = {
		ROOT = { 
			piety = -50 
			prestige = -100
		}
	}

	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -5
				}
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { 
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -5
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 0
			ROOT = { NOR = { trait = defective
					trait = ambitious
					trait = greedy
					trait = proud } }
			}
		modifier = {
			factor = 10
			ROOT = { trait = defective }
			}

	}
}
# Slann are dead cb
crazy_skinks_cb = {
	name = CB_NAME_CRAZED_SKINKS
	war_name = WAR_NAME_CRAZED_SKINKS
	sprite = 9
	truce_days = 150
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	can_use = {
		has_global_flag = all_slann_dead
		ROOT = { trait = creature_skink }
	}
	
	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		NOT = { de_jure_liege_or_above = e_nehekhara } #the duchy must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).

		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								# Audax Validator "!" Ignore_1002
								OR = {
									year = 1100
									# ROOT = { religion_group = muslim }
									# FROM = { religion_group = muslim }
								}
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}

	is_valid = {
		ROOT = {
			NOT = { same_realm = FROM }
		}
	}
	
	on_success = {
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
#			if = {
#				limit = {
#					religion_group = muslim
#				}
#				participation_scaled_decadence = -10
#			}
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { 
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
#				if = {
#					limit = {
#						religion_group = muslim
#					}
#					participation_scaled_decadence = -10
#				}
			}
		}
		
		FROM = { piety = -100 }
		FROM = { prestige = -50 }
	}

	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
	#				gain_settlements_under_title = {
	#					title = PREV
	#					enemy = FROM
	#				}
				}
			}
		}
	}

	on_fail = {
		ROOT = { 
			piety = -50 
			prestige = -100
		}
	}

	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -5
				}
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { 
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -5
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 100
			}
		modifier = {
			factor = 10
			ROOT = { trait = defective }
			}

	}
}

strengthen_amazonia_cb = {
	name = CB_NAME_STRENGTHEN_AMAZONIA
	war_name = WAR_NAME_STRENGTHEN_AMAZONIA
	sprite = 6
	truce_days = 3000
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	can_use = {
		ROOT = {
			vassal_of = FROM
			trait = creature_amazon }
	}
	
	is_valid = {
		FROM = {
			trait = creature_amazon 
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}

	is_valid_title = {
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		OR = {
			tier = emperor
			is_primary_holder_title = yes
		}
	}
	
		on_add = {
			ROOT = { if = { limit = { FROM = { NOT = { trait = complacent } } }
					decadence = 5 } }
		}
	on_success = {
		FROM = {
			hidden_tooltip = { disband_event_forces = faction_loyalists }
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = { has_law = tribal_organization_0 }
				}
				if = {
					limit = { has_law = tribal_organization_1 }
					add_law = tribal_organization_0
				}
				if = {
					limit = { has_law = tribal_organization_2 }
					add_law = tribal_organization_1
				}
				if = {
					limit = { has_law = tribal_organization_3 }
					add_law = tribal_organization_2
				}
				if = {
					limit = { has_law = tribal_organization_4 }
					add_law = tribal_organization_3
				}
			}
			any_demesne_title = {
				limit = { higher_tier_than = COUNT }
				gain_title = { target = ROOT type = faction_demand }
				}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
				disband_event_forces = faction_revolters
			}
		}
	}

	on_success_title = {
	}

	on_fail = {
		ROOT = {
			prestige = -100
			piety = -100
			decadence = 10
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = { decadence = -5
			hidden_tooltip = { disband_event_forces = faction_loyalists } }
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			piety = -250
			decadence = 15
		}
			ROOT = { if = { limit = { trait = complacent } }
				imprison = FROM }
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		
		FROM = { decadence = -10
			hidden_tooltip = { disband_event_forces = faction_loyalists } }
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
}
# Amazons can subjugate decadent Amazons of their own dynasty
amazon_subjugation = {
	name = CB_NAME_AMAZON_SUBJUGATION
	war_name = WAR_NAME_AMAZON_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = no
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	can_use = {
		ROOT = {
			trait = creature_amazon
			dynasty = FROM
			NOT = { same_realm = FROM }
			NOT = { is_liege_or_above = FROM }
			NOT = { trait = defective }
		}
		FROM = {
			trait = creature_amazon
			trait = complacent
			NOT = { any_war = {
						defender = { character = FROM }
						using_cb = amazon_subjugation }
				}
			}
	}
	
	can_use_title = {
		NAND = {
			location = { region = world_albion }
			ROOT = {
				has_global_flag = mists_of_albion
				capital_scope = { NOT = { region = world_albion } }
			}
		}
		NOT = { de_jure_liege_or_above = e_the_under_empire } 
		NOT = { de_jure_liege_or_above = e_nehekhara } #the title must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	on_add_title = {
	}

	on_success = {
		ROOT = {
			piety = 100
			decadence = -7
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_piety = 100 }
			decadence = -5
		}
		FROM = {
			piety = -100
			prestige = -100
			abdicate_to = ROOT
			imprison = ROOT
		}
	}
	
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = { ROOT = { tier = EMPEROR } }
			}
			ROOT = { usurp_title = { target = PREV type = invasion } }
		}
		
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = { higher_tier_than = FROM }
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = { usurp_title = { target = PREV type = invasion } }
				}
			}
		}
		
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM	
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = { # If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}

	on_fail = {
		FROM = {
			piety = 50
			decadence = -2
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
			decadence = -4
		}
		ROOT = {
			piety = -100
			decadence = 2
		}
	}

	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 5
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			decadence = -4
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
			decadence = -6
		}
	}

	attacker_ai_victory_worth = {
		factor = 200
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 1.5
			FROM = { decadence = 80 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 85 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 90 }
			}
		modifier = {
			factor = 1.5
			FROM = { decadence = 95 }
			}
		modifier = {
			factor = 2
			FROM = { decadence = 100 }
			}
		modifier = {
			factor = 2
			FROM = { trait = complacent }
			}
		}
}
