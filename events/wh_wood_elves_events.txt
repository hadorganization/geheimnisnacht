namespace = asrai

# INDEX
# The inheritance of Athel Loren

# asrai.1 becoming an avatar
# asrai.2 the avatars go into hibernation along with all spirits in the winter.

# becoming an avatar
long_character_event = {
	id = asrai.1
	title = EVTTITLEasrai1
	picture = GFX_evt_asrai_tree
	desc = {
		text = EVTDESCAasrai1
		trigger = {
			is_female = yes
		}
	}
	desc = {
		text = EVTDESCBasrai1
		trigger = {
			is_female = no
		}
	}
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.1"
	}

	option = {
		name = EVTOPTAasrai1
		trigger = {
			is_female = yes
		}
		add_trait = avatar_isha
		set_character_flag = ai_flag_refuse_conversion
		leave_society = yes
		clr_character_flag = spirituallytempted_slaanesh
		clr_character_flag = physicallytempted_slaanesh
		clr_character_flag = hidden_cultist_tzeentch
		clr_character_flag = hidden_cultist_tzeentch2
		clr_character_flag = hidden_cultist_tzeentch3
		clr_character_flag = hidden_cultist_khorne
		clr_character_flag = hidden_cultist_khorne2
		clr_character_flag = hidden_cultist_khorne3
		clr_character_flag = hidden_cultist_slaanesh
		clr_character_flag = hidden_cultist_slaanesh2
		clr_character_flag = hidden_cultist_slaanesh3
		clr_character_flag = hidden_cultist_nurgle
		clr_character_flag = hidden_cultist_nurgle2
		clr_character_flag = hidden_cultist_nurgle3
		hidden_tooltip = {
			if = {
				limit = {
					spouse = {
						trait = avatar_kurnous
					}
				}
				add_trait = chaste
			}
			if = {
				limit = {
					NOT = {
						trait = asrai_spellsinger
					}
				}
				add_trait = asrai_spellsinger
			}
			remove_trait = asur_mage
			if = {
				limit = {
					has_character_modifier = magic_power_3
					NOT = {
						has_character_modifier =
						magic_power_4
					}
				}
				z_magic_power_sequential_addition = yes
			}
			if = {
				limit = {
					has_character_modifier = magic_power_2
					NOT = {
						has_character_modifier =
						magic_power_3
					}
				}
				z_magic_power_sequential_addition = yes
			}
			if = {
				limit = {
					has_character_modifier = magic_power_1
					NOT = {
						has_character_modifier =
						magic_power_2
					}
				}
				z_magic_power_sequential_addition = yes
			}
			if = {
				limit = {
					NOT = {
						has_character_modifier =
						magic_power_1
					}
					NOT = {
						has_character_modifier =
						magic_power_2
					}
					NOT = {
						has_character_modifier =
						magic_power_3
					}
					NOT = {
						has_character_modifier =
						magic_power_4
					}
				}
				z_magic_power_sequential_addition = yes

			}
			random_list = {
				30 = {
					add_trait = patient
				}
				30 = {
					add_trait = just
				}
				30 = {
					add_trait = proud
				}
				10 = {
				} # Influence of Isha

			}
		}
	}

	option = {
		name = EVTOPTBasrai1
		trigger = {
			is_female = no
		}
		add_trait = avatar_kurnous
		set_character_flag = ai_flag_refuse_conversion
		leave_society = yes
		clr_character_flag = spirituallytempted_slaanesh
		clr_character_flag = physicallytempted_slaanesh
		clr_character_flag = hidden_cultist_tzeentch
		clr_character_flag = hidden_cultist_tzeentch2
		clr_character_flag = hidden_cultist_tzeentch3
		clr_character_flag = hidden_cultist_khorne
		clr_character_flag = hidden_cultist_khorne2
		clr_character_flag = hidden_cultist_khorne3
		clr_character_flag = hidden_cultist_slaanesh
		clr_character_flag = hidden_cultist_slaanesh2
		clr_character_flag = hidden_cultist_slaanesh3
		clr_character_flag = hidden_cultist_nurgle
		clr_character_flag = hidden_cultist_nurgle2
		clr_character_flag = hidden_cultist_nurgle3
		hidden_tooltip = {
			if = {
				limit = {
					spouse = {
						trait = avatar_isha
					}
				}
				add_trait = chaste
			}
			random_list = {
				30 = {
					add_trait = wroth
				}
				30 = {
					add_trait = zealous
				}
				30 = {
					add_trait = proud
				}
				10 = {
				} # Influence of Kurnous

			}
		}
	}
}

# resting as avatar/spirit
character_event = {
	id = asrai.2
	picture = GFX_evt_elf_winter
	desc = {
		text = EVTDESCAasrai2
		trigger = {
			trait = avatar_isha
		}
	}
	desc = {
		text = EVTDESCBasrai2
		trigger = {
			trait = avatar_kurnous
		}
	}
	desc = {
		text = EVTDESCCasrai2
		trigger = {
			OR = {
				trait = creature_treekin
				trait = creature_forestspirit
			}
		}
	}

	trigger = {
		OR = {
			trait = avatar_isha
			trait = avatar_kurnous
			trait = creature_treekin
			trait = creature_forestspirit
		}
		month = 8
		NOT = {
			trait = resting
		}
	}

	mean_time_to_happen = {
		months = 1
	}

	immediate = {
		log = "work event asrai.2"
		add_trait = resting
		if = {
			limit = {
				has_character_flag = kurnous_frenzy
			}
			remove_trait = lunatic_3
			clr_character_flag = kurnous_frenzy
		}
		if = {
			limit = {
				has_character_flag = spirit_frenzy
			}
			random = {
				chance = 30
				remove_trait = lunatic_3
				clr_character_flag = spirit_frenzy
			}
		}
		if = {
			limit = {
				e_athel_loren = {
					holder_scope = {
						capital_scope = {
							NOT = {
								has_province_modifier = athel_loren_winter
							}
						}
					}
				}
			}

 			e_athel_loren = {
				holder_scope = {
					any_vassal = {
						capital_scope = {
							add_province_modifier = {
								name = athel_loren_winter
								duration = 120
							}
						}
						any_vassal = {
							capital_scope = {
								add_province_modifier = {
									name = athel_loren_winter
									duration = 120
								}
							}
							any_vassal = {
								capital_scope = {
									add_province_modifier = {
										name = athel_loren_winter
										duration = 120
									}
								}
							} # anyvassal (counts)
						} # anyvassal (dukes)
					} # anyvassal (kings)
				}
			}
		}
	}

	option = {
		name = EVTOPTAasrai2
		trigger = {
			trait = avatar_isha
		}
		hidden_tooltip = {
			character_event = {
				id = asrai.3 days = 120 random = 30
			}
		}
	}

	option = {
		name = EVTOPTBasrai2
		trigger = {
			trait = avatar_kurnous
		}
		hidden_tooltip = {
			random_list = {
				99 = {
					character_event = {
						id = asrai.3 days = 120 random = 30
					}
				}
				1 = {
					modifier = {
						factor = 10
						NOT = {
							avatar_isha = {
								is_alive = yes
							}
						}
					}
					character_event = {
						id = asrai.4 days = 120 random = 30
					}
				}
			}
		}
	}

	option = {
		name = EVTOPTCasrai2
		trigger = {
			OR = {
				trait = creature_treekin
				trait = creature_forestspirit
			}
		}
		hidden_tooltip = {
			character_event = {
				id = asrai.3 days = 120 random = 30
			}
		}
	}
}

# Awakening
character_event = {
	id = asrai.3
	picture = GFX_evt_elf_pondering
	desc = EVTDESCAasrai3
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.3"
		remove_trait = resting
	}

	option = {
		name = EVTOPTAasrai3
		hidden_tooltip = {
			remove_trait = incapable
			remove_trait = infirm
			remove_trait = disfigured
			remove_trait = maimed
			remove_trait = wounded
		}
	}
}

# Kurnous awakes in a frenzy
character_event = {
	id = asrai.4
	picture = GFX_evt_mad_kurnous
	desc = EVTDESCAasrai4
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.4"
		remove_trait = resting
	}

	option = {
		name = EVTOPTAasrai4
		set_character_flag = kurnous_frenzy
		add_trait = lunatic_3
		hidden_tooltip = {
			any_playable_ruler = {
				limit = {
					ai = no
					NOT = {
						character = ROOT
					}
					capital_scope = {
						empire = {
							title = e_athel_loren
						}
					}
				}
				character_event = {
					id = asrai.5 days = 2
				} # notify player
			}
			e_athel_loren = {
				holder_scope = {
					any_vassal = {
						limit = {
							OR = {
								trait = creature_treekin
								trait = creature_forestspirit
							}
						}
						set_character_flag = kurnous_frenzy
						add_trait = lunatic_3
						any_courtier = {
							limit = {
								OR = {
									trait = creature_treekin
									trait = creature_forestspirit
								}
							}
							set_character_flag = kurnous_frenzy
							add_trait = lunatic_3
						}
						any_vassal = {
							limit = {
								OR = {
									trait = creature_treekin
									trait = creature_forestspirit
								}
							}
							set_character_flag = kurnous_frenzy
							add_trait = lunatic_3
							any_courtier = {
								limit = {
									OR = {
										trait = creature_treekin
										trait = creature_forestspirit
									}
								}
								set_character_flag = kurnous_frenzy
								add_trait = lunatic_3
							}
							any_vassal = {
								limit = {
									OR = {
										trait = creature_treekin
										trait = creature_forestspirit
									}
								}
								set_character_flag = kurnous_frenzy
								add_trait = lunatic_3
								any_courtier = {
									limit = {
										OR = {
											trait = creature_treekin
											trait = creature_forestspirit
										}
									}
									set_character_flag = kurnous_frenzy
									add_trait = lunatic_3
								}
								any_vassal = {
									limit = {
										OR = {
											trait = creature_treekin
											trait = creature_forestspirit
										}
									}
									set_character_flag = kurnous_frenzy
									add_trait = lunatic_3
									any_courtier = {
										limit = {
											OR = {
												trait = creature_treekin
												trait = creature_forestspirit
											}
										}
										set_character_flag = kurnous_frenzy
										add_trait = lunatic_3
									}
								}
							}
						}
					}
					any_courtier = {
						limit = {
							OR = {
								trait = creature_treekin
								trait = creature_forestspirit
							}
						}
						set_character_flag = kurnous_frenzy
						add_trait = lunatic_3
					}
				}
			}
		}
	}
}

# Notify player
character_event = {
	id = asrai.5
	picture = GFX_evt_mad_kurnous
	desc = EVTDESCAasrai5
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.5"
	}

	option = {
		name = EVTOPTAasrai5
		trigger = {
			OR = {
				trait = creature_treekin
				trait = creature_forestspirit
			}
		}
	}

	option = {
		name = EVTOPTBasrai5
		trigger = {
			trait = creature_elf
		}
	}

	option = {
		name = EVTOPTCasrai5
		trigger = {
			NOT = {
				trait = creature_elf
				trait = creature_treekin
				trait = creature_forestspirit
			}
		}
	}
}

# Bi-yearly, spirits can go insane when one or more avatars are missing
character_event = {
	id = asrai.6
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai6
	is_triggered_only = yes

	trigger = {
		OR = {
			trait = creature_treekin
			trait = creature_forestspirit
		}
		OR = {
			NOT = {
				avatar_isha = {
					is_alive = yes
				}
			}
			NOT = {
				avatar_kurnous = {
					is_alive = yes
				}
			}
		}
	}

	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 2
			NOT = {
				avatar_isha = {
					is_alive = yes
				}
			}
			NOT = {
				avatar_kurnous = {
					is_alive = yes
				}
			}
		}
	}

	immediate = {
		log = "work event asrai.6"
	}

	option = {
		name = EVTOPTAasrai6
		add_trait = lunatic_3
		set_character_flag = spirit_frenzy
	}
}

# umbrella event for restless spirits (by yearly)
# spirits destroy building

# spirits kill spouse
# spirits kill child

# spirits wound ruler
# spirits disfigure ruler

# spirits maim ruler
# spirits kill ruler

# spirits kill lover
# spirits kill courtier (not dynasty)

# spirits disfigure spouse
character_event = {
	id = asrai.7
	hide_window = yes
	only_playable = yes
	# is_triggered_only = yes

	trigger = {
		capital_scope = {
			empire = {
				title = e_athel_loren
			}
		}
		is_tribal = yes		# If a bretonnian eradicates the forest, the event stops happening
		NOT = {
			trait = morghur
		}	# Morghur immunity
		OR = {
			NOT = {
				religion = asrai_cadai
			}
			NOT = {
				piety = 0
			}
		}
	}

	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 1.25
			ai = yes
		}
		modifier = {
			factor = 0.75
			trait = creature_human
		}
		modifier = {
			factor = 0.5
			trait = creature_dwarf
		}
		modifier = {
			factor = 0.25
			religion_group = necromantic_group
		}
		modifier = {
			factor = 0.75
			trait = creature_orc
		}
		modifier = {
			factor = 0.5
			trait = creature_goblin
		}
		modifier = {
			factor = 0.75
			trait = stressed
		}
		modifier = {
			factor = 0.75
			trait = depressed
		}
		modifier = {
			factor = 0.1
			religion_group = chaos_gods_group
		}
		modifier = {
			factor = 4
			trait = creature_treekin
		}
		modifier = {
			factor = 0.75
			any_courtier = {
				trait = creature_forestspirit
			}
		}
		modifier = {
			factor = 0.75
			any_courtier = {
				trait = creature_treekin
			}
		}
		modifier = {
			factor = 0.75
			religion = asrai_cadai
			religion_authority = 0.25
		}
		modifier = {
			factor = 0.75
			religion = asrai_cadai
			religion_authority = 0.50
		}
		modifier = {
			factor = 5
			trait = avatar_kurnous
		}
		modifier = {
			factor = 4
			trait = avatar_isha
		}
		modifier = {
			factor = 0.75
			NOT = {
				avatar_kurnous = {
					is_alive = yes
				}
			}
		}
		modifier = {
			factor = 0.75
			avatar_kurnous = {
				trait = lunatic_3
			}
		}
		modifier = {
			factor = 0.75
			NOT = {
				avatar_isha = {
					is_alive = yes
				}
			}
		}
	}

	immediate = {
		log = "work event asrai.7"
		random_list = {
			10 = {
				character_event = {
					id = asrai.8
				} # destroy building
			}
			10 = {
				modifier = {
					factor = 0
					spouse = {
						is_ruler = yes
					}
				}
				modifier = {
					factor = 0
					NOT = {
						spouse = {
							is_alive = yes
						}
					}
				}
				spouse = {
					character_event = {
						id = asrai.9
					}
				} # spouse killed (notification 10)
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						spouse = {
							is_alive = yes
						}
					}
				}
				spouse = {
					character_event = {
						id = asrai.11
					}
				} # spouse disfigured (notification 12)
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						num_of_children = 1
					}
				}
				random_child = {
					character_event = {
						id = asrai.13
					}
				} # child killed (notification14)
			}
			10 = {
				modifier = {
					factor = 0
					trait = wounded
				}
				character_event = {
					id = asrai.15
				} # wounded
			}
			5 = {
				modifier = {
					factor = 0
					trait = creature_treekin
				}
				character_event = {
					id = asrai.16
				} # disfigured
			}
			10 = {
				modifier = {
					factor = 1.25
					trait = wounded
				}
				modifier = {
					factor = 0
					trait = incapable
				}
				character_event = {
					id = asrai.17
				} # maimed
			}
			5 = {
				modifier = {
					factor = 0.1
					trait = avatar_isha
				}
				modifier = {
					factor = 0.1
					trait = avatar_kurnous
				}
				modifier = {
					factor = 1.25
					trait = incapable
				}
				character_event = {
					id = asrai.18
				} # killed
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_lover = {
							NOT = {
								trait = pet_consort
							}
						}
					}
					NOT = {
						num_of_lovers = 1
					}
				}
				random_lover = {
					limit = {
						NOT = {
							trait = pet_consort
							is_ruler = yes
						}
					}
					character_event = {
						id = asrai.19
					}
				} # lover killed (notification 20)
			}
			15 = {
				modifier = {
					factor = 0
					trait = avatar_isha
				}
				modifier = {
					factor = 0
					trait = avatar_kurnous
				}
				random_courtier = {
					limit = {
						NOT = {
							dynasty = ROOT
							spouse = {
								character = ROOT
							}
							is_lover = ROOT
							trait = creature_treekin
							trait = creature_forestspirit
						}
					}
					character_event = {
						id = asrai.21
					}
				} # courtier killed (notification 22)
			}
			5 = {
				modifier = {
					factor = 0.5
					trait = creature_elf
				}
				modifier = {
					factor = 0.75
					trait = creature_treekin
				}
				character_event = {
					id = asrai.23
				} # driven mad
			}
		}
	}
}

# spirits destroy random building
character_event = {
	id = asrai.8
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai8
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.8"
	}

	option = {
		name = EVTOPTAasrai8
		prestige = -100
		location = {
			destroy_random_building = yes
		}
	}
}

# spirits kill spouse
character_event = {
	id = asrai.9
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai9
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.9"
	}

	option = {
		name = EVTOPTAasrai9
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
		FROM = {
			character_event = {
				id = asrai.10
			}
		}
	}
}

# spirits kill spouse - notify
character_event = {
	id = asrai.10
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai10
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.10"
	}

	option = {
		name = EVTOPTAasrai10
		prestige = -100
	}
}

# spirits disfigure spouse
character_event = {
	id = asrai.11
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai11
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.11"
	}

	option = {
		name = EVTOPTAasrai11
		add_trait = disfigured
		FROM = {
			character_event = {
				id = asrai.12
			}
		}
	}
}

# spirits disfigure spouse - notify
character_event = {
	id = asrai.12
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai12
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.12"
	}

	option = {
		name = EVTOPTAasrai12
		prestige = -100
	}
}

# spirits kill child
character_event = {
	id = asrai.13
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai13
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.13"
	}

	option = {
		name = EVTOPTAasrai13
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
		FROM = {
			character_event = {
				id = asrai.14
			}
		}
	}
}

# spirits kill child - notify
character_event = {
	id = asrai.14
	picture = GFX_evt_mad_spirit
	desc = {
		text = EVTDESCAasrai14
		trigger = {
			FROM = {
				age = 30
			}
		}
	}
	desc = {
		text = EVTDESCBasrai14
		trigger = {
			FROM = {
				NOT = {
					age = 30
				}
			}
		}
	}
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.14"
	}

	option = {
		name = EVTOPTAasrai14
		prestige = -100
		random = {
			chance = 35
			add_trait = depressed
		}
	}
}

# spirits wound you
character_event = {
	id = asrai.15
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai15
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.15"
	}

	option = {
		name = EVTOPTAasrai15
		prestige = -100
		add_trait = wounded
	}
}

# spirits disfigure you
character_event = {
	id = asrai.16
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai16
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.16"
	}

	option = {
		name = EVTOPTAasrai16
		prestige = -100
		add_trait = disfigured
	}
}

# spirits maim you
character_event = {
	id = asrai.17
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai17
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.17"
	}

	option = {
		name = EVTOPTAasrai17
		prestige = -100
		if = {
			limit = {
				NOT = {
					trait = maimed
				}
			}
			add_trait = maimed
		}
		if = {
			limit = {
				trait = maimed
			}
			add_trait = incapable
		}
	}
}

# spirits kill you
character_event = {
	id = asrai.18
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai18
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.18"
	}

	option = {
		name = EVTOPTAasrai18
		prestige = -100
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
	}
}

# spirits kill lover
character_event = {
	id = asrai.19
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai19
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.19"
	}

	option = {
		name = EVTOPTAasrai19
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
		FROM = {
			character_event = {
				id = asrai.20
			}
		}
	}
}

# spirits kill lover - notify
character_event = {
	id = asrai.20
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai20
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.20"
	}

	option = {
		name = EVTOPTAasrai20
		prestige = -100
		random = {
			chance = 35
			add_trait = depressed
		}
	}
}

# spirits kill courtier
character_event = {
	id = asrai.21
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai21
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.21"
	}

	option = {
		name = EVTOPTAasrai21
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_murder_unknown
		}
		FROM = {
			character_event = {
				id = asrai.22
			}
		}
	}
}

# spirits kill courtier - notify
character_event = {
	id = asrai.22
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai22
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.22"
	}

	option = {
		name = EVTOPTAasrai22
		prestige = -100
	}
}

# spirits drive ruler insane
character_event = {
	id = asrai.23
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai23
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.23"
	}

	option = {
		name = EVTOPTAasrai23
		prestige = -100
		hidden_tooltip = {
			change_variable = {
				which = "lunatic_counter"
				value = 5
			}
			character_event = {
				id = mutation.1005
			}
		} # lunacy
	}
}

# appease spirits, decision
character_event = {
	id = asrai.24
	picture = GFX_evt_asrai_tree
	desc = EVTDESCAasrai24
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.24"
	}

	option = {
		name = EVTOPTAasrai24
		trigger = {
			wealth = 100
		}
		wealth = -100
		piety = 25
		hidden_tooltip = {
			random_list = {
				30 = {
					character_event = {
						id = asrai.25
					}
				}
				70 = {
					character_event = {
						id = asrai.26
					}
				}
			}
		}
		ai_chance = {
			factor = 70
		}
	}

	option = {
		name = EVTOPTBasrai24
		piety = 50
		trigger = {
			any_child = {
				NOT = {
					age = 20
				}
				NOT = {
					trait = avatar_isha
				}
				NOT = {
					trait = avatar_kurnous
				}
				NOT = {
					trait = creature_forestspirit
				}
				NOT = {
					trait = creature_treekin
				}
				NOT = {
					is_ruler = yes
				}
				host = {
					character = FROM
				}
			}
		}
		random_child = {
			limit = {
				NOT = {
					age = 20
				}
				NOT = {
					trait = avatar_isha
				}
				NOT = {
					trait = avatar_kurnous
				}
				NOT = {
					trait = creature_forestspirit
				}
				NOT = {
					trait = creature_treekin
				}
				NOT = {
					is_ruler = yes
				}
				host = {
					character = FROM
				}
			}
			if = {
				limit = {
					is_invincible_trigger = yes
				}
				antideath_effect = yes
				break = yes
			}
			death = {
				death_reason = death_sacrificed
				killer = ROOT
			}
		}
		hidden_tooltip = {
			set_character_flag = sacrificing_asraibaby
			random_list = {
				70 = {
					character_event = {
						id = asrai.25
					}
				}
				30 = {
					character_event = {
						id = asrai.26
					}
				}
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 2
				trait = cruel
			}
		}
	}

	option = {
		name = EVTOPTCasrai24
		ai_chance = {
			factor = 0
		}
	}
}

# spirits are pleased
character_event = {
	id = asrai.25
	picture = GFX_evt_asrai_tree
	desc = EVTDESCAasrai25
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.25"
	}

	option = {
		name = EVTOPTAasrai25
		if = {
			limit = {
				NOT = {
					has_character_flag = sacrificing_asraibaby
				}
			}
			piety = 100
		}
		if = {
			limit = {
				has_character_flag = sacrificing_asraibaby
			}
			piety = 500
			clr_character_flag = sacrificing_asraibaby
		}
	}
}

# spirits are pleased
character_event = {
	id = asrai.26
	picture = GFX_evt_asrai_tree
	desc = EVTDESCAasrai26
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.26"
	}

	option = {
		name = EVTOPTAasrai26
		piety = 10
	}
}

# elf turns treekin
character_event = {
	id = asrai.27
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai27
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.27"
	}

	option = {
		name = EVTOPTAasrai27
		remove_trait = creature_elf
		add_trait = creature_treekin
		hidden_tooltip = {
			remove_trait = asrai_spellsinger
			remove_trait = lore_high_magic
			remove_trait = lore_dark_magic
			remove_character_modifier = magic_power_1
			remove_character_modifier = magic_power_2
			remove_character_modifier = magic_power_3
			remove_character_modifier = magic_power_4
			set_graphical_culture = forest_main
			random_list = {
				50 = {
					modifier = {
						factor = 0.75
						trait = zealous
					}
					modifier = {
						factor = 0.75
						trait = bright
					}
					modifier = {
						factor = 0.75
						trait = brilliant
					}
					modifier = {
						factor = 0.75
						trait = genius
					}
					modifier = {
						factor = 0.75
						trait = smart
					}
					modifier = {
						factor = 0.75
						trait = brave
					}
					modifier = {
						factor = 0.75
						trait = asrai_spellsinger
					}
					modifier = {
						factor = 1.75
						trait = craven
					}
					modifier = {
						factor = 1.25
						trait = dim
					}
					modifier = {
						factor = 1.25
						trait = dumb
					}
					modifier = {
						factor = 1.25
						trait = slow
					}
					modifier = {
						factor = 1.25
						trait = idiot
					}
					modifier = {
						factor = 0.95
						trait = magic_potential_1
					}
					modifier = {
						factor = 0.85
						trait = magic_potential_2
					}
					modifier = {
						factor = 0.75
						trait = magic_potential_3
					}
					modifier = {
						factor = 0.65
						trait = magic_potential_4
					}
					character_event = {
						id = asrai.28 days = 150 random = 100
					}
				} # abdicate
				50 = {
					modifier = {
						factor = 0.1
						ai = yes
					}
					character_event = {
						id = asrai.29 days = 250 random = 100
					}
				} # choose
			}
		}
	}
}

# the treekin goes wild
character_event = {
	id = asrai.28
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai28
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.28"
	}

	option = {
		name = EVTOPTAasrai28
		piety = 50
		abdicate = yes
	}
}

# the treekin can keep the position
character_event = {
	id = asrai.29
	picture = GFX_evt_mad_spirit
	desc = EVTDESCAasrai29
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.29"
	}

	option = {
		name = EVTOPTAasrai29
		piety = 50
		abdicate = yes
	}

	option = {
		name = EVTOPTBasrai29
		piety = -150
	}
}

# Spirit/Avatar dies (ping)
character_event = {
	id = asrai.30
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			trait = avatar_isha
			trait = avatar_kurnous
			trait = creature_forestspirit
		}
	}

	immediate = {
		log = "work event asrai.30"
		killer = {
			character_event = {
				id = asrai.31
			}
		}
	}
}

# the killer is devastated
character_event = {
	id = asrai.31
	picture = GFX_evt_mad_spirit
	desc = {
		text = EVTDESCAasrai31
		trigger = {
			FROM = {
				trait = avatar_isha
			}
		}
	}
	desc = {
		text = EVTDESCBasrai31
		trigger = {
			FROM = {
				trait = avatar_kurnous
			}
		}
	}
	desc = {
		text = EVTDESCCasrai31
		trigger = {
			FROM = {
				trait = creature_forestspirit
			}
		}
	}
	is_triggered_only = yes

	trigger = {
		OR = {
			trait = creature_treekin
			trait = creature_elf
		}
		religion = asrai_cadai
	}

	immediate = {
		log = "work event asrai.31"
	}

	option = {
		name = EVTOPTAasrai31
		trigger = {
			NOT = {
				trait = creature_treekin
			}
		}
		piety = -500
		abdicate = yes
	}

	option = {
		name = EVTOPTBasrai31
		trigger = {
			trait = creature_treekin
		}
		random = {
			chance = 75
			hidden_tooltip = {
				change_variable = {
					which = "lunatic_counter"
					value = 8
				}
				character_event = {
					id = mutation.1005
				}
			}
		}
		piety = -750
	}
}

# kidnapped child - notification
character_event = {
	id = asrai.32
	desc = EVTDESCasrai32
	picture = GFX_evt_scandal
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.32"
	}

	option = {
		name = "EVTOPTArape0005" # [FromFrom.GetSheHeCap] will pay for this!"
		if = {
			limit = {
				FROM = {
					is_child_of = ROOT
				}
			}
			opinion = {
				who = FROMFROM
				modifier = opinion_kidnapped_child
				months = 1200
			}
		}
		if = {
			limit = {
				NOT = {
					FROM = {
						is_child_of = ROOT
					}
				}
			}
			opinion = {
				who = FROMFROM
				modifier = opinion_kidnapped_relative
				months = 1200
			}
		}
	}
}

# Fairy Bred child reaches adulthood and gains trait (fired on_adulthood)
character_event = {
	id = asrai.33
	desc = EVTDESCasrai33
	picture = GFX_evt_asrai_elves

	trigger = {
		liege = {
			OR = {
				trait = creature_elf
				trait = creature_treekin
				trait = creature_forestspirit
			}
		}
		trait = disinherited
		OR = {
			trait = creature_human
			trait = creature_amazon
			trait = creature_dwarf
			trait = creature_chaos_dwarf
		}
	}
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.33"
	}

	option = {
		name = EVTOPTAasrai33
		add_trait = fairy_bred
		if = {
			limit = {
				liege = {
					OR = {
						trait = creature_elf
						trait = creature_treekin
					}
				}
			}
		}
		liege = {
			character_event = {
				id = asrai.34 days = 1
			}
		} # notify
	}
}

# Guardian decides what to do
character_event = {
	id = asrai.34
	desc = EVTDESCasrai34
	picture = GFX_evt_asrai_elves
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.34"
	}

	option = {
		name = EVTOPTAasrai34 # I've grown tired of it.
		trigger = {
			FROM = {
				NOT = {
					is_ruler = yes
				}
				NOT = {
					religion = asrai_cadai
				}
			}
		}
		FROM = {
			character_event = {
				id = asrai.35 days = 1
			}
		}
	}

	option = {
		name = EVTOPTBasrai34 # I like it here
		piety = -50
	}
}

# Fairy Bred sent back home
character_event = {
	id = asrai.35
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.35"
		prisoner = no
		remove_trait = disinherited
		recalc_succession = yes
		random_playable_ruler = {
			limit = {
				religion = ROOT
			}
			ROOT = {
				move_character = PREV
			}
		}
	}
}

# The Asrai scourge enemy province during a Wild Hunt
# ROOT is attacker, FROM is province sieged
character_event = {
	id = asrai.36
	desc = EVTDESCasrai36
	picture = GFX_evt_wild_hunt
	is_triggered_only = yes
	# only_playable = yes

	trigger = {
		higher_tier_than = COUNT
		is_tribal = yes
		religion = asrai_cadai
		FROM = {
			NOT = {
				location = {
					has_province_modifier = province_slave_raid
				}
			}
		}
		FROM = {
			NOT = {
				location = {
					has_province_modifier = province_scourged
				}
			}
		}
		FROM = {
			NOT = {
				location = {
					has_province_modifier = province_slave_raid_chaos_dwarf
				}
			}
		}
		any_war = {
			attacker = {
				character = ROOT
			}
			using_cb = great_wild_hunt
		}
		FROM = {
			is_tribal = no
			is_capital = yes
			owner = {
				NOT = {
					religion = asrai_cadai
				}
			}
		} # only against civilized places
	}

	immediate = {
		log = "work event asrai.36"
	}

	option = {
		name = EVTOPTAasrai36
		if = {
			limit = {
				FROM = {
					owner = {
						top_liege = {
							NOT = {
								character = PREV
							}
						}
					}
				}
			}
			FROM = {
				owner = {
					top_liege = {
						character_event = {
							id = asrai.38
						}
					}
				}
			}
		}
		FROM = {
			owner = {
				character_event = {
					id = asrai.37
				}
			}
		}
		FROM = {
			set_province_flag = flag_province_scourged
		}
		if = {
			limit = {
				FROM = {
					OR = {
						any_neighbor_province = {
							is_tribal = yes
						}
						has_province_flag = flag_province_scourged
						NOT = {
							num_of_settlements = 2
						}
					}
					NOT = {
						is_nomadic = yes
					}
				}
			}
			random = {
				chance = 1
				FROM = {
					convert_to = TRIBAL
				}
			}
		}
		if = {
			limit = {
				FROM = {
					location = {
						NOT = {
							has_province_modifier = province_scourged
						}
					}
				}
			}
			FROM = {
				location = {
					add_province_modifier = {
						name = province_scourged
						duration = 2400
					}
				}
			}
		}
		wealth = 125
		prestige = 50
		piety = 50
		hidden_tooltip = {
			FROM = {
				destroy_random_building = yes
				holder_scope = {
					random_courtier = {
						limit = {
							is_abroad = no
							NOT = {
								trait = creature_elf
							}
						}
						random = {
							chance = 75
							if = {
								limit = {
									is_invincible_trigger = yes
								}
								antideath_effect = yes
								break = yes
							}
							death = {
								death_reason = death_murder
								killer = ROOT
							}
						}
						random_courtier = {
							limit = {
								is_abroad = no
								NOT = {
									trait = creature_elf
								}
								NOT = {
									character = PREV
								}
							}
							random = {
								chance = 75
								if = {
									limit = {
										is_invincible_trigger = yes
									}
									antideath_effect = yes
									break = yes
								}
								death = {
									death_reason = death_murder
									killer = ROOT
								}
							}
							random_courtier = {
								limit = {
									is_abroad = no
									NOT = {
										trait = creature_elf
									}
									NOT = {
										character = PREVPREV
									}
									NOT = {
										character = PREV
									}
								}
								random = {
									chance = 75
									if = {
										limit = {
											is_invincible_trigger = yes
										}
										antideath_effect = yes
										break = yes
									}
									death = {
										death_reason = death_murder
										killer = ROOT
									}
								}
								random_courtier = {
									limit = {
										is_abroad = no
										NOT = {
											trait = creature_elf
										}
										NOT = {
											character = PREVPREVPREV
										}
										NOT = {
											character = PREVPREV
										}
										NOT = {
											character = PREV
										}
									}
									random = {
										chance = 75
										if = {
											limit = {
												is_invincible_trigger = yes
											}
											antideath_effect = yes
											break = yes
										}
										death = {
											death_reason = death_murder
											killer = ROOT
										}
									}
									random_courtier = {
										limit = {
											is_abroad = no
											NOT = {
												trait = creature_elf
											}
											NOT = {
												character = PREVPREVPREVPREV
											}
											NOT = {
												character = PREVPREVPREV
											}
											NOT = {
												character = PREVPREV
											}
											NOT = {
												character = PREV
											}
										}
										random = {
											chance = 75
											if = {
												limit = {
													is_invincible_trigger = yes
												}
												antideath_effect = yes
												break = yes
											}
											death = {
												death_reason = death_murder
												killer = ROOT
											}
										}
									} # closingcourtier
								} # closingcourtier
							} # closingcourtier
						} # closingcourtier
					} # closingcourtier
				}
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.75
				ROOT = {
					OR = {
						trait = possessed
						trait = lunatic_3
						trait = lunatic_2
					}
				}
			}
			modifier = {
				factor = 2
				avatar_kurnous = {
					trait = lunatic_3
				}
			}
		}
	}

	option = {
		name = EVTOPTCasrai36
		if = {
			limit = {
				FROM = {
					owner = {
						top_liege = {
							NOT = {
								character = PREV
							}
						}
					}
				}
			}
			FROM = {
				owner = {
					top_liege = {
						character_event = {
							id = asrai.39
						}
					}
				}
			}
		}
		FROM = {
			owner = {
				character_event = {
					id = asrai.39
				}
			}
		}
		wealth = 25
		prestige = 10
		piety = 10
		hidden_tooltip = {
			FROM = {
				holder_scope = {
					random_courtier = {
						limit = {
							is_abroad = no
							NOT = {
								is_ruler = yes
							}
							NOT = {
								trait = creature_forestspirit
							}
							NOT = {
								trait = creature_treekin
							}
							NOT = {
								trait = creature_elf
							}
						}
						random = {
							chance = 100
							imprison = ROOT
							move_character = ROOT
						}
						random_courtier = {
							limit = {
								is_abroad = no
								NOT = {
									is_ruler = yes
								}
								NOT = {
									trait = creature_forestspirit
								}
								NOT = {
									trait = creature_treekin
								}
								NOT = {
									trait = creature_elf
								}
								NOT = {
									character = PREV
								}
							}
							random = {
								chance = 100
								imprison = ROOT
								move_character = ROOT
							}
							random_courtier = {
								limit = {
									is_abroad = no
									NOT = {
										is_ruler = yes
									}
									NOT = {
										trait = creature_forestspirit
									}
									NOT = {
										trait = creature_treekin
									}
									NOT = {
										trait = creature_elf
									}
									NOT = {
										character = PREVPREV
									}
									NOT = {
										character = PREV
									}
								}
								random = {
									chance = 90
									imprison = ROOT
									move_character = ROOT
								}
								random_courtier = {
									limit = {
										is_abroad = no
										NOT = {
											is_ruler = yes
										}
										NOT = {
											trait = creature_forestspirit
										}
										NOT = {
											trait = creature_treekin
										}
										NOT = {
											trait = creature_elf
										}
										NOT = {
											character = PREVPREVPREV
										}
										NOT = {
											character = PREVPREV
										}
										NOT = {
											character = PREV
										}
									}
									random = {
										chance = 75
										imprison = ROOT
										move_character = ROOT
									}
									random_courtier = {
										limit = {
											is_abroad = no
											NOT = {
												is_ruler = yes
											}
											NOT = {
												trait = creature_forestspirit
											}
											NOT = {
												trait = creature_treekin
											}
											NOT = {
												trait = creature_elf
											}
											NOT = {
												character = PREVPREVPREVPREV
											}
											NOT = {
												character = PREVPREVPREV
											}
											NOT = {
												character = PREVPREV
											}
											NOT = {
												character = PREV
											}
										}
										random = {
											chance = 50
											imprison = ROOT
											move_character = ROOT
										}
									} # closingcourtier
								} # closingcourtier
							} # closingcourtier
						} # closingcourtier
					} # closingcourtier
				}
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				ROOT = {
					NOT = {
						trait = possessed
						trait = lunatic_3
						trait = lunatic_2
					}
				}
			}
			modifier = {
				factor = 1.2
				trait = kind
			}
			modifier = {
				factor = 1.5
				avatar_kurnous = {
					is_alive = yes
				}
			}
		}
	}

	option = {
		name = EVTOPTBasrai36
		piety = -25
		prestige = -25
		if = {
			limit = {
				trait = cruel
			}
			random = {
				chance = 1
				remove_trait = cruel
			}
		}
		ai_chance = {
			factor = 75
			modifier = {
				factor = 1.2
				ROOT = {
					NOT = {
						trait = possessed
						trait = lunatic_3
						trait = lunatic_2
					}
				}
			}
			modifier = {
				factor = 1.2
				trait = kind
			}
			modifier = {
				factor = 2
				NOT = {
					avatar_kurnous = {
						is_alive = yes
					}
				}
			}
		}
	}
}

character_event = {
	id = asrai.37
	desc = EVTDESCasrai37
	picture = GFX_evt_wild_hunt
	is_triggered_only = yes
	only_playable = yes

	immediate = {
		log = "work event asrai.37"
	}

	option = {
		name = EVTOPTAasrai37
		opinion = {
			modifier = opinion_scourged_lands
			who = FROM
		}
		ai_chance = {
			factor = 1
		}
	}
}

character_event = {
	id = asrai.38
	desc = EVTDESCasrai38
	picture = GFX_evt_wild_hunt
	is_triggered_only = yes
	only_playable = yes

	immediate = {
		log = "work event asrai.38"
	}

	option = {
		name = EVTOPTAasrai38
		opinion = {
			modifier = opinion_scourged_lands
			who = FROM
		}
		ai_chance = {
			factor = 1
		}
	}
}

character_event = {
	id = asrai.39
	desc = EVTDESCasrai39
	picture = GFX_evt_wild_hunt
	is_triggered_only = yes
	only_playable = yes

	immediate = {
		log = "work event asrai.39"
	}

	option = {
		name = EVTOPTAasrai39
		opinion = {
			modifier = opinion_scourged_lands
			who = FROM
		}
		ai_chance = {
			factor = 1
		}
	}
}

# Disband summoned spirits (Treeman spell)
character_event = {
	id = asrai.40
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.40"
		disband_event_forces = spirit_troops
	}
}

# An old spirit wanders to court (five yearly event)
character_event = {
	id = asrai.41
	picture = GFX_evt_asrai_elves
	desc = EVTDESCasrai41
	is_triggered_only = yes

	trigger = {
		prisoner = no
		OR = {
			trait = creature_elf
			trait = creature_treekin
		}
		NOT = {
			any_courtier = {
				trait = creature_forestspirit
				count = 2
			}
		}
		religion = asrai_cadai
		capital_scope = {
			empire = {
				title = e_athel_loren
			}
		}
	}

	immediate = {
		log = "work event asrai.41"
	}

	option = {
		name = EVTOPTAasrai41
		hidden_tooltip = {
			random_list = {
				25 = {
					create_character = {
						random_traits = yes
						dynasty = NONE
						religion = ROOT
						culture = forest_main
						female = yes
						age = 1712
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						dynasty = RANDOM
						religion = ROOT
						culture = forest_main
						female = yes
						age = 2001
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						dynasty = RANDOM
						religion = ROOT
						culture = forest_main
						female = no
						age = 1746
					}
				}
				25 = {
					create_character = {
						random_traits = yes
						dynasty = NONE
						religion = ROOT
						culture = forest_main
						female = no
						age = 1125
					}
				}
			}
			new_character = {
				piety = 500
				prestige = 150
				add_trait = creature_forestspirit
				random_list = {
					40 = {
					}
					30 = {
						add_trait = hardy
					}
					20 = {
						add_trait = tough
					}
					10 = {
						add_trait = strong
					}
				}
				random_list = {
					2 = {
						add_trait = cruel
					}
					1 = {
						add_trait = lunatic_3
					}
					1 = {
						add_trait = kind
					}
					1 = {
						add_trait = greedy
					}
					1 = {
						add_trait = just
					}
					1 = {
						add_trait = zealous
					}
					2 = {
						add_trait = cynical
					}
					5 = {
						add_trait = arbitrary
					}
					50 = {
					}
				}
			}
		}
	}
}

# The spirit wants someone (by-yearly event)
character_event = {
	id = asrai.42
	hide_window = yes

	trigger = {
		prisoner = no
		is_ruler = no
		trait = creature_forestspirit
		NOT = {
			trait = resting
		}
		liege = {
			any_courtier = {
				NOT = {
					trait = creature_forestspirit
				}
				NOT = {
					is_ruler = yes
				}
				NOT = {
					trait = avatar_isha
				}
				NOT = {
					trait = avatar_kurnous
				}
				NOT = {
					trait = creature_treekin
				}
				count = 5
			}
		}
		religion = asrai_cadai
		capital_scope = {
			empire = {
				title = e_athel_loren
			}
		}
	}

	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 1.25
			trait = greedy
		}
		modifier = {
			factor = 1.5
			trait = cruel
		}
		modifier = {
			factor = 0.75
			trait = kind
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.25
			trait = arbitrary
		}
		modifier = {
			factor = 0.75
			trait = charitable
		}
		modifier = {
			factor = 0.75
			trait = shy
		}
		modifier = {
			factor = 1.25
			trait = lustful
		}
		modifier = {
			factor = 1.25
			trait = wroth
		}
		modifier = {
			factor = 3
			trait = lunatic_3
		}
		modifier = {
			factor = 2
			trait = lunatic_2
		}
		modifier = {
			factor = 1.5
			trait = lunatic_1
		}
	}
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.42"
		liege = {
			random_courtier = {
				limit = {
					NOT = {
						trait = creature_forestspirit
					}
					NOT = {
						is_ruler = yes
					}
					NOT = {
						trait = avatar_isha
					}
					NOT = {
						trait = avatar_kurnous
					}
					NOT = {
						trait = creature_treekin
					}
				}
				character_event = {
					id = asrai.43
				}
			}
		}
	}
}

# Ping victim
character_event = {
	id = asrai.43
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.43"
		liege = {
			character_event = {
				id = asrai.44
			}
		}
	}
}

character_event = {
	id = asrai.44
	desc = EVTDESCasrai44
	picture = GFX_evt_asrai_elves
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.44"
	}

	option = {
		name = EVTOPTAasrai44
		FROM = {
			if = {
				limit = {
					is_invincible_trigger = yes
				}
				antideath_effect = yes
				break = yes
			}
			death = {
				death_reason = death_sacrificed
				killer = ROOT
			}
		}
		ai_chance = {
			factor = 90
		}
	}

	option = {
		name = EVTOPTBasrai44
		piety = -75
		FROMFROM = {
			opinion = {
				who = ROOT
				modifier = opinion_spirit_angered
				months = 24000
			}
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				FROM = {
					dynasty = ROOT
				}
			}
		}
	}
}

# Angry spirit leaves
character_event = {
	id = asrai.45
	hide_window = yes

	trigger = {
		trait = creature_forestspirit
		NOT = {
			liege = {
				ROOT = {
					opinion = {
						who = PREV
						value = 80
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		years = 120
		modifier = {
			factor = 1.2
			liege = {
				ROOT = {
					opinion = {
						who = PREV
						value = 20
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				ROOT = {
					opinion = {
						who = PREV
						value = 40
					}
				}
			}
		}
		modifier = {
			factor = 2
			liege = {
				ROOT = {
					opinion = {
						who = PREV
						value = 60
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 0
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -10
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -20
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -30
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -40
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -50
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -60
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -70
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -80
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.7
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -90
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.6
			NOT = {
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = -100
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.75
			liege = {
				trait = creature_treekin
			}
		}
		modifier = {
			factor = 1.75
			liege = {
				trait = avatar_isha
			}
		}
		modifier = {
			factor = 1.75
			liege = {
				trait = avatar_kurnous
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 100
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 200
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 300
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 400
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 500
			}
		}
		modifier = {
			factor = 1.25
			liege = {
				piety = 600
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				piety = 700
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				piety = 800
			}
		}
		modifier = {
			factor = 1.75
			liege = {
				piety = 900
			}
		}
		modifier = {
			factor = 2
			liege = {
				piety = 1000
			}
		}
		modifier = {
			factor = 0.75
			trait = greedy
		}
		modifier = {
			factor = 0.75
			trait = cruel
		}
		modifier = {
			factor = 1.25
			trait = kind
		}
		modifier = {
			factor = 1.25
			trait = charitable
		}
		modifier = {
			factor = 1.25
			trait = shy
		}
		modifier = {
			factor = 0.75
			trait = lustful
		}
		modifier = {
			factor = 0.75
			trait = wroth
		}
		modifier = {
			factor = 0.25
			trait = lunatic_3
		}
		modifier = {
			factor = 0.5
			trait = lunatic_2
		}
		modifier = {
			factor = 0.75
			trait = lunatic_1
		}
	}

	immediate = {
		log = "work event asrai.45"
		liege = {
			character_event = {
				id = asrai.46
			}
		}
	}
}

# Ruler notified
character_event = {
	id = asrai.46
	desc = EVTDESCasrai46
	picture = GFX_evt_mad_spirit
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.46"
	}

	option = {
		name = EVTOPTBasrai46
		piety = -350
		random_playable_ruler = {
			limit = {
				religion = FROM
			}
			FROM = {
				move_character = PREV
			}
		}
	}
}

# Asrai meddle - Ruler notified
character_event = {
	id = asrai.47
	desc = EVTDESCasrai47
	picture = GFX_evt_asrai_elves
	notification = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.47"
	}

	option = {
		name = EVTOPTAasrai47
		trigger = {
			trait = creature_elf
			NOT = {
				religion = asrai_cadai
			}
		}
	}

	option = {
		name = EVTOPTDasrai47
		trigger = {
			trait = creature_elf
			religion = asrai_cadai
		}
	}

	option = {
		name = EVTOPTBasrai47
		trigger = {
			trait = creature_dwarf
		}
	}

	option = {
		name = EVTOPTCasrai47
		trigger = {
			NOT = {
				trait = creature_elf
				trait = creature_dwarf
			}
		}
	}
}

# Calling a spirit army
character_event = {
	id = asrai.48
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.48"
		random_list = {
			10 = {
				modifier = {
					factor = 1.25
					trait = cynical
				}
				modifier = {
					factor = 0.5
					trait = avatar_kurnous
				}
				modifier = {
					factor = 0.5
					trait = avatar_isha
				}
				modifier = {
					factor = 0.75
					trait = creature_treekin
				}
				modifier = {
					factor = 3
					NOT = {
						avatar_kurnous = {
							is_alive = yes
						}
					}
				}
				modifier = {
					factor = 2
					NOT = {
						avatar_isha = {
							is_alive = yes
						}
					}
				}
				modifier = {
					factor = 0
					any_war = {
						attacker = {
							religion_group = chaos_gods_group
						}
					}
				}
				modifier = {
					factor = 0
					any_war = {
						defender = {
							religion_group = chaos_gods_group
						}
					}
				}
				modifier = {
					factor = 0.75
					any_war = {
						defender = {
							character = ROOT
						}
					}
				}
				character_event = {
					id = asrai.49
				} # No horde
			}
			85 = {
				character_event = {
					id = asrai.50
				} # Average horde
			}
			5 = {
				modifier = {
					factor = 1.25
					trait = zealous
				}
				modifier = {
					factor = 1.25
					piety = 250
				}
				modifier = {
					factor = 1.25
					piety = 500
				}
				modifier = {
					factor = 1.25
					trait = asrai_spellsinger
				}
				modifier = {
					factor = 1.25
					trait = magic_potential_3
				}
				modifier = {
					factor = 1.5
					trait = magic_potential_4
				}
				modifier = {
					factor = 1.25
					has_character_modifier = magic_power_2
				}
				modifier = {
					factor = 1.5
					has_character_modifier = magic_power_3
				}
				modifier = {
					factor = 1.75
					has_character_modifier = magic_power_4
				}
				modifier = {
					factor = 1.5
					trait = avatar_kurnous
				}
				modifier = {
					factor = 1.25
					trait = avatar_isha
				}
				modifier = {
					factor = 1.1
					trait = creature_treekin
				}
				modifier = {
					factor = 0
					NOT = {
						avatar_kurnous = {
							is_alive = yes
						}
					}
				}
				modifier = {
					factor = 0.1
					NOT = {
						avatar_isha = {
							is_alive = yes
						}
					}
				}
				modifier = {
					factor = 2
					any_war = {
						attacker = {
							religion_group = chaos_gods_group
						}
					}
				}
				modifier = {
					factor = 2
					any_war = {
						defender = {
							religion_group = chaos_gods_group
						}
					}
				}
				modifier = {
					factor = 1.25
					any_war = {
						defender = {
							character = ROOT
						}
					}
				}
				character_event = {
					id = asrai.51
				} # Large horde
			}
		}
	}
}

# No one came
character_event = {
	id = asrai.49
	desc = EVTDESCasrai49
	picture = GFX_evt_elf_winter
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.49"
	}

	option = {
		name = EVTOPTAasrai49
		ai_chance = {
			factor = 1
		}
		prestige = -50
	}
}

# Small host appears
character_event = {
	id = asrai.50
	desc = EVTDESCasrai50
	picture = GFX_evt_mad_spirit
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.50"
	}

	option = {
		name = EVTOPTAasrai50
		prestige = 20
		hidden_tooltip = {
			ROOT = {
				character_event = {
					id = asrai.52 days = 170 random = 30
				}
			}
		}
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = forest_spirits
					troops = {
						magical_spells = {
							1000 1000
						}
					}
					disband_on_peace = yes
					attrition = 0.75
				}
			}
		}
	}
}

# Great host appears
character_event = {
	id = asrai.51
	desc = EVTDESCasrai51
	picture = GFX_evt_mad_spirit
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.51"
	}

	option = {
		name = EVTOPTAasrai51
		prestige = 100
		hidden_tooltip = {
			ROOT = {
				character_event = {
					id = asrai.52 days = 170 random = 30
				}
			}
		}
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					earmark = forest_spirits
					troops = {
						magical_spells = {
							5000 5000
						}
					}
					disband_on_peace = yes
					attrition = 0.75
				}
			}
		}
	}
}

# The spirits go to rest
character_event = {
	id = asrai.52
	desc = EVTDESCasrai52
	picture = GFX_evt_elf_winter
	notification = yes
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.52"
		disband_event_forces = forest_spirits
	}

	option = {
	}
}

# On_action. You imprisoned an Avatar/Spirit while in Athel Loren.
character_event = {
	id = asrai.53
	desc = EVTDESCasrai53
	picture = GFX_evt_mad_spirit

	trigger = {
		OR = {
			trait = avatar_isha
			trait = avatar_kurnous
			trait = creature_forestspirit
		}
		FROM = {
			location = {
				region = world_athel_loren
			}
		}
	}
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.53"
	}

	option = {
		name = EVTOPTAasrai53
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = asrai.53005
				}
			}
		}
		prisoner = no
	}
}

# Notify jailer.
character_event = {
	id = asrai.53005
	desc = {
		text = EVTDESCAasrai53005
		trigger = {
			FROM = {
				trait = avatar_isha
			}
		}
	}
	desc = {
		text = EVTDESCBasrai53005
		trigger = {
			FROM = {
				trait = avatar_kurnous
			}
		}
	}
	desc = {
		text = EVTDESCCasrai53005
		trigger = {
			FROM = {
				trait = creature_forestspirit
			}
		}
	}
	picture = GFX_evt_mad_spirit
	is_triggered_only = yes

	immediate = {
		log = "work event asrai.53005"
	}

	option = {
		name = EVTOPTAasrai53005
		if = {
			limit = {
				religion = asrai_cadai
			}
			piety = -300
		}
	}
}

# The Forest eats away the enemy
character_event = {
	id = asrai.54
	desc = EVTDESCasrai54
	title = EVTNAMEasrai54
	picture = GFX_evt_bandit
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	notification = yes

	trigger = {
		NOT = {
			religion = asrai_cadai
		}
		FROM = {
			location = {
				region = world_athel_loren
			}
		}
		siege = {
			is_attacker = yes
		}
	}

	immediate = {
		log = "work event asrai.54"
		siege = {
			morale = -0.1
			troops = -0.25
		}
	}

	option = {
		name = EVTOPTAasrai54
		tooltip = {
 			siege = {
				morale = -0.1
				troops = -0.25
			}
		}
	}
}
