targetted_decisions = {

	create_blooddragon_company = {
		filter = home_court
		ai_target_filter = home_court
		only_rulers = yes
		from_potential = {
			has_dlc = "Horse Lords"
			is_ruler = yes
			trait = vampire_blood_visible
			NOT = {
				trait = incapable
			}
			higher_tier_than = BARON
		}
		potential = {
			is_ruler = no
			mercenary = no
			age = 16
			trait = vampire_blood_visible
			culture = blooddragons_culture
			NOT = {
				character = FROM
			}
		}
		allow = {
			is_adult = yes
			is_ruler = no
			martial = 10
			is_incapacitated_trigger = no
			NOT = {
				trait = infirm
			}
			NOT = {
				trait = maimed
			}
			NOT = {
				trait = blinded
			}
			NOT = {
				trait = eunuch
			}
			NOT = {
				trait = weak
			}
			NOT = {
				trait = fragile
			}
			liege = {
				character = FROM
			}
			FROM = {
				piety = 150
				wealth = 450
			}
		}
		effect = {
			# set_character_flag = is_mercenary_leader
			add_character_modifier = {
				modifier = started_mercenary_company months = 20
				hidden = yes
			}
 			hidden_tooltip = {
				FROM = {
					wealth = -450
					primary_title = {
						ROOT = {
							remove_trait = vampire_blood_visible
							set_government_type = nomadic_government
							manpower = 1000
							create_title = {
								tier = DUKE
								name = DYNAMIC_BLOODDRAGON_COMPANY
								landless = yes
								custom_created = yes
								culture = ROOT
								holder = ROOT
								base_title = THIS
								adventurer = yes
								mercenary = yes
								ruler = "BLOOD_CAPTAIN"
								ruler_female = "BLOOD_CAPTAIN"
								foa = "CAPTAIN_FOA"
							}
							new_title = {
								set_coa = FROM
							}
						}
						ROOT = {
							add_trait = vampire_blood_visible
							set_government_type = vampiric_government
						}
					}
				}
			}
			FROM = {
				make_tributary = {
					who = ROOT percentage = 0.6
				}
			}
			ROOT = {
				piety = 75
				wealth = 50
				prestige = 50
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				OR = {
					any_mercenary_band = {
						count = 3
						band_creator = {
							character = FROM
						}
					}
					FROM = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
					}
				}
			}
			modifier = {
				factor = 0.5
				any_mercenary_band = {
					count = 1
					band_creator = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.5
				any_mercenary_band = {
					count = 2
					band_creator = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0
				NOT =	{
					age = 40
				}
			}
			modifier = {
				factor = 0.5
				is_female = yes
			}
			modifier = {
				factor = 0.25
				trait = kind
			}
			modifier = {
				factor = 2.5
				reverse_opinion = {
					who = FROM value = 75
				}
			}
			modifier = {
				factor = 2.25
				reverse_opinion = {
					who = FROM value = 60
				}
			}
			modifier = {
				factor = 2
				reverse_opinion = {
					who = FROM value = 50
				}
			}
			modifier = {
				factor = 1.95
				reverse_opinion = {
					who = FROM value = 40
				}
			}
			modifier = {
				factor = 1.75
				reverse_opinion = {
					who = FROM value = 30
				}
			}
			modifier = {
				factor = 1.5
				reverse_opinion = {
					who = FROM value = 20
				}
			}
			modifier = {
				factor = 1.25
				reverse_opinion = {
					who = FROM value = 10
				}
			}
			modifier = {
				factor = 0.99
				NOT = {
					reverse_opinion = {
						who = FROM value = -10
					}
				}
			}
			modifier = {
				factor = 0.98
				NOT = {
					reverse_opinion = {
						who = FROM value = -20
					}
				}
			}
			modifier = {
				factor = 0.95
				NOT = {
					reverse_opinion = {
						who = FROM value = -30
					}
				}
			}
			modifier = {
				factor = 0.85
				NOT = {
					reverse_opinion = {
						who = FROM value = -40
					}
				}
			}
			modifier = {
				factor = 0.75
				NOT = {
					reverse_opinion = {
						who = FROM value = -50
					}
				}
			}
			modifier = {
				factor = 0.65
				NOT = {
					reverse_opinion = {
						who = FROM value = -60
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					reverse_opinion = {
						who = FROM value = -75
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					trait = paranoid
				}
			}
			modifier = {
				factor = 1.25
				trait = lunatic_1
			}
			modifier = {
				factor = 1.5		#Vampires appreciate quirks
				trait = lunatic_2
			}
			modifier = {
				factor = 1.75		#Vampires appreciate quirks
				trait = lunatic_3
			}
			modifier = {
				factor = 0.75
				trait = shy
			}
			modifier = {
				factor = 0.8
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = mystic
			}
			modifier = {
				factor = 0.85
				trait = intricate_webweaver
			}
			modifier = {
				factor = 0.75
				trait = elusive_shadow
			}
			modifier = {
				factor = 0.65
				trait = charismatic_negotiator
			}
			modifier = {
				factor = 0.5
				trait = grey_eminence
			}
			modifier = {
				factor = 0.75
				trait = fortune_builder
			}
			modifier = {
				factor = 0.85
				trait = midas_touched
			}
			modifier = {
				factor = 1.25
				trait = misguided_warrior
			}
			modifier = {
				factor = 1.5
				trait = tough_soldier
			}
			modifier = {
				factor = 1.95
				trait = skilled_tactician
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.25
				trait = detached_priest
			}
			modifier = {
				factor = 0.85
				trait = martial_cleric
			}
			modifier = {
				factor = 0.75
				trait = scholarly_theologian
			}
			modifier = {
				factor = 0.65
				trait = mastermind_theologian
			}
			modifier = {
				factor = 0.75
				trait = stressed
			}
			modifier = {
				factor = 0.5
				trait = drunkard
			}
			modifier = {
				factor = 0.25
				trait = addict
			}
			modifier = {
				factor = 0.85
				trait = homosexual
			}
			modifier = {
				factor = 1.25
				trait = kinslayer
			}
			modifier = {
				factor = 0.75
				trait = clubfooted
			}
			modifier = {
				factor = 0.5
				trait = harelip
			}
			modifier = {
				factor = 0.5
				trait = hunchback
			}
			modifier = {
				factor = 0.85
				trait = lisp
			}
			modifier = {
				factor = 0.75
				trait = stutter
			}
			modifier = {
				factor = 0.5
				trait = dwarf
			}
			modifier = {
				factor = 0.5
				trait = inbred
			}
			modifier = {
				factor = 1.25
				trait = celibate
			}
			modifier = {
				factor = 0.5
				trait = hedonist
			}
			modifier = {
				factor = 0.75
				trait = scholar
			}
			modifier = {
				factor = 1.95
				trait = impaler
			}
			modifier = {
				factor = 0.85
				trait = poet
			}
			modifier = {
				factor = 0.85
				trait = lustful
			}
			modifier = {
				factor = 1.25
				trait = chaste
			}
			modifier = {
				factor = 0.85
				trait = gluttonous
			}
			modifier = {
				factor = 1.25
				trait = temperate
			}
			modifier = {
				factor = 0.85
				trait = greedy
			}
			modifier = {
				factor = 0.95
				trait = charitable
			}
			modifier = {
				factor = 0.85
				trait = slothful
			}
			modifier = {
				factor = 1.25
				trait = diligent
			}
			modifier = {
				factor = 0.85
				trait = envious
			}
			modifier = {
				factor = 0.85
				trait = kind
			}
			modifier = {
				factor = 0.95
				trait = wroth
			}
			modifier = {
				factor = 1.15
				trait = patient
			}
			modifier = {
				factor = 0.85
				trait = proud
			}
			modifier = {
				factor = 1.15
				trait = humble
			}
			modifier = {
				factor = 0.85
				trait = deceitful
			}
			modifier = {
				factor = 0.35
				trait = craven
			}
			modifier = {
				factor = 1.5
				trait = cruel
			}
		}
	} #closesdecision

	send_strigany_caravan = {
		filter = home_court
		ai_target_filter = home_court
		only_rulers = yes
		from_potential = {
			higher_tier_than = BARON
			is_ruler = yes
			is_incapacitated_trigger = no
			NOT = {
				has_any_opinion_modifier = opinion_strigany_caravan_beacon
			}
			OR = {
				trait = vampire_strigoi_visible
				AND = {
					culture_group = strigany_group
					is_living_human_trigger = yes
				}
			}
		}
		potential = {
			age = 16
			is_ruler = no
			host = {
				character = FROM
			}
			is_incapacitated_trigger = no
			OR = {
				is_married = no
				any_spouse = {
					is_ruler = no
				}
			}
			religion_group = necromantic_group
			culture_group = strigany_group
			NOT = {
				has_any_opinion_modifier = opinion_strigany_caravan_beacon
			}
			NOT = {
				has_any_opinion_modifier = opinion_strigany_caravan_beacon2
			}
			NOT = {
				character = FROM
			}
			is_living_human_trigger = yes
			any_playable_ruler = {
				higher_tier_than = BARON
				is_within_diplo_range = FROM
				NOT = {
					has_any_opinion_modifier = opinion_strigany_caravan_beacon2
				}
				NOT = {
					capital_scope = {
						has_province_modifier = strigany_caravan
					}
				}
				trait = creature_human
				is_landed = yes
				NOT = {
					trait = witch_hunter
				}
				NOT = {
					character = FROM
				}
				NOT = {
					culture_group = strigany_group
				}
				NOT = {
					has_character_modifier = expelled_strigany
				}
				NOT = {
					top_liege = {
						has_character_modifier = expelled_strigany
					}
				}
				OR = {
					religion_group = old_world_group
					religion_group = ormazd_gods_group
					religion_group = necromantic_group
				}
			}
		}
		allow = {
			FROM = {
				wealth = 25
				prestige = 50
			}
		}
		effect = {
			FROM = {
				wealth = -25
				prestige = -50
			}
			hidden_tooltip = {
				FROM = {
					opinion = {
						who = ROOT
						modifier = opinion_strigany_caravan_beacon
						months = 1
					}
				}
				random_playable_ruler = {
					limit = {
						higher_tier_than = BARON
						is_within_diplo_range = FROM
						NOT = {
							has_any_opinion_modifier = opinion_strigany_caravan_beacon2
						}
						NOT = {
							capital_scope = {
								has_province_modifier = strigany_caravan
							}
						}
						trait = creature_human
						NOT = {
							trait = witch_hunter
						}
						is_landed = yes
						NOT = {
							character = FROM
						}
						NOT = {
							culture_group = strigany_group
						}
						NOT = {
							has_character_modifier = expelled_strigany
						}
						NOT = {
							top_liege = {
								has_character_modifier = expelled_strigany
							}
						}
						OR = {
							religion_group = old_world_group
							religion_group = ormazd_gods_group
							religion_group = necromantic_group
						}
					}
					character_event = {
						id = svampires.32 days = 14 random = 15
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1.5
				FROM = {
					trait = greedy
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					dynasty = ROOT
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					current_heir = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					mother = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					father = {
						character = ROOT
					}
				}
			}
		}
	} #closedecision

	commission_necrarch_crafting = {
		filter = all
		ai_target_filter = all
      	from_potential = {
           	OR = {
                is_visible_vampire_trigger = yes
				AND = {
					religion = nagashi
					trait = creature_nehekharan
				}
			}
		}
      	potential = {
			trait = vampire_necrarch_visible
      	    NOR = {
				trait = resting
				trait = incapable
				trait = incapacitated
				trait = in_hiding
			}
           	OR = {
                has_character_modifier = magic_power_1
                has_character_modifier = magic_power_2
                has_character_modifier = magic_power_3
                has_character_modifier = magic_power_4
			}
			is_within_diplo_range = FROM
		}
        allow = {
      	    NOT = {
				character = FROM
			}
      	    NOT = {
				has_character_modifier = recently_asked_crafting
			}
            FROM = {
				wealth = 375
			}
            ROOT = {
				NOT = {
					trait = crafting_magic_item
				}
			}
		}
        effect = {
			add_character_modifier = {
				name = recently_asked_crafting
				duration = 1000
			}
			FROM = {
				character_event = {
					id = svampires.48
				}
			}
		}
        ai_will_do = {
            factor = 0.001 # 1% chance per year of commissioning per year
		}
	}

	jade_hipnotize = {
		filter = court
		ai_target_filter = court
      	from_potential = {
           	trait = vampire_jade_visible
			NOT = {
				has_character_modifier = magic_cooldown
			}
			NOT = {
				trait = blinded
			}
           	NOR = {
                has_character_modifier = jade_degradation_3
                has_character_modifier = jade_degradation_4
			}
		}
      	potential = {
			is_undead_trigger = no
			is_demon_trigger = no
			NOT = {
				trait = creature_forestspirit
			}
			NOT = {
				trait = creature_treekin
			}
			is_within_diplo_range = FROM
			OR = {
				prisoner = yes
				liege = {
					character = FROM
				}
			}
		}
        allow = {
			NOT = {
				character = FROM
			}
			NOT = {
				has_any_opinion_modifier = opinion_ensnared_me
			}
			is_within_diplo_range = FROM
			FROM = {
				custom_tooltip = {
					text = IS_NOT_INCAPACITATED
					is_incapacitated_trigger = no
				}
			}
			OR = {
				prisoner = yes
				liege = {
					character = FROM
				}
			}
		}
        effect = {
			character_event = {
				id = svampires.71
			}
			hidden_tooltip = {
				FROM = {
					add_character_modifier = {
						name = magic_cooldown
						duration = 300
						hidden = yes
					}
				}
			}
		}
        ai_will_do = {
            factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0.25
				FROM = {
					trait = kind
				}
			}
			modifier = {
				factor = 0
				reverse_opinion = {
					who = FROM value = 75
				}
			}
			modifier = {
				factor = 0.01
				reverse_opinion = {
					who = FROM value = 60
				}
			}
			modifier = {
				factor = 0.1
				reverse_opinion = {
					who = FROM value = 50
				}
			}
			modifier = {
				factor = 0.25
				reverse_opinion = {
					who = FROM value = 40
				}
			}
			modifier = {
				factor = 0.25
				reverse_opinion = {
					who = FROM value = 30
				}
			}
			modifier = {
				factor = 0.5
				reverse_opinion = {
					who = FROM value = 20
				}
			}
			modifier = {
				factor = 0.95
				reverse_opinion = {
					who = FROM value = 10
				}
			}
			modifier = {
				factor = 1.5
				NOT = {
					reverse_opinion = {
						who = FROM value = -10
					}
				}
			}
			modifier = {
				factor = 1.75
				NOT = {
					reverse_opinion = {
						who = FROM value = -20
					}
				}
			}
			modifier = {
				factor = 1.95
				NOT = {
					reverse_opinion = {
						who = FROM value = -30
					}
				}
			}
			modifier = {
				factor = 1.95
				NOT = {
					reverse_opinion = {
						who = FROM value = -40
					}
				}
			}
			modifier = {
				factor = 2
				NOT = {
					reverse_opinion = {
						who = FROM value = -50
					}
				}
			}
			modifier = {
				factor = 2.5
				NOT = {
					reverse_opinion = {
						who = FROM value = -60
					}
				}
			}
			modifier = {
				factor = 2.75
				NOT = {
					reverse_opinion = {
						who = FROM value = -75
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					trait = paranoid
				}
			}
			modifier = {
				factor = 2
				ROOT = {
					is_ruler = yes
				}
			}
		}
	}

	jade_hipnotize_stop = {
		ai_target_filter = court
      	from_potential = {
           	trait = vampire_jade_visible
			is_incapacitated_trigger = no
		}
      	potential = {
			any_friend = {
				character = FROM
			}
		}
        allow = {
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_ensnared_me
			}
		}
        effect = {
			remove_friend = FROM
		}
        ai_will_do = {
            factor = 0
		}
	}
} #targetteddecisions
decisions = {

	increase_bloodorder_size = {
		potential = {
			has_dlc = "Horse Lords"
			trait = vampire_blood_visible
			primary_title = {
				mercenary = yes
				adventurer = yes
			}
		}
		allow = {
			prisoner = no
			prestige = 150
		}
		effect = {
			prestige = -150
			primary_title = {
				change_title_army_size = 0.07 # Increase of percentage
				band_creator = {
					if = {
						limit = {
							is_alive = yes
						}
						character_event = {
							id = svampires.17
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.025
				band_creator = {
					is_alive = yes
				}
			}
			modifier = {
				factor = 0
				NOT = {
					trait = ambitious
				}
				trait = greedy
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 2
				wealth = 200
			}
			modifier = {
				factor = 2
				wealth = 400
			}
			modifier = {
				factor = 3
				wealth = 800
			}
			modifier = {
				factor = 4
				wealth = 1200
			}
			modifier = {
				factor = 5
				wealth = 1600
			}
		}
	} #closedecision

	start_blood_quest = {
		is_high_prio = yes
		only_rulers = yes
		potential = {
			always = no	#deactivated for now
			trait = vampire_blood_visible
			is_incapacitated_trigger = no
			higher_tier_than = BARON
		}
		allow = {
			prisoner = no
			war = no
			prestige = 50
			piety = 20
		}
		effect = {
			prestige = -50
			piety = -20
			clr_character_flag = empire_questing
			clr_character_flag = border_princes_questing
			clr_character_flag = kislev_questing
			clr_character_flag = bretonnia_questing
			clr_character_flag = estilea_questing
			clr_character_flag = badlands_questing
			clr_character_flag = araby_questing
			clr_character_flag = nehekhara_questing
			clr_character_flag = norsca_questing
			clr_character_flag = mountains_questing
			clr_character_flag = darklands_questing
			clr_character_flag = ulthuan_questing
			clr_character_flag = naggaroth_questing
			clr_character_flag = athel_loren_questing
			clr_character_flag = chaos_wastes_questing
			clr_character_flag = ocean_questing
			hidden_tooltip = {
				character_event = {
					id = sblooddragons.22
				}
				add_trait = blood_questing
				add_character_modifier = {
 					name = blood_quest_startup
					duration = 150
					hidden = yes
				}
				any_courtier = {
					limit = {
						NOR = {
							trait = incapable
							prisoner = yes
							trait = resting
							trait = blood_questing
							is_ruler = yes
						}
						trait = vampire_blood_visible
					}
					character_event = {
						id = sblooddragons.23
					}
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = incapable
							prisoner = yes
							trait = resting
							trait = blood_questing
						}
						trait = vampire_blood_visible
					}
					character_event = {
						id = sblooddragons.23
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				war = yes
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 5
				primary_title = {
					mercenary = yes
					adventurer = yes
				}
			}
		}
	} #closedecision

	stop_blood_questing = {
		only_rulers = yes
		potential = {
			trait = blood_questing
			is_ruler = yes
			NOT = {
				has_character_modifier = blood_quest_startup
			}
			NOT = {
				has_character_flag = ocean_questing
			}
			NOT = {
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
					has_character_flag = ocean_questing
				}
			}
		}
		allow = {
			prestige = 30
			piety = 10
		}
		effect = {
			prestige = -30
			piety = -10
			clr_character_flag = empire_questing
			clr_character_flag = border_princes_questing
			clr_character_flag = kislev_questing
			clr_character_flag = bretonnia_questing
			clr_character_flag = estilea_questing
			clr_character_flag = badlands_questing
			clr_character_flag = araby_questing
			clr_character_flag = nehekhara_questing
			clr_character_flag = norsca_questing
			clr_character_flag = mountains_questing
			clr_character_flag = darklands_questing
			clr_character_flag = ulthuan_questing
			clr_character_flag = naggaroth_questing
			clr_character_flag = athel_loren_questing
			clr_character_flag = chaos_wastes_questing
			clr_character_flag = ocean_questing
			hidden_tooltip = {
				character_event = {
					id = sblooddragons.24
				}
				clr_character_flag = blood_quest_leader
				remove_trait = blood_questing
				if = {
					limit = {
						liege = {
							ROOT = {
								has_opinion_modifier = {
									who = PREV modifier = opinion_blood_questing }
							}
						}
					}
					liege = {
						letter_event = {
							id = sblooddragons.24001
						}
					}
				}
				any_courtier = {
					limit = {
						has_opinion_modifier = {
							who = ROOT modifier = opinion_blood_questing
						}
						trait = vampire_blood_visible
					}
					letter_event = {
						id = sblooddragons.24002
					}
				}
				any_vassal = {
					limit = {
						has_opinion_modifier = {
							who = ROOT modifier = opinion_blood_questing
						}
						trait = vampire_blood_visible
					}
					letter_event = {
						id = sblooddragons.24002
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				has_character_modifier = bloodthirsty
			}
			modifier = {
				factor = 100
				trait = resting
			}
			modifier = {
				factor = 0
				independent = yes
				war = no
				wealth = 5
			}
			modifier = {
				factor = 0.1
				NOR = {
					trait = infirm
					trait = incapable
					trait = blinded
					trait = wounded
					trait = maimed
					trait = eunuch
				}
			}
			modifier = {
				factor = 10
				war = yes
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 1.5
				trait = content
			}
			modifier = {
				factor = 0.5
				primary_title = {
					mercenary = yes
					adventurer = yes
				}
			}
			modifier = {
				factor = 1.75
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				NOT = {
					liege = {
						ROOT = {
							opinion = {
								who = PREV
								value = -80
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				NOT = {
					liege = {
						ROOT = {
							opinion = {
								who = PREV
								value = -60
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				NOT = {
					liege = {
						ROOT = {
							opinion = {
								who = PREV
								value = -40
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.2
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				NOT = {
					liege = {
						ROOT = {
							opinion = {
								who = PREV
								value = -20
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.2
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				NOT = {
					liege = {
						ROOT = {
							opinion = {
								who = PREV
								value = 0
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 20
						}
					}
				}
			}
			modifier = {
				factor = 0.6
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 40
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 60
						}
					}
				}
			}
			modifier = {
				factor = 0.25
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 80
						}
					}
				}
			}
			modifier = {
				factor = 0.05
				liege = {
					ROOT = {
						has_opinion_modifier = {
							who = PREV modifier = opinion_blood_questing
						}
					}
				}
				liege = {
					ROOT = {
						opinion = {
							who = PREV
							value = 100
						}
					}
				}
			}
		}
	} #closedecision

	create_blood_host = {
		potential = {
			trait = vampire_blood_visible
			age = 16
			NOR = {
				trait = incapable
				trait = resting
				trait = blood_questing
			}
		}
		allow = {
			check_variable = {
				which = "blooddragon_reserve" value = 10
			}
			wealth = 30
		}
		effect = {
			wealth = -30
			change_variable = {
				which = "blooddragon_reserve" value = -10
			}
			location = {
				ROOT = {
					spawn_unit = {
						province = PREV
						reinforces = yes
						troops = {
							vampire_knights = {
								10 10
							}
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.25
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 0.5
				NOT = {
					wealth = 200
				}
			}
		}
	} #closedecision

	strigoi_hibernate = {
		potential = {
			trait = vampire_strigoi_visible
			age = 16
			NOR = {
				trait = incapable
				trait = resting
				trait = blood_questing
				has_character_modifier = strigoi_resting_timer
			}
		}
		allow = {
		}
		effect = {
			piety = 75
			add_trait = resting
			disband_event_forces = shambling_ghouls
			add_character_modifier = {
				name = strigoi_resting_timer
				duration = 400
				hidden = yes
			}
			if = {
				limit = {
					capital_scope = {
						owner = {
							character = ROOT
						}
					}
				}
				capital_scope = {
					add_province_modifier = {
						name = hidden_hibernated_strigoi
						duration = -1
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 0.75
				trait = proud
			}
			modifier = {
				factor = 0
				NOT = {
					age = 80
				}
			}
			modifier = {
				factor = 0
				piety = 1000
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 1.5
				trait = content
			}
			modifier = {
				factor = 0.5
				trait = gregarious
			}
			modifier = {
				factor = 0.05
				has_character_modifier = bloodthirsty
			}
			modifier = {
				factor = 0.25
				has_character_modifier = exquisite_agonies
			}
			modifier = {
				factor = 1.5
				has_character_modifier = heart_of_melancholy
			}
		}
	} #closedecision

	strigoi_hibernate_stop = {
		potential = {
			trait = vampire_strigoi_visible
			age = 16
			trait = resting
			NOR = {
				trait = incapable
				trait = blood_questing
				# has_character_modifier = heart_of_melancholy
				has_character_modifier = strigoi_resting_timer
			}
		}
		allow = {
			trait = resting
		}
		effect = {
			piety = -50
			remove_trait = resting
			if = {
				limit = {
					capital_scope = {
						owner = {
							character = ROOT
						}
					}
				}
				capital_scope = {
					remove_province_modifier = hidden_hibernated_strigoi
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.25
				trait = proud
			}
			modifier = {
				factor = 5
				piety = 1000
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 1.5
				trait = gregarious
			}
			modifier = {
				factor = 10
				has_character_modifier = bloodthirsty
			}
			modifier = {
				factor = 4
				has_character_modifier = exquisite_agonies
			}
		}
	} #closedecision

	forbid_crystal = {
		potential = {
			has_artifact = dark_crystal
			NOT = {
				has_character_flag = forbidden_jade_crystal
			}
		}
		allow = {
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
		}
		effect = {
			set_character_flag = forbidden_jade_crystal
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 0
				NOR = {
					trait = greedy
					trait = paranoid
				}
			}
		}
	} #closesdecision

	open_crystal = {
		potential = {
			has_artifact = dark_crystal
			has_character_flag = forbidden_jade_crystal
		}
		allow = {
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
		}
		effect = {
			clr_character_flag = forbidden_jade_crystal
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				OR = {
					trait = greedy
					trait = paranoid
				}
			}
		}
	} #closedecision

	gaze_into_crystal = {
		is_high_prio = yes
		only_rulers = yes
		potential = {
			has_artifact = dark_crystal
			is_ruler = yes
		}
		allow = {
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
			has_artifact = dark_crystal
			NOT = {
				has_character_modifier = magic_cooldown
			}
			OR = {
				learning = 15
				has_character_modifier = magic_power_1
				has_character_modifier = magic_power_2
				has_character_modifier = magic_power_3
				has_character_modifier = magic_power_4
				trait = vampire_jade_visible
				any_courtier = {
					trait = astromancer
				}
			}
		}
		effect = {
			hidden_tooltip = {
				if = {
					limit = {
						trait = vampire_jade_visible
					}
					character_event = {
						id = svampires.60005
					}
				}
				if = {
					limit = {
						NOT = {
							trait = vampire_jade_visible
						}
					}
					character_event = {
						id = svampires.60006
					}
				}
				add_character_modifier = {
					name = magic_cooldown
					duration = 300
					hidden = yes
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 0 #already handled by events
				trait = vampire_jade_visible
			}
			modifier = {
				factor = 0.01
				NOR = {
					trait = ambitious
					trait = greedy
					trait = cynical
				}
			}
			modifier = {
				factor = 0
				trait = paranoid
				religion = draconite
			}
		}
	} #closedecision

	strygos_prepared_invasion = {
		only_rulers = yes
		potential = {
			age = 16
			is_ruler = yes
			higher_tier_than = BARON
			lower_tier_than = EMPEROR
			independent = yes
			NOT = {
				has_character_flag = preparing_strygos_invasion
			}
			NOT = {
				e_strygos = {
					has_holder = yes
				}
			}
			NOT = {
				e_strygos_2 = {
					has_holder = yes
				}
			}
			NOR = {
				trait = incapable
				trait = blood_questing
				trait = resting
				trait = incapacitated
			}
			OR = {
				trait = vampire_strigoi_visible
				AND = {
					culture_group = strigany_group
					is_living_human_trigger = yes
				}
			}
		}
		allow = {
			wealth = 100
			prestige = 500
			piety = 150
		}
		effect = {
			piety = -50
			wealth = -100
			prestige = -400
			add_character_modifier = {
				modifier = preparing_strygos_invasion
				duration = 720
			}		#gives timer
			hidden_tooltip = {
			 	set_character_flag = preparing_strygos_invasion			#Prevents AI from starting the war immediately
				if = {
					limit = {
						ai = yes
					}
					character_event = {
						id = svampires.30 days = 555
					}
				} #Craven AI needs to attack
				character_event = {
					id = svampires.24
				}	#Umbrella
				character_event = {
					id = svampires.26 days = 720
				}	#Fail event if not at war already
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.25
				trait = proud
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0
				war = yes
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 0
				NOT = {
					trait = ambitious
				}
				NOT = {
					trait = vampire_strigoi_visible
				}
			}
			modifier = {
				factor = 0.75
				NOT = {
					wealth = 200
				}
			}
			modifier = {
				factor = 2
				wealth = 300
			}
			modifier = {
				factor = 0.5
				lower_tier_than = DUKE
			}
			modifier = {
				factor = 10
				higher_tier_than = COUNT
			}
			modifier = {
				factor = 1.5
				has_character_modifier = bloodthirsty
			}
			modifier = {
				factor = 0.01
				has_character_modifier = heart_of_melancholy
			}
		}
	} #closedecision

	reform_strygos = {
		is_high_prio = yes
		only_rulers = yes
		potential = {
			age = 16
			is_ruler = yes
			higher_tier_than = BARON
			independent = yes
			NOT = {
				e_strygos = {
					has_holder = yes
				}
			}
			NOT = {
				e_strygos_2 = {
					has_holder = yes
				}
			}
			OR = {
				trait = vampire_strigoi_visible
				AND = {
					culture_group = strigany_group
					is_living_human_trigger = yes
				}
			}
		}
		allow = {
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
			wealth = 150
			prestige = 1500
			piety = 50
			has_landed_title = k_strygos
			has_landed_title = d_mourkain
			has_landed_title = c_mourkain
			completely_controls = k_strygos
			OR = {
				completely_controls = k_badlands
				completely_controls = k_khernarch
			}
		}
		effect = {
			wealth = -150
			piety = -50
			prestige = 300
			hidden_tooltip = {
				if = {
					limit = {
						trait = vampire_strigoi_visible
					}
					long_character_event = {
						id = svampires.31
					}
				}
				if = {
					limit = {
						NOT = {
							trait = vampire_strigoi_visible
						}
					}
					long_character_event = {
						id = svampires.31001
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	} #closedecision

	expel_strigany = {
		only_rulers = yes
		potential = {
			age = 16
			is_ruler = yes
			higher_tier_than = BARON
			independent = yes
			NOT = {
				has_character_modifier = expelled_strigany
			}
			NOR = {
				trait = incapable
				trait = blood_questing
				trait = resting
				trait = incapacitated
				culture_group = strigany_group
				trait = vampire_strigoi_visible
			}
			OR = {
				capital_scope = {
					has_province_modifier = strigany_caravan
				}
				any_vassal = {
					capital_scope = {
						has_province_modifier = strigany_caravan
					}
				}
			} #closesOR
		}
		allow = {
			prestige = 150
			piety = 50
		}
		effect = {
			wealth = 150
			piety = -150
			prestige = -50
			add_character_modifier = {
				name = expelled_strigany
				duration = -1
				inherit = yes
			}
			hidden_tooltip = {
				capital_scope = {
					remove_province_modifier = strigany_caravan
				}
				any_courtier = {
					limit = {
						culture_group = strigany_group
					}
					set_variable = {
						which = "strigany_presence_v" value = 0
					}
					banish = yes
				}
				any_vassal = {
					capital_scope = {
						remove_province_modifier = strigany_caravan
					}
					any_courtier = {
						limit = {
							culture_group = strigany_group
						}
						set_variable = {
							which = "strigany_presence_v" value = 0
						}
						banish = yes
					}
					any_vassal = {
						capital_scope = {
							remove_province_modifier = strigany_caravan
						}
						any_courtier = {
							limit = {
								culture_group = strigany_group
							}
							set_variable = {
								which = "strigany_presence_v" value = 0
							}
							banish = yes
						}
						any_vassal = {
							capital_scope = {
								remove_province_modifier = strigany_caravan
							}
							any_courtier = {
								limit = {
									culture_group = strigany_group
								}
								set_variable = {
									which = "strigany_presence_v" value = 0
								}
								banish = yes
							}
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = craven
			}
			modifier = {
				factor = 0.15
				trait = trusting
			}
			modifier = {
				factor = 1.5
				religion = sigmarite
			}
			modifier = {
				factor = 3
				capital_scope = {
					has_province_modifier = strigany_strife
				}
			}
		}
	} #closedecision

	welcome_strigany = {
		only_rulers = yes
		potential = {
			age = 16
			is_ruler = yes
			higher_tier_than = BARON
			independent = yes
			has_character_modifier = expelled_strigany
			NOR = {
				trait = incapable
				trait = blood_questing
				trait = resting
				trait = incapacitated
			}
		}
		allow = {
			wealth = 25
			prestige = 150
			piety = 50
		}
		effect = {
			wealth = -25
			piety = -150
			prestige = -50
			remove_character_modifier = expelled_strigany
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.5
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 2
				trait = trusting
			}
			modifier = {
				factor = 5
				trait = vampire_strigoi_visible
			}
			modifier = {
				factor = 10
				culture = strigany
			}
		}
	} #closedecision

	embrace_strygan_culture = {
		only_rulers = yes
		potential = {
			age = 16
			is_ruler = yes
			capital_scope = {
				location = {
					region = world_badlands_strygos
				}
			}
			has_global_flag = strygos_culture_swapping
			OR = {
				trait = vampire_strigoi_visible
				culture = strigany
			}
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
		}
		allow = {
		}
		effect = {
			culture = strygan
			capital_scope = {
				culture = strygan
				religion = vampiric
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 5
				trait = vampire_strigoi_visible
			}
			modifier = {
				factor = 2
				culture = strigany
			}
		}
	} #closedecision

	nagashi_experiment = {
		potential = {
			religion = nagashi
			trait = lore_necromancy
			is_incapacitated_trigger = no
			age = 16
			NOR = {
				trait = incapable
				trait = resting
				trait = blood_questing
				has_character_flag = experimenting_necromancy
			}
		}
		allow = {
			check_variable = {
				which = "sample_counter" value = 5
			}
		}
		effect = {
			set_character_flag = experimenting_necromancy
			character_event = {
				id = svampires.47
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 1.25
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 0.75
				trait = content
			}
			modifier = {
				factor = 5
				war = yes
			}
			modifier = {
				factor = 2.5
				has_character_modifier = bloodthirsty
			}
		}
	} #closedecision

	mahtmasi_scare_goblins = {
		is_high_prio = yes
		potential = {
			trait = vampire_mahtmasi_visible
			has_landed_title = k_shadowrealm
			any_war = {
				attacker = {
					religion = spider_god
				}
			}
			NOT = {
				has_character_modifier = magic_cooldown
			}
		}
		allow = {
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
		}
		effect = {
			hidden_tooltip = {
				add_character_modifier = {
					name = magic_cooldown
					hidden = yes
					duration = 300
				}
			}
			any_war = {
				limit = {
					attacker = {
						religion = spider_god
					}
				}
				attacker = {
					character_event = {
						id = svampires.78
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10
				war = yes
			}
		}
	} #closedecision

	use_shadow_plot = {
		potential = {
			OR = {
				trait = vampire_mahtmasi_visible
				AND = {
					religion = shadowmen
					trait = lore_necromancy
					has_character_modifier = magic_power_4
				}
				AND = {
					trait = lore_shadows
					has_character_modifier = magic_power_4
				}
			}
			OR = {
				has_plot = plot_make_voodoo_doll
				has_plot = plot_kill_character
				has_plot = plot_kill_spouse
			}
			NOT = {
				has_character_flag = murder_in_motion
			}
			NOT = {
				has_character_flag = voodoo_success_flag
			}
			NOT = {
				has_character_modifier = magic_cooldown
			}
		}
		allow = {
			piety = 200
			custom_tooltip = {
				text = IS_NOT_INCAPACITATED
				is_incapacitated_trigger = no
			}
		}
		effect = {
			piety = -200
			set_character_flag = using_shadow_plot
			hidden_tooltip = {
				character_event = {
					id = svampires.88
				}
				add_character_modifier = {
					name = magic_cooldown
					hidden = yes
					duration = 300
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				OR = {
					trait = patient
					trait = trusting
				}
			}
		}
	} #closedecision
} #closesdecisions
settlement_decisions = {

	occupy_barony = {
		filter = all
		ai_target_filter = all
		from_potential = {
			trait = vampire_blood_visible
			NOT = {
				trait = incapable
			}
			higher_tier_than = COUNT
		}
		potential = {
			is_capital = yes
			owner = {
				war_with = FROM
			}
			owner = {
				NOT = {
					character = FROM
				}
			}
		}
		allow = {
			is_occupied = yes
			location = {
				is_within_diplo_range = FROM
			}
			location = {
				NOT = {
					has_province_modifier = occupying_region
				}
			}
			location = {
				has_empty_holding = yes
			}
			FROM = {
				wealth = 500
			}
		}
		effect = {
			FROM = {
				wealth = -500
			}
			location = {
				add_province_modifier = {
					name = occupying_region
					duration = 250
				}
			}
			owner = {
				opinion = {
					modifier = opinion_occupied_province
					who = FROM
					years = 20
				}
			}
			hidden_tooltip = {
				location = {
					province_event = {
						id = svampires.20
					}
				}
			}
			hidden_tooltip = {
				location = {
					province_event = {
						id = svampires.21 days = 250
					}
				}
			}
		} #closes effect
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	} #closes decision

	jade_sack_province = {
		filter = owned
		ai_target_filter = owned
		is_high_prio = yes
		potential = {
			is_capital = yes
			FROM = {
				trait = vampire_jade_visible
				religion_group = necromantic_group
			}
			holder_scope = {
				character = FROM
			}
			dejure_liege_title = {
				holder_scope = {
					character = FROM
				}
			}
			location = {
				NOT = {
					has_province_modifier = jade_depopulation
				}
			}
			location = {
				NOT = {
					has_province_modifier = province_scourged
				}
			}
			location = {
				NOT = {
					has_province_modifier = province_slave_raid
				}
			}
			location = {
				NOT = {
					has_province_modifier = province_slave_raid_chaos_dwarf
				}
			}
			NOT = {
				is_nomadic = yes
			}
			location = {
				NOT = {
					culture = nehekharan
				}
			}
			OR = {
				location = {
					has_province_modifier = jade_mayhem
				}
				location = {
					NOT = {
						religion = vampiric
					}
				}
			}
		}
		allow = {
			FROM = {
				OR = {
					AND = {
						ai = no
						wealth = 90
					}
					AND = {
						ai = yes
						wealth = 40
					}
				}
			}
			FROM = {
				custom_tooltip = {
					text = IS_NOT_INCAPACITATED
					is_incapacitated_trigger = no
				}
			}
			NOT = {
				is_nomadic = yes
			}
			location = {
				NOT = {
					culture = nehekharan
				}
			}
			OR = {
				location = {
					has_province_modifier = jade_mayhem
				}
				location = {
					NOT = {
						religion = vampiric
					}
				}
			}
		}
		effect = {
			FROM = {
				add_trait = questing
			}
			hidden_tooltip = {
				FROM = {
					character_event = {
						id = svampires.72
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 5
				location = {
					has_province_modifier = jade_mayhem
				}
			}
		}
	}
} #settlementdecisions